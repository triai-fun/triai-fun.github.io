(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1240],{54740:function(e,t,n){"use strict";n.d(t,{eO:function(){return l}});var a=n(57437);n(17104);var o=n(72790),i=n(11340),r=n(53335),s=n(43009),d=n(10433);function u(e){var t,n,o,i;let s=e.value.indexOf("."),d=-1===s?"":e.value.substring(s+1),u=d.match(/^(0+)/),l=u?u[0].length:0,p=d.substring(l),y=null!==(t=e.keepDecimal)&&void 0!==t?t:4,m=null!==(n=e.decimal)&&void 0!==n?n:18,c=null!==(o=e.useSub)&&void 0!==o&&o;p.length>y&&(p=p.substring(0,y));let T=e.value.substring(0,-1===s?e.value.length:s+l+1)+p;return(0,a.jsxs)("span",{className:(0,r.m6)("format-decimal",e.className),children:[c&&-1!==s&&l>0&&null===d.match(/^0+$/)?(0,a.jsxs)(a.Fragment,{children:[T.substring(0,s+2),(0,a.jsx)("sub",{className:(0,r.m6)("zero-count",e.subClassName),children:l}),p.replace(/0+$/,"")]}):0===Number(e.value)?0:-1!==s&&e.value.length>s+1+m?"".concat(e.value.substring(0,s+1+m)):e.value,null!==(i=e.children)&&void 0!==i?i:""]})}function l(e){let{preChildren:t,value:n,minDecimal:l,decimal:p,className:y,valueClassName:m,keepDecimal:c,useSub:T,children:f,...R}=e;if(isNaN(n)||"number"!=typeof n)return d.Z.W("NumberFormatter received invalid value:",n,"type:",typeof n),(0,a.jsx)("span",{className:(0,r.m6)("invalid-number",y),children:"0"});let w=null!=l?l:0;c=null!=c?c:4,void 0!==l&&(p=Math.max(Math.min(l,20),0));let v=null!=p?p:18;void 0!==p&&(p=Math.max(Math.min(p,20),0));let{value:g,suffix:A}=s.Z.getAbbreviatedValue(n);if(""!==A)return(0,a.jsxs)(o.Z,{horizontalArrangement:i.cV.Center,className:"number-formatter ".concat(null!=y?y:""),...R,children:[null!=t?t:"",(0,a.jsx)(u,{value:g.toFixed(c),useSub:T,decimal:p,className:m}),A,f]});let D=n.toFixed(v),h=D.indexOf(".");if(-1!==h){let e=D.substring(h+1),t=(e.match(/^(0+)/)||[""])[0].length,a=e.substring(t);void 0===p&&a.length>c&&(a=a.substring(0,c)),D=n.toLocaleString("en-US",{minimumFractionDigits:w,maximumFractionDigits:null!=p?p:t+a.length})}else D=n.toLocaleString("en-US",{minimumFractionDigits:w,maximumFractionDigits:p});return(0,a.jsxs)(o.Z,{className:(0,r.m6)("number-formatter justify-center",y),...R,children:[null!=t?t:"",(0,a.jsx)(u,{value:D,useSub:T,decimal:p,className:m,subClassName:y}),f]})}},40366:function(e,t,n){"use strict";n.d(t,{K:function(){return a}});let a=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"target",type:"address"}],name:"AddressEmptyCode",type:"error"},{inputs:[{internalType:"address",name:"implementation",type:"address"}],name:"ERC1967InvalidImplementation",type:"error"},{inputs:[],name:"ERC1967NonPayable",type:"error"},{inputs:[],name:"FailedCall",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{inputs:[],name:"UUPSUnauthorizedCallContext",type:"error"},{inputs:[{internalType:"bytes32",name:"slot",type:"bytes32"}],name:"UUPSUnsupportedProxiableUUID",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"implementation",type:"address"}],name:"Upgraded",type:"event"},{inputs:[],name:"AIRDROP_DURATION_CALC",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"AIRDROP_DURATION_GET_LIMIT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"AIRDROP_DURATION_GET_MAX",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"AIRDROP_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"CANDIDATE_TOKEN_AMOUNT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"COMMUNITY_DURATION",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"COMMUNITY_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"COMMUNITY_REWARD_EXPIRE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"COMMUNITY_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"CREATOR_FEE_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"DAILY_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"DEVELOPER_FEE_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"FIRST_LUCKY_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"FIRST_PLACE_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"FUND_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"LOSER_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"LOSER_POOL_REWARD_TIME_LIMIT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"LUCKY_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"MASTER_FOR_SUPER",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"MASTER_LINK_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"MASTER_NODE_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ONE_DAY",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"PARENT_NODE_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"QUITE_DURATION",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"QUIT_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"REWARD_LIMIT_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ROUND_DURATION_ADD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"ROUND_DURATION_MAX",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SECOND_LUCKY_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SECOND_PLACE_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SUPER_LINK_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SUPER_NODE_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SUPER_TOKEN_AMOUNT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"SWAP_LIMIT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"THIRD_LUCKY_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"THIRD_PLACE_REWARD",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"UPGRADE_INTERFACE_VERSION",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"VOTES_FOR_MASTER",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"VOTE_DURATION",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"VOTE_PRICE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"VOTE_RANK_POOL_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"VOTE_RANK_REWARD_RATE",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"applyCandidateNode",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"applySuperNode",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"},{internalType:"uint256",name:"curDay",type:"uint256"}],name:"calcEffectiveAirDrop",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"},{internalType:"uint256",name:"curDay",type:"uint256"}],name:"calcEffectiveReinvest",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"ceilReward",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"claimLoserReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimLuckyReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimTop3NodeReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimTop3VotedReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimVoteAndAirDropReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"createTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"creator",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"currentRoundNO",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"daoFactory",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastInvestors",outputs:[{internalType:"address[33]",name:"",type:"address[33]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getLoserRewardTokenValue",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getLuckyReward",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getQuiteAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getTop3NodeReward",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getTop3VotedReward",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getVoteAndAirDropReward",outputs:[{components:[{internalType:"uint256",name:"nodeReward",type:"uint256"},{internalType:"uint256",name:"airdropReward",type:"uint256"},{internalType:"uint256",name:"airdropLinkReward",type:"uint256"},{internalType:"uint256",name:"reinvestReward",type:"uint256"},{internalType:"uint256",name:"totalReward",type:"uint256"},{internalType:"uint256",name:"clairReward",type:"uint256"}],internalType:"struct IDao.RewardData",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"trinitySwap",type:"address"},{internalType:"address",name:"pair",type:"address"},{internalType:"address",name:"weth",type:"address"},{internalType:"address",name:"priceConsumerV3",type:"address"},{internalType:"address",name:"creator",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"address",name:"developer",type:"address"}],internalType:"struct IDao.InitParams",name:"params",type:"tuple"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"lastInvestors",outputs:[{internalType:"uint8",name:"currentIndex",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"pair",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"pools",outputs:[{internalType:"uint256",name:"airdropPool",type:"uint256"},{internalType:"uint256",name:"voteRankPool",type:"uint256"},{internalType:"uint256",name:"communityPool",type:"uint256"},{internalType:"uint256",name:"luckyPool",type:"uint256"},{internalType:"uint256",name:"luckyPoolBalance",type:"uint256"},{internalType:"uint256",name:"fundPool",type:"uint256"},{internalType:"uint256",name:"loserPool",type:"uint256"},{internalType:"uint256",name:"loserPoolBalance",type:"uint256"},{internalType:"uint256",name:"loserPoolETH",type:"uint256"},{internalType:"uint256",name:"loserPoolETHBalance",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"priceConsumerV3",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"promotions",outputs:[{internalType:"uint256",name:"sonVotedAmountToday",type:"uint256"},{internalType:"uint256",name:"sonVotedAmountWeek",type:"uint256"},{internalType:"uint256",name:"sonVotedDate",type:"uint256"},{internalType:"uint256",name:"sonVotedWeek",type:"uint256"},{internalType:"uint256",name:"airdropLinkReward",type:"uint256"},{internalType:"uint256",name:"nodeReward",type:"uint256"},{internalType:"uint256",name:"totalSonVotedAmount",type:"uint256"},{internalType:"uint256",name:"totalSonEthDone",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"proxiableUUID",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"quit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"quitAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"restart",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"restartByVote",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"restartFactory",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"roundExpire",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_loserPoolBalance",type:"uint256"}],name:"setLoserPoolBalance",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_creator",type:"address"},{internalType:"address",name:"_developer",type:"address"},{internalType:"uint256",name:"_voteDuration",type:"uint256"}],name:"setParams",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"startByVote",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"stop",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3Node",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"top3NodeDate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"top3NodePoolPre",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3NodePre",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3NodeWithdraw",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3Voted",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"top3VotedDate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"top3VotedPoolPre",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3VotedPre",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"top3VotedWithdraw",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"totalEthDone",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"totalVoteAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"trinitySwap",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"}],name:"upgradeTo",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"upgradeToAndCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"users",outputs:[{internalType:"uint256",name:"firstJoinTime",type:"uint256"},{internalType:"uint256",name:"roundNo",type:"uint256"},{internalType:"address",name:"parent",type:"address"},{internalType:"uint256",name:"sonCount",type:"uint256"},{internalType:"uint256",name:"sonCandidateCount",type:"uint256"},{internalType:"uint256",name:"sonMasterNodeCount",type:"uint256"},{internalType:"uint256",name:"sonSuperNodeCount",type:"uint256"},{internalType:"enum DaoLibrary.NodeType",name:"nodeType",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_node",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"vote",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"voteDuration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"votes",outputs:[{internalType:"uint256",name:"votedAmount",type:"uint256"},{internalType:"uint256",name:"ethDone",type:"uint256"},{internalType:"uint256",name:"roundFirstVotedDate",type:"uint256"},{internalType:"uint256",name:"claimedVotedLastTime",type:"uint256"},{internalType:"uint256",name:"votedDatePre",type:"uint256"},{internalType:"bool",name:"quited",type:"bool"},{internalType:"bool",name:"luckyReward",type:"bool"},{internalType:"bool",name:"loserReward",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"weth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}]},22928:function(e,t,n){"use strict";n.d(t,{Z:function(){return b},z:function(){return a}});var a,o=n(12249),i=n(5853),r=n(8113),s=n(63671),d=n(59201),u=n(68031),l=n(74439),p=n(89769),y=n(344),m=n(43009),c=n(79787),T=n(81900),f=n(94552),R=n(10433),w=n(70042),v=n(3682),g=n(40366),A=n(21707),D=n(81939),h=n(33657),I=n(40257);class b extends s.bQ{static getCurrentRewardRound(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.Z.Time.oneWeek().toJSTime();return Math.floor((+new Date-e)/t)}static getCurrentRewardRoundTimestamp(e,t,n){let a=Math.floor(e/t)*t,o=t*n;return a+b.getCurrentRewardRound(e,o)*o}static getToday(){return 864e5*Math.floor(Date.now()/864e5)}static buildGetInfoWithCondition(e,t,n){let a=new A.C(e,g.K);return{daoAddress:e,calls:[a.roundExpire(t),a.totalVoteAmount(t),a.totalEthDone(t),a.quitAmount(t,BigInt(n)),a.pools(t)]}}static buildGetVoteRankInfo(e){let t=Number("3"),n=new A.C(e,g.K);return{daoAddress:e,calls:Array(t).fill(0).map((e,t)=>[n.top3Voted(t),n.top3VotedPre(t),n.top3VotedWithdraw(t)]),singleUserCallCount:t}}static buildGetNodeRankInfo(e){let t=Number("3"),n=new A.C(e,g.K);return{daoAddress:e,calls:Array(t).fill(0).map((e,t)=>[n.top3Node(t),n.top3NodePre(t),n.top3NodeWithdraw(t)]),singleUserCallCount:t}}static buildGetUserRankDetailInfo(e,t,n){let a=0;if(!e.length)return{daoAddress:t,userAddresses:e,calls:[],singleUserCallCount:a};let o=e.map(e=>{let{calls:o}=b.buildGetUserInfoWithCondition(e,t,n);return a=o.length,o}).flat();return{daoAddress:t,userAddresses:e,calls:o,singleUserCallCount:a}}static analyzeUserCurrentRoundSimpleInfo(e){return{...e.users,nodeType:Number(e.users.nodeType)}}static analyzeUserCurrentRoundVoteInfo(e){return{...e.votes,roundFirstVotedDate:m.Z.BlockTime.from(e.votes.roundFirstVotedDate).toJSTime(),claimedVotedLastTime:m.Z.BlockTime.from(e.votes.claimedVotedLastTime).toJSTime(),votedDatePre:m.Z.BlockTime.from(e.votes.votedDatePre).toJSTime(),isLuckyRewardClaimed:e.votes.luckyReward,isLoserRewardClaimed:e.votes.loserReward}}static analyzeUserCurrentRoundInfo(e){return{userInfo:b.analyzeUserCurrentRoundSimpleInfo(e),voteInfo:b.analyzeUserCurrentRoundVoteInfo(e),promotionInfo:e.promotions,voteAndAirDropReward:e.voteAndAirDropReward,effectiveVote:e.effectiveVote,effectiveEthDone:e.effectiveEthDone}}static analyzeUserDetailInfo(e,t,n){let a=[];for(let o=0;o<e.length/t;o++){let i=o*t,r=i+t,[s,d,u,l,p,y]=e.slice(i,r);a.push({...b.analyzeUserCurrentRoundInfo({users:s,votes:d,promotions:u,voteAndAirDropReward:l,effectiveVote:p,effectiveEthDone:y}),userAddress:n[o]||""})}return a}static buildGetUserInfoWithCondition(e,t,n){let a=new A.C(t,g.K),o=BigInt(m.Z.Time.fromTimestamp(b.getToday()).toUnixTime()),i=[a.users(e),a.votes(n,e),a.promotions(n,e),a.getVoteAndAirDropReward(e),a.calcEffectiveAirDrop(e,o),a.calcEffectiveReinvest(e,o)];return{daoAddress:t,userAddress:e,calls:i}}async getRankSimpleInfo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=b.buildGetVoteRankInfo(e),o=b.buildGetNodeRankInfo(e);new A.C(e,g.K);let i=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider()),[r,s]=await Promise.all([this.getLastLuckyRecord({daoAddress:e}),i.all([a.calls.flat(),o.calls.flat()].flat())]),d=s.slice(0,a.calls.flat().length),u=d.map((e,t)=>t).filter(e=>e%a.singleUserCallCount==0).map(e=>({nodeAddress:d[e++],preNodeAddress:d[e++],nodeWithdrawed:d[e++]})),l=s.slice(a.calls.flat().length,a.calls.flat().length+o.calls.flat().length),p=l.map((e,t)=>t).filter(e=>e%a.singleUserCallCount==0).map(e=>({nodeAddress:l[e++],preNodeAddress:l[e++],nodeWithdrawed:l[e++]})),y=e=>f.N!==e||n;return{daoAddress:e,luckyRecords:r.map(e=>e.toJSON()).filter(e=>y(e.userAddress)),voteAddresses:u.map(e=>e.nodeAddress).filter(y),prevVoteAddresses:u.map(e=>e.preNodeAddress).filter(y),voteWithdrawed:u.map(e=>e.nodeWithdrawed).filter((e,t)=>y(u[t].preNodeAddress)),nodeAddresses:p.map(e=>e.nodeAddress).filter(y),prevNodeAddresses:p.map(e=>e.preNodeAddress).filter(y),nodeWithdrawed:p.map(e=>e.nodeWithdrawed).filter((e,t)=>y(p[t].preNodeAddress))}}async getLastLuckyRecord(e){var t,n;let o=new y.q$p,i=await o.getLuckyRewards({daoAddress:e.daoAddress}),r=new u.zv(i);return r.hasError()?[]:(null!==(n=null===(t=r.getData())||void 0===t?void 0:t.daoLuckyRewardVOs)&&void 0!==n?n:[]).map(e=>a.LastLuckyRecordAdapter.fromServer(e))}async getRankInfo(e){var t,n;if(!(null==e?void 0:null===(t=e.voteAddresses)||void 0===t?void 0:t.length)&&!(null==e?void 0:null===(n=e.nodeAddresses)||void 0===n?void 0:n.length)&&!(null==e?void 0:e.userAddress))return{voteData:[],nodeData:[],userData:null};let a=b.buildGetUserRankDetailInfo([e.voteAddresses,e.nodeAddresses,e.userAddress?[e.userAddress]:[]].flat(),e.daoAddress,e.currentRoundNO),o=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider()),i=[];for(let t=0;t<a.userAddresses.length;t+=17){let n=a.userAddresses.slice(t,t+17).flatMap(t=>b.buildGetUserInfoWithCondition(t,a.daoAddress,e.currentRoundNO).calls),r=await o.all(n);i.push(...r)}let r=b.analyzeUserDetailInfo(i,a.singleUserCallCount,a.userAddresses),s=0,d=r.slice(s,s+e.voteAddresses.length);s+=d.length;let u=r.slice(s,s+e.nodeAddresses.length);return s+=u.length,{voteData:d,nodeData:u,userData:e.userAddress?r.slice(s,s+1)[0]:null}}async getLuckyReward(e){let{daoAddress:t,userAddresses:n}=e,a=new A.C(t,g.K),o=n.map(e=>a.getLuckyReward(e)),i=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider());return await i.all(o)}async getUserVoteNodeRankReward(e){let{daoAddress:t,userAddress:n}=e,a=new A.C(t,g.K),o=[a.getLuckyReward(n),a.getTop3NodeReward(n),a.getTop3VotedReward(n)],i=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider()),[r,s,d]=await i.all(o);return{luckyReward:{reward:r},voteTopReward:{reward:d[0],rank:d[1]},nodeTopReward:{reward:s[0],rank:s[1]}}}async getCurrentRoundInfo(e){let t=v.Q.getDefaultProvider(),n=new A.z(v.Q.getTargetNet().chainId,t),a=m.Z.Time.fromTimestamp(e.targetWeek).toUnixTime(),{daoAddress:o,calls:i}=b.buildGetInfoWithCondition(e.daoAddress,e.currentRoundNO,a),[r,s,d,u,l]=await n.all([i].flat());return{daoAddress:o,roundExpire:m.Z.BlockTime.fromTimestamp(r).toJSTime(),totalVoteAmount:s,totalEthDone:d,quitAmount:u,pool:l}}async getUserCurrentRoundSimpleInfo(e){let t=[new A.C(e.daoAddress,g.K).users(e.userAddress)],n=v.Q.getDefaultProvider(),a=new A.z(v.Q.getTargetNet().chainId,n),[o]=await a.all(t);return{daoAddress:e.daoAddress,userAddress:e.userAddress,userInfo:b.analyzeUserCurrentRoundSimpleInfo({users:o})}}async getUserCurrentRoundInfo(e){let{calls:t}=b.buildGetUserInfoWithCondition(e.userAddress,e.daoAddress,e.currentRoundNO),n=v.Q.getDefaultProvider(),a=new A.z(v.Q.getTargetNet().chainId,n),[o,i,r,s,d,u]=await a.all(t);return{daoAddress:e.daoAddress,userAddress:e.userAddress,...b.analyzeUserCurrentRoundInfo({users:o,votes:i,promotions:r,voteAndAirDropReward:s,effectiveVote:d,effectiveEthDone:u})}}async getUserCancelAmount(e){return w.bR.connect(e.daoAddress,v.Q.getDefaultProvider()).getQuiteAmount(e.userAddress)}async getDaoChainInfo(e,t){var n;let a=v.Q.getDefaultProvider(),o=new A.z(null!=t?t:v.Q.getTargetNet().chainId,a),i=new A.C(e,g.K),[r,s,d,u,l,p,y,c,T,f,R,w,D,h,b,N,E,_,C,O,M,S,k,U,Z,L,V,P,F,x,W,z,B,J,K,H,j,q,Q,Y,G,$,X,ee,et]=await o.all([i.ONE_DAY(),i.VOTE_PRICE(),i.CANDIDATE_TOKEN_AMOUNT(),i.SUPER_TOKEN_AMOUNT(),i.VOTES_FOR_MASTER(),i.MASTER_FOR_SUPER(),i.ROUND_DURATION_MAX(),i.ROUND_DURATION_ADD(),i.voteDuration(),i.AIRDROP_DURATION_CALC(),i.AIRDROP_DURATION_GET_LIMIT(),i.AIRDROP_DURATION_GET_MAX(),i.LOSER_POOL_REWARD_TIME_LIMIT(),i.COMMUNITY_DURATION(),i.COMMUNITY_REWARD_EXPIRE(),i.QUITE_DURATION(),i.DAILY_REWARD_RATE(),i.FIRST_PLACE_REWARD(),i.SECOND_PLACE_REWARD(),i.THIRD_PLACE_REWARD(),i.VOTE_RANK_REWARD_RATE(),i.COMMUNITY_REWARD_RATE(),i.FIRST_LUCKY_REWARD(),i.SECOND_LUCKY_REWARD(),i.THIRD_LUCKY_REWARD(),i.LOSER_POOL_RATE(),i.FUND_POOL_RATE(),i.LUCKY_POOL_RATE(),i.AIRDROP_POOL_RATE(),i.VOTE_RANK_POOL_RATE(),i.COMMUNITY_POOL_RATE(),i.QUIT_RATE(),i.CREATOR_FEE_RATE(),i.DEVELOPER_FEE_RATE(),i.token(),i.trinitySwap(),i.pair(),i.name(),i.daoFactory(),i.currentRoundNO(),i.createTime(),i.top3VotedDate(),i.top3VotedPoolPre(),i.top3NodeDate(),i.top3NodePoolPre()]),en=m.Z.BlockTime.fromUnixTimestamp(f).toJSTime();return{daoAddress:e,voteRankClaimDurationAdd:m.Z.BlockTime.fromUnixTimestamp(null!=r?r:m.Z.Time.fromString(null!==(n=I.env.NEXT_PUBLIC_DAO_RANK_DURATION_ADD)&&void 0!==n?n:"24H").toUnixTime()).toJSTime(),votePrice:s,applyCandidateEthAmount:d,applySuperEthAmount:u,votesForMaster:l,masterForSuper:p,roundDurationMax:m.Z.BlockTime.fromUnixTimestamp(y).toJSTime(),roundDurationAdd:m.Z.BlockTime.fromUnixTimestamp(c).toJSTime(),voteDuration:T&&T>0n?m.Z.BlockTime.fromUnixTimestamp(T).toJSTime():m.Z.Hours.from(24).toJSTime(),airdropDurationCalc:en,rewardRoundPass:Number(R),airdropDurationGetLimit:Number(R)*en,airdropDurationGetMax:m.Z.BlockTime.fromUnixTimestamp(w).toJSTime(),loserPoolRewardTimeLimit:m.Z.BlockTime.fromUnixTimestamp(D).toJSTime(),communityDuration:m.Z.Time.fromUnixTimestamp(h).toJSTime(),communityRewardDuration:m.Z.Time.fromUnixTimestamp(b).toJSTime(),cancelDurationTime:m.Z.Time.fromUnixTimestamp(N).toJSTime(),dailyRewardRate:Number(E)/100,firstPlaceRewardRate:Number(_)/100,secondPlaceRewardRate:Number(C)/100,thirdPlaceRewardRate:Number(O)/100,voteRankRewardRate:Number(M)/100,communityRewardRate:Number(S)/100,firstLuckyRewardRate:Number(k)/100,secondLuckyRewardRate:Number(U)/100,thirdLuckyRewardRate:Number(Z)/100,loserPoolRate:Number(L)/100,fundPoolRate:Number(V)/100,luckyPoolRate:Number(P)/100,airdropPoolRate:Number(F)/100,voteRankPoolRate:Number(x)/100,communityPoolRate:Number(W)/100,cancelRate:Number(z)/1e3,creatorFeeRate:Number(B)/100,developerFeeRate:Number(J)/100,tokenAddress:K,trinitySwap:H,pairAddress:j,name:q,daoFactoryAddress:Q,currentRoundNO:Number(Y),createTime:m.Z.BlockTime.fromUnixTimestamp(G).toJSTime(),top3VotedDate:m.Z.BlockTime.fromUnixTimestamp($).toJSTime(),top3VotedPoolPre:X,top3NodeDate:m.Z.BlockTime.fromUnixTimestamp(ee).toJSTime(),top3NodePoolPre:et}}async getDaoList(e){var t;return u.zv.Ok(Array(null!==(t=e.pageSize)&&void 0!==t?t:16).fill({id:"1",name:"DAO",description:"DAO",createTime:+new Date}))}async getDaoListForNodeListFilter(e){var t;let n=new y.q$p(this.buildConfigure()),o=await n.getDaos({pageSize:e.pageSize,page:e.page,keyword:e.keyword}),i=new u.zv(o);return i.hasError()?i:u.zv.Ok((null!==(t=i.getData().daoVOs)&&void 0!==t?t:[]).map(a.DAOAdapter.fromServer).map(e=>e.toJSON()))}async getDaoSimpleInfo(e){let t=new y.q$p(this.buildConfigure()),n=new u.zv(await t.getDaoDetail({daoAddress:e.daoAddress}));if(n.hasError())return n;let o=n.getData();return u.zv.Ok(a.DAOAdapter.fromServer(o).toJSON())}async getNodeList(e){var t,n,o,i;let r=new y.q$p,s=await r.getNodes({daoAddress:e.daoAddress,pageSize:e.pageSize,page:e.page,keyword:null!==(n=e.keyword)&&void 0!==n?n:""}),d=new u.zv(s);return d.hasError()?d:u.zv.Ok((null!==(o=null===(t=s.data)||void 0===t?void 0:t.nodeVOs)&&void 0!==o?o:[]).map(t=>a.NodeAdapter.fromServer(t,e.daoAddress).toJSON()),{totalPage:null!==(i=s.totalPage)&&void 0!==i?i:null})}async getNodeDetail(e){let t=new y.q$p,n=await t.getNodeDetail({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress}),o=new u.zv(n);return o.hasError()?o:u.zv.Ok(a.NodeInfoAdapter.getFactory({daoAddress:e.daoAddress})(o.getData()).toJSON())}async getVotingRecords(e){var t;let n=new y.q$p,o=await n.getVotes({daoAddress:e.daoAddress,nodeAddress:e.nodeAddress,page:e.page,pageSize:e.pageSize}),i=new u.zv(o);return i.hasError()?i:u.zv.Ok((null!==(t=i.getData().voteVOs)&&void 0!==t?t:[]).map(a.VoteRecordAdapterV2.fromServer))}async getRestartVotes(e){var t,n;new y.q$p;let a=await this.httpRequest.start({url:"/vote/restart/votes",method:"GET",data:e}),o=new u.zv(a);if(o.hasError())return o;let i=o.getData(),r=(null!==(t=null==i?void 0:i.voteVOs)&&void 0!==t?t:[]).map(e=>{var t;return{userAddress:e.userAddress,txHash:null!==(t=e.txHash)&&void 0!==t?t:"",voteTime:m.Z.Time.timestampBuilder()(Number(e.timestamp)).toJSTime(),voteNumber:Number(e.voteNumber),voteAmount:"0",choice:e.choice}});return u.zv.Ok(r,{totalPage:null!==(n=a.totalPage)&&void 0!==n?n:null})}async getMyVotingRecords(e){var t;let n=new y.q$p(this.buildConfigure()),o=await n.getMyVotes({daoAddress:e.daoAddress,nodeAddress:e.nodeAddress,page:e.page,pageSize:e.pageSize}),i=new u.zv(o);return i.hasError()?i:u.zv.Ok((null!==(t=i.getData().voteVOs)&&void 0!==t?t:[]).map(a.VoteRecordAdapterV2.fromServer))}async getRewardRecordList(e){var t,n;let o=new y.q$p,i=await o.getRewards({daoAddress:e.daoAddress,page:null!==(t=e.page)&&void 0!==t?t:1,pageSize:null!==(n=e.pageSize)&&void 0!==n?n:16,type:e.type}),r=new u.zv(i);return r.hasError()?r:u.zv.Ok(a.DAORewardRecordAdapter.fromServer(r.getData()))}async getOtherRewardRecordList(e){return e.type=p.r.RewardType.OTHERS_REWARD,this.getRewardRecordList(e)}async getUserRewardRecordList(e){var t,n;let o=new y.q$p(this.buildConfigure()),i=await o.getMyRewards({daoAddress:e.daoAddress,page:null!==(t=e.page)&&void 0!==t?t:1,pageSize:null!==(n=e.pageSize)&&void 0!==n?n:16,type:e.type}),r=new u.zv(i);return r.hasError()?r:u.zv.Ok(a.DAORewardRecordAdapter.fromServer(r.getData()))}async getPreviousRoundTop3Info(e){let t=Number("3"),n=new A.C(e,g.K),a=[];for(let e=0;e<t;e++)a.push(n.top3VotedPre(e),n.top3VotedWithdraw(e));for(let e=0;e<t;e++)a.push(n.top3NodePre(e),n.top3NodeWithdraw(e));a.push(n.top3VotedPoolPre(),n.top3NodePoolPre());let o=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider()),i=await o.all(a),r=[];for(let e=0;e<t;e++){let t=i[2*e],n=i[2*e+1];r.push({address:t,isWithdrawed:n,reward:0n,rank:e})}let s=[],d=2*t;for(let e=0;e<t;e++){let t=i[d+2*e],n=i[d+2*e+1];s.push({address:t,isWithdrawed:n,reward:0n,rank:e})}let u=4*t,l=i[u],p=i[u+1];return r.forEach((e,t)=>{if(e.address!==f.N){let n=0;0===t?n=60:1===t?n=30:2===t&&(n=10),e.reward=l*BigInt(3)*BigInt(n)/10000n}}),s.forEach((e,t)=>{if(e.address!==f.N){let n=0;0===t?n=60:1===t?n=30:2===t&&(n=10),e.reward=p*BigInt(30)*BigInt(n)/10000n}}),{daoAddress:e,previousVoteRanking:r.filter(e=>e.address!==f.N),previousNodeRanking:s.filter(e=>e.address!==f.N),pools:{voteRankPool:l,communityPool:p}}}async getPreviousRoundTop3InfoForUser(e,t){let n=Number("3"),a=new A.C(e,g.K),o=[];for(let e=0;e<n;e++)o.push(a.top3VotedPre(e),a.top3VotedWithdraw(e));for(let e=0;e<n;e++)o.push(a.top3NodePre(e),a.top3NodeWithdraw(e));o.push(a.top3VotedPoolPre(),a.top3NodePoolPre(),a.getTop3VotedReward(t),a.getTop3NodeReward(t));let i=new A.z(v.Q.getTargetNet().chainId,v.Q.getDefaultProvider()),r=await i.all(o),s=[],d=[];for(let e=0;e<n;e++)s.push(r[2*e]),d.push(r[2*e+1]);let u=[],l=[],p=2*n;for(let e=0;e<n;e++)u.push(r[p+2*e]),l.push(r[p+2*e+1]);let y=4*n,m=r[y],c=r[y+1],T=r[y+2],R=r[y+3],w=s.findIndex(e=>e.toLowerCase()===t.toLowerCase()),D=u.findIndex(e=>e.toLowerCase()===t.toLowerCase());return{daoAddress:e,userAddress:t,previousVoteRanking:{addresses:s.filter(e=>e!==f.N),withdrawStatus:d,userRank:w>=0?w:-1,userReward:T[0],userRewardRank:Number(T[1]),poolAmount:m},previousNodeRanking:{addresses:u.filter(e=>e!==f.N),withdrawStatus:l,userRank:D>=0?D:-1,userReward:R[0],userRewardRank:Number(R[1]),poolAmount:c}}}constructor(e=new d.Z){super(),(0,o._)(this,"httpRequest",void 0),this.httpRequest=e}}(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Boolean,Boolean]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getRankSimpleInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getRankInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.LuckyRewardRequest?Object:DaoDto.LuckyRewardRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getLuckyReward",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.VoteNodeRankRewardRequest?Object:DaoDto.VoteNodeRankRewardRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getUserVoteNodeRankReward",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.CurrentRoundInfoRequest?Object:DaoDto.CurrentRoundInfoRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getCurrentRoundInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.UserCurrentRoundInfoRequest?Object:DaoDto.UserCurrentRoundInfoRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getUserCurrentRoundSimpleInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.UserCurrentRoundInfoRequest?Object:DaoDto.UserCurrentRoundInfoRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getUserCurrentRoundInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof DaoDto||void 0===DaoDto.UserCancelAmountRequest?Object:DaoDto.UserCancelAmountRequest]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getUserCancelAmount",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,Number]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getDaoChainInfo",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getPreviousRoundTop3Info",null),(0,i.gn)([R.Z.Mark(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[String,String]),(0,i.w6)("design:returntype",Promise)],b.prototype,"getPreviousRoundTop3InfoForUser",null),b=(0,i.gn)([r.ZP.Singleton,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",["undefined"==typeof HttpRequest?Object:HttpRequest])],b),function(e){class t extends r.Vw.BaseDataAdapter{static fromServer(e){return new t().initialize(e)}toJSON(){return{userAddress:this.userAddress,votedAmount:this.votedAmount}}constructor(...e){super(...e),(0,o._)(this,"userAddress",void 0),(0,o._)(this,"votedAmount",void 0)}}e.LastLuckyRecordAdapter=t,(0,i.gn)([r.Vw.To(c.Z.builder_with_default_then_call(f.N,e=>e.unwrap()),"user"),(0,i.w6)("design:type",String)],t.prototype,"userAddress",void 0),(0,i.gn)([r.Vw.To(T.Z.builder_with_default_then_call(0,e=>D.Z.wei2eth(e.toFixed(0))),"votes"),(0,i.w6)("design:type",String)],t.prototype,"votedAmount",void 0);class n{static fromServer(e){return new n(e.daoAddress.charAt(e.daoAddress.length-1),e.daoName,e.daoImage,e.daoAddress,e.daoName,e.totalVotes)}toJSON(){return{id:this.id,name:this.name,icon:this.icon,address:this.address,symbol:this.symbol,totalVotes:this.totalVotes}}constructor(e,t,n,a,i,r){(0,o._)(this,"id",void 0),(0,o._)(this,"name",void 0),(0,o._)(this,"icon",void 0),(0,o._)(this,"address",void 0),(0,o._)(this,"symbol",void 0),(0,o._)(this,"totalVotes",void 0),this.id=e,this.name=t,this.icon=n,this.address=a,this.symbol=i,this.totalVotes=r}}e.DAOAdapter=n;class a{static fromServer(e,t){return new a(h.Z.SHA256(e.nodeAddress).toString(),t,e.nodeAddress,e.nodeType,0,e.createTime)}static fromDetailServer(e,t){return new a(h.Z.SHA256(e.nodeAddress).toString(),t,e.nodeAddress,p.r.NodeType.NONE,0,e.createTime)}toJSON(){return{id:this.id,daoAddress:this.daoAddress,walletAddress:this.walletAddress,nodeType:this.nodeType,totalVotes:this.totalVotes,createTime:1e3*this.createTime,timeShow:l.Z.dateFormat(new Date(1e3*this.createTime),"yyyy-MM-dd HH:mm:ss")}}constructor(e,t,n,a,i,r){(0,o._)(this,"id",void 0),(0,o._)(this,"daoAddress",void 0),(0,o._)(this,"walletAddress",void 0),(0,o._)(this,"nodeType",void 0),(0,o._)(this,"totalVotes",void 0),(0,o._)(this,"createTime",void 0),this.id=e,this.daoAddress=t,this.walletAddress=n,this.nodeType=a,this.totalVotes=i,this.createTime=r}}e.NodeAdapter=a;class s extends r.Vw.BaseDataAdapter{static getFactory(e){return t=>new s(e).initialize(t)}toJSON(){return{id:this.id.unwrap(),daoAddress:this.data.daoAddress,nodeAddress:this.nodeAddress.unwrap(),creationTime:this.creationTime.toJSTime()}}constructor(e){super(),(0,o._)(this,"data",void 0),(0,o._)(this,"nodeAddress",void 0),(0,o._)(this,"id",void 0),(0,o._)(this,"creationTime",void 0),this.data=e}}e.NodeInfoAdapter=s,(0,i.gn)([r.Vw.To(c.Z.builder_with_default(f.N)),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],s.prototype,"nodeAddress",void 0),(0,i.gn)([r.Vw.To(c.Z.builder_with_default("0"),{originName:"nodeId"}),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],s.prototype,"id",void 0),(0,i.gn)([r.Vw.To(m.Z.Time.fromTimestamp.bind(m.Z.Time),{originName:"createTime"}),(0,i.w6)("design:type",void 0===m.Z||void 0===m.Z.Time?Object:m.Z.Time)],s.prototype,"creationTime",void 0);class d extends r.Vw.BaseDataAdapter{get voteAmount(){return this.voteAmountInWei.div(10**this.options.decimals)}static fromServer(e){return new d({decimals:18}).initialize(e)}toJSON(){return{userAddress:this.userAddress.unwrap(),txHash:this.txHash.unwrap(),voteTime:this.voteTime.toJSTime(),voteNumber:this.voteNumber.valueOf(),voteAmount:this.voteAmount.toString()}}constructor(e){super(),(0,o._)(this,"options",void 0),(0,o._)(this,"userAddress",void 0),(0,o._)(this,"voteAmountInWei",void 0),(0,o._)(this,"voteNumber",void 0),(0,o._)(this,"voteTime",void 0),(0,o._)(this,"txHash",void 0),this.options=e}}e.VoteRecordAdapterV2=d,(0,i.gn)([r.Vw.To(c.Z.builder_with_default(f.N)),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],d.prototype,"userAddress",void 0),(0,i.gn)([r.Vw.To(T.Z,{originName:"amount"}),(0,i.w6)("design:type",void 0===T.Z?Object:T.Z)],d.prototype,"voteAmountInWei",void 0),(0,i.gn)([r.Vw.To(Number),(0,i.w6)("design:type","undefined"==typeof Number?Object:Number)],d.prototype,"voteNumber",void 0),(0,i.gn)([r.Vw.To(m.Z.Time.timestampBuilder(),{originName:"timestamp"}),(0,i.w6)("design:type",void 0===m.Z||void 0===m.Z.Time?Object:m.Z.Time)],d.prototype,"voteTime",void 0),(0,i.gn)([r.Vw.To(c.Z.builder_with_default("")),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],d.prototype,"txHash",void 0);class u{static fromServer(e){return new u(e.userAddress,e.txHash,m.Z.Time.fromTimestamp(e.timestamp).toJSTime(),e.voteNumber,e.amount.toString())}toViewModel(){return{userAddress:this.userAddress,txHash:this.txHash,voteTime:this.voteTime,voteNumber:this.voteNumber,voteAmount:this.voteAmount}}constructor(e,t,n,a,i){(0,o._)(this,"userAddress",void 0),(0,o._)(this,"txHash",void 0),(0,o._)(this,"voteTime",void 0),(0,o._)(this,"voteNumber",void 0),(0,o._)(this,"voteAmount",void 0),this.userAddress=e,this.txHash=t,this.voteTime=n,this.voteNumber=a,this.voteAmount=i}}e.VoteRecordAdapter=u;class y extends r.Vw.BaseDataAdapter{static fromServer(t){var n;return new y().initialize({...t,data:(null!==(n=t.daoRewardVOs)&&void 0!==n?n:[]).map(e.DAORewardRecordInfoAdapter.fromServer.bind(e.DAORewardRecordInfoAdapter))})}toJSON(){return{page:this.page,updateTime:this.updateTime.toJSTime(),data:this.data.map(e=>e.toJSON())}}constructor(){super(),(0,o._)(this,"page",void 0),(0,o._)(this,"updateTime",void 0),(0,o._)(this,"data",void 0)}}e.DAORewardRecordAdapter=y,(0,i.gn)([r.Vw.To(Number),(0,i.w6)("design:type",Number)],y.prototype,"page",void 0),(0,i.gn)([r.Vw.To(m.Z.BlockTime.timestampBuilder(()=>+new Date),{originName:"lastUpdateTime"}),(0,i.w6)("design:type",void 0===m.Z||void 0===m.Z.BlockTime?Object:m.Z.BlockTime)],y.prototype,"updateTime",void 0);class R extends r.Vw.BaseDataAdapter{idToString(){return this.id.unwrap()}addressToString(){return this.address.unwrap()}rewardToString(){return D.Z.wei2eth(this.reward.toFixed(0))}tokenRewardToString(){return D.Z.wei2eth(this.tokenReward.toFixed(0))}static fromServer(e){return new R().initialize(e)}toJSON(){return{id:this.idToString(),address:this.addressToString(),reward:this.rewardToString(),tokenReward:this.tokenRewardToString(),createTime:this.createTime.toJSTime(),type:this.type,typeText:"",amount:this.amount.toString(),tx:this.tx.unwrap()}}constructor(...e){super(...e),(0,o._)(this,"id",void 0),(0,o._)(this,"address",void 0),(0,o._)(this,"reward",void 0),(0,o._)(this,"tokenReward",new T.Z(0)),(0,o._)(this,"createTime",void 0),(0,o._)(this,"type",void 0),(0,o._)(this,"amount",void 0),(0,o._)(this,"tx",void 0)}}e.DAORewardRecordInfoAdapter=R,(0,i.gn)([r.Vw.To(c.Z.builder_with_default("0"),"txHash"),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],R.prototype,"id",void 0),(0,i.gn)([r.Vw.To(c.Z.builder_with_default(f.N),"userAddress"),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],R.prototype,"address",void 0),(0,i.gn)([r.Vw.To(T.Z.builder_with_default(0),{originName:"amount"}),(0,i.w6)("design:type",void 0===T.Z?Object:T.Z)],R.prototype,"reward",void 0),(0,i.gn)([r.Vw.To(T.Z.builder_with_default(0),{originName:"tokenAmount"}),(0,i.w6)("design:type",void 0===T.Z?Object:T.Z)],R.prototype,"tokenReward",void 0),(0,i.gn)([r.Vw.To(m.Z.Time.fromTimestamp.bind(m.Z.Time),{originName:"rewardTime"}),(0,i.w6)("design:type",void 0===m.Z||void 0===m.Z.Time?Object:m.Z.Time)],R.prototype,"createTime",void 0),(0,i.gn)([r.Vw.To(void 0,{originName:"rewardType"}),(0,i.w6)("design:type",void 0===p.r||void 0===p.r.RewardType?Object:p.r.RewardType)],R.prototype,"type",void 0),(0,i.gn)([r.Vw.To(T.Z),(0,i.w6)("design:type",void 0===T.Z?Object:T.Z)],R.prototype,"amount",void 0),(0,i.gn)([r.Vw.To(c.Z.builder_with_default(f.N),{originName:"txHash"}),(0,i.w6)("design:type",void 0===c.Z?Object:c.Z)],R.prototype,"tx",void 0);class w extends r.Vw.BaseDataAdapter{static getFactory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.N;return t=>new w(e).initialize(t)}toJSON(){return{rank:this.rank,votes:Number(this.votes),beVotes:this.beVotes.toNumber(),reward:this.reward.toNumber(),rewardType:this.rewardType,address:this.userAddress}}constructor(e){super(),(0,o._)(this,"userAddress",void 0),(0,o._)(this,"rank",void 0),(0,o._)(this,"votes",void 0),(0,o._)(this,"beVotes",void 0),(0,o._)(this,"reward",void 0),(0,o._)(this,"rewardType",void 0),this.userAddress=e,this.beVotes=new T.Z(0),this.reward=new T.Z(0)}}e.DAOUserRankInfoAdapter=w,(0,i.gn)([r.Vw.To(T.Z.builder_with_default_then_call(0,e=>e.toInteger())),(0,i.w6)("design:type",Number)],w.prototype,"rank",void 0),(0,i.gn)([r.Vw.To(T.Z.builder_with_default_then_call(0,e=>D.Z.wei2eth(e.toFixed(0))),"voteCount"),(0,i.w6)("design:type",String)],w.prototype,"votes",void 0),(0,i.gn)([r.Vw.To(T.Z)],w.prototype,"beVotes",void 0),(0,i.gn)([r.Vw.To(T.Z)],w.prototype,"reward",void 0),(0,i.gn)([r.Vw.To(T.Z.builder_with_default_then_call(p.r.RankRewardType.LUCKY_REWARD,e=>e.toInteger()),{originName:"type"}),(0,i.w6)("design:type",void 0===p.r||void 0===p.r.RankRewardType?Object:p.r.RankRewardType)],w.prototype,"rewardType",void 0)}(a||(a={}))},95665:function(e,t,n){"use strict";var a,o=n(10433),i=n(45650),r=n(63671),s=n(89769),d=n(1455),u=n(68651);!function(e){var t;(t=e.Params||(e.Params={})).DAO_ADDRESS="daoAddress",t.NODE_ADDRESS="nodeAddress";let n={daos:(0,r.ki)({pageSize:16,pageIndex:1}),tokenInfo:i.gF.new().toJSON(),nodeListFilters:{keyword:null,selectedDao:null},daoContractInfo:null,daoCurrentRoundInfo:null,recentVoteInfoToDao:null,nodes:(0,r.ki)({pageSize:16,pageIndex:1}),nodeDetail:a(),nodeCurrentRoundInfo:null,nodesCurrentRoundInfo:[],rankInfo:{},userRankInfo:[],userRewardInfo:{luckyReward:new u.Z(0),voteTopReward:new u.Z(0),nodeTopReward:new u.Z(0)},rewardRecord:{tempKeyword:"",filters:{keyword:null},tableData:(0,r.ki)({pageSize:8,pageIndex:1})},myClaimRecord:{filters:{type:null},tableData:(0,r.ki)({pageSize:13,pageIndex:0})},userInfo:null,userCancellableAmount:0n,userMaxCancelAmount:0n};function a(){return{id:"",daoAddress:"",nodeType:s.r.NodeType.CANDIDATE,totalVotes:0,creationTime:0,timeShow:"",manualVoting:"",votingAirdrop:"",votingNode:"",nodeAddress:""}}e.slice=(0,d.oM)({name:"dao",initialState:n,reducers:{updateDaos(e,t){e.daos={...e.daos,...t.payload}},clearDaos(e,t){e.daos.data=[],e.daos.pageIndex=1,e.daos.isEnd=!1,e.daos.isLoading=!1},updateTokenInfo(e,t){e.tokenInfo=t.payload},clearTokenInfo(e,t){e.tokenInfo=i.gF.new().toJSON()},updateDaoContractInfo(e,t){e.daoContractInfo=t.payload},clearDaoContractInfo(e,t){e.daoContractInfo=null},updateDaoContractInfoRoundDuration(e,t){e.daoCurrentRoundInfo&&e.daoContractInfo&&(e.daoCurrentRoundInfo.roundExpire=Math.min(e.daoCurrentRoundInfo.roundExpire+e.daoContractInfo.roundDurationAdd,+new Date+e.daoContractInfo.roundDurationMax))},updateCurrentRoundInfo(e,t){e.daoCurrentRoundInfo=t.payload},clearCurrentRoundInfo(e,t){e.daoCurrentRoundInfo=null},initRecentVoteInfoToDao(e,t){e.recentVoteInfoToDao=t.payload},updateRecentVoteInfoToDao(e,t){var n;e.recentVoteInfoToDao=[t.payload,null!==(n=e.recentVoteInfoToDao)&&void 0!==n?n:[]].flat().filter((e,t)=>t<5),e.daoCurrentRoundInfo&&e.daoContractInfo&&(e.daoCurrentRoundInfo.roundExpire=Math.min(e.daoCurrentRoundInfo.roundExpire+e.daoContractInfo.roundDurationAdd,+new Date+e.daoContractInfo.roundDurationMax))},clearRecentVoteInfoToDao(e,t){e.recentVoteInfoToDao=null},updateNodeListFilters(e,t){e.nodeListFilters={...e.nodeListFilters,...t.payload}},updateSelectedDao(e,t){e.nodeListFilters.selectedDao=t.payload},clearNodeListFilters(e,t){e.nodeListFilters.keyword=null,e.nodeListFilters.selectedDao=null},updateNodes(e,t){e.nodes={...e.nodes,...t.payload}},updateNodeNewPage(e,t){e.nodes.data=t.payload.data,e.nodes.pageIndex=t.payload.pageIndex,e.nodes.total=t.payload.total,e.nodes.isEnd=t.payload.isEnd,e.nodes.isLoading=!1},setNodesToLoading(e,t){e.nodes.isLoading=!0},setNodesToUnload(e,t){e.nodes.isLoading=!1},clearNodeList(e,t){e.nodes.data=[],e.nodes.pageIndex=1,e.nodes.isEnd=!1,e.nodes.isLoading=!1},updateNodeDetail(e,t){e.nodeDetail={...e.nodeDetail,...t.payload},o.Z.D("updateNodeDetail:".concat(JSON.stringify(e.nodeDetail)))},clearNodeDetail(e,t){e.nodeDetail=a()},updateNodeChainInfo(e,t){e.nodeCurrentRoundInfo=t.payload},updateNodesCurrentRoundInfo(e,t){let n=new Map;for(let a of(t.payload.forEach(e=>{n.set("".concat(e.daoAddress,",").concat(e.nodeAddress),e)}),e.nodesCurrentRoundInfo=e.nodesCurrentRoundInfo.map(e=>{if(n.has("".concat(e.daoAddress,",").concat(e.nodeAddress))){var t;e.promotionInfo=null===(t=n.get("".concat(e.daoAddress,",").concat(e.nodeAddress)))||void 0===t?void 0:t.promotionInfo,n.delete("".concat(e.daoAddress,",").concat(e.nodeAddress))}return e}),n.values()))e.nodesCurrentRoundInfo.push(a)},updateSimpleRankInfo(e,t){e.rankInfo.luckyUsers=t.payload.luckyUsers,e.rankInfo.voteUsers=t.payload.voteUsers,e.rankInfo.nodeUsers=t.payload.nodeUsers,e.rankInfo.prevVoteUsers=t.payload.prevVoteUsers,e.rankInfo.prevNodeUsers=t.payload.prevNodeUsers,e.rankInfo.voteWithdrawed=t.payload.voteWithdrawed,e.rankInfo.nodeWithdrawed=t.payload.nodeWithdrawed},updateDetailRankInfo(e,t){e.rankInfo.luckyRank=t.payload.luckyRank,e.rankInfo.voteRank=t.payload.voteRank,e.rankInfo.nodeRank=t.payload.nodeRank},clearRankInfo(e,t){e.rankInfo={}},updateUserRankInfo(e,t){e.userRankInfo=t.payload},updateUserRankRewardInfo(e,t){e.userRankInfo=e.userRankInfo.map(e=>{let n=new Map(t.payload).get(e.rewardType);return n&&(e.reward=n),e})},clearUserRankInfo(e,t){e.userRankInfo=[]},updateUserRewardInfo(e,t){e.userRewardInfo=t.payload},clearUserRewardInfo(e,t){e.userRewardInfo={luckyReward:new u.Z(0),voteTopReward:new u.Z(0),nodeTopReward:new u.Z(0)}},updateRewardRecordTempKeyword(e,t){e.rewardRecord.tempKeyword=t.payload},updateRewardRecordFilters(e,t){e.rewardRecord.filters={...e.rewardRecord.filters,...t.payload}},updateRewardRecordTable(e,t){e.rewardRecord.tableData={...e.rewardRecord.tableData,...t.payload}},clearRewardRecordTableData(e,t){e.rewardRecord.tableData.data=[],e.rewardRecord.tableData.pageIndex=1,e.rewardRecord.tableData.isEnd=!1,e.rewardRecord.tableData.isLoading=!1},clearRewardRecord(e,t){e.rewardRecord.tableData.data=[],e.rewardRecord.tableData.pageIndex=1,e.rewardRecord.tableData.isEnd=!1,e.rewardRecord.tableData.isLoading=!1,e.rewardRecord.tempKeyword="",e.rewardRecord.filters.keyword=null},updateMyClaimRecordFilters(e,t){e.myClaimRecord.filters={...e.myClaimRecord.filters,...t.payload}},clearMyClaimRecordFilters(e,t){e.myClaimRecord.filters.type=null},updateMyClaimRecordTableData(e,t){e.myClaimRecord.tableData={...e.myClaimRecord.tableData,...t.payload}},updateMyClaimRecordTableDataToLoading(e,t){e.myClaimRecord.tableData.isLoading=!0},updateMyClaimRecordTableDataToDone(e,t){e.myClaimRecord.tableData.isLoading=!1},clearMyClaimRecordTableData(e,t){e.myClaimRecord.tableData.data=[],e.myClaimRecord.tableData.pageIndex=0,e.myClaimRecord.tableData.isEnd=!1,e.myClaimRecord.tableData.isLoading=!1},updateUserInfo(e,t){e.userInfo=t.payload},clearUserInfo(e,t){e.userInfo=null},updateUserCancelAmount(e,t){e.userCancellableAmount=t.payload.canCancelAmount,e.userMaxCancelAmount=t.payload.maxCancelAmount},clearUserCancelAmount(e,t){e.userCancellableAmount=0n,e.userMaxCancelAmount=0n}}})}(a||(a={})),t.Z=a},56196:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var a=n(74439),o=n(43009),i=n(80149),r=n(56611),s=n(6178),d=n(69356),u=n(2265);function l(){let e=(0,s.T)(),t=(0,s.C)(e=>e.global),n=(0,s.C)(e=>e.user),{connectETHWallet:l}=u.useContext(i.Cv);async function p(){return n.ethInfo.isConnected?!!t.token||(e(d.Z.slice.actions.updateNeedBinding(!0)),!1):(e(d.Z.slice.actions.updateNeedBinding(!0)),await l(r.w3.WALLETCONNECT),!1)}async function y(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.Z.Seconds.from(30);n.ethInfo.isConnected||(e(d.Z.slice.actions.updateNeedBinding(!0)),await l(r.w3.WALLETCONNECT)),t.token||await e(d.Z.slice.actions.updateNeedBinding(!0)),await function*(){let e=0;for(;!t.token;){if(e>=i.toJSTime())return!1;let t=o.Z.Time.oneSecond();yield a.Z.sleepForAnimationFrame(t),e+=t.toJSTime()}return!0}()}return{isLogin:!!t.token&&n.ethInfo.walletAddress,handleLogin:p,loginThen:y}}},56856:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var a=n(6178),o=n(95665),i=n(2265),r=n(99376),s=n(88847),d=n(83123),u=n(43949),l=n(22928),p=n(74439),y=n(20605);function m(e){let{t}=(0,u.$G)(["dao"]),n=(0,r.useRouter)(),m=(0,a.T)(),c=(0,a.C)(e=>e.dao),T=(0,a.C)(e=>e.global),[f,R]=i.useState(null);async function w(){let e=new l.Z,t=await e.getDaoSimpleInfo(f?{daoAddress:f}:{});if(t.hasError()){let e=t.getError();return(0,d.L6)(e.msg),Promise.reject(e)}return t.getData()}async function v(){let e=await w();R(e.address),m(o.Z.slice.actions.updateSelectedDao(e));let t=new URLSearchParams(location.search);e.address!==t.get(o.Z.Params.DAO_ADDRESS)&&(t.set(o.Z.Params.DAO_ADDRESS,e.address),n.push("?".concat(t.toString())))}async function g(e){let t=new s.Z,n=await t.getSimpTokenInfoForDaoNodeApply({tokenAddress:e});if(n.hasError()){let e=n.getError();return(0,d.L6)(e.msg),Promise.reject(e)}return n.getData()}async function A(e){var t;if(!(e=null!=e?e:null===(t=c.daoContractInfo)||void 0===t?void 0:t.tokenAddress))throw Error("Token address is not set");let n=await g(e);return m(o.Z.slice.actions.updateTokenInfo(n)),n}function D(){m(o.Z.slice.actions.clearTokenInfo())}return i.useEffect(()=>{if(null===f||!T.isLoginStatusInitialized)return;let e=new AbortController;return p.Z.sleepForAnimationFrame(16).wait(()=>{e.signal.aborted||v()}),()=>{e.abort(y.Z.ReactError.useEffectDestroy())}},[T.isLoginStatusInitialized,f]),i.useEffect(()=>{if(!(null==e?void 0:e.autoTrigger))return;let t=new URLSearchParams(location.search).get(o.Z.Params.DAO_ADDRESS);if(!t)return R("");R(t)},[]),i.useEffect(()=>{var t;if(null==e?void 0:e.autoUpdateTokenInfo){if(!(null===(t=c.daoContractInfo)||void 0===t?void 0:t.tokenAddress))return D();A()}},[c.daoContractInfo]),{daoAddress:f,setDaoAddress:R,getInfo:w,updateInfo:v,getTokenInfo:g,updateTokenInfo:A,clearTokenInfo:D}}},72917:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var a=n(10433),o=n(83123),i=n(70042),r=n(6178),s=n(95665),d=n(3876),u=n(94552),l=n(41662),p=n(43949),y=n(81939),m=n(68651),c=n(2265),T=n(56856),f=n(43009),R=n(13965),w=n(49481),v=n(22928),g=n(74439),A=n(20605),D=n(56196),h=n(64798),I=n.n(h);function b(e,t){var n,h,b,N,E,_,C,O;let M=(0,r.T)();(0,r.C)(e=>e.global);let S=(0,r.C)(e=>e.user),k=(0,r.C)(e=>e.dao),{t:U}=(0,p.$G)(["common","dao"]);(0,T.Z)({autoTrigger:null==t?void 0:t.autoTrigger,autoUpdateTokenInfo:null==t?void 0:t.autoUpdateTokenInfo});let Z=(0,w.Z)(S.ethInfo.walletAddress),L=(0,D.I)(),V=new v.Z,[P,F]=c.useState(0),[x,W]=c.useState(!1);async function z(){var t,n;let a=null!==(n=null!=e?e:null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)&&void 0!==n?n:"";if(!a)throw Error("No dao address");return V.getDaoChainInfo(a)}async function B(){var t;let n=Date.now();if((!(n-P<3e4)||!k.daoContractInfo||k.daoContractInfo.daoAddress!==(null!=e?e:null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address))&&!x)try{W(!0);let e=await z();M(s.Z.slice.actions.updateDaoContractInfo(e)),F(n)}catch(e){a.Z.E("useDAOChainInfo::updateInfo error",e)}finally{W(!1)}}async function J(){a.Z.I("useDAOChainInfo::clearInfo"),M(s.Z.slice.actions.clearDaoContractInfo())}async function K(t){var n,a,o;let i=null!==(o=null!=e?e:null===(n=k.nodeListFilters.selectedDao)||void 0===n?void 0:n.address)&&void 0!==o?o:"";if(!i)throw Error("No dao address");if(!(t=null!=t?t:k.nodeDetail.nodeAddress))throw Error("No node address");if(!(null===(a=k.daoContractInfo)||void 0===a?void 0:a.currentRoundNO))throw Error("No current round no");let r=await V.getUserCurrentRoundInfo({daoAddress:i,userAddress:t,currentRoundNO:k.daoContractInfo.currentRoundNO});M(s.Z.slice.actions.updateNodeChainInfo({...r,nodeAddress:t}))}async function H(){var t,n,a;let o=null!==(a=null!=e?e:null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)&&void 0!==a?a:"";if(!o)throw Error("No dao address");let i=S.ethInfo.walletAddress;if(!i)return M(s.Z.slice.actions.clearUserInfo());if(!(null===(n=k.daoContractInfo)||void 0===n?void 0:n.currentRoundNO))throw Error("No current round no");let r=await V.getUserCurrentRoundInfo({daoAddress:o,userAddress:i,currentRoundNO:k.daoContractInfo.currentRoundNO});M(s.Z.slice.actions.updateUserInfo(r))}async function j(){var t;let n=e||(null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)||"";if(!n)throw Error("No dao address");if(!k.daoContractInfo)throw Error("No current round no and create time");try{let e=k.daoContractInfo.createTime,t=k.daoContractInfo.voteRankClaimDurationAdd,a=k.daoContractInfo.rewardRoundPass,o=v.Z.getCurrentRewardRoundTimestamp(e,t,a),i=await V.getCurrentRoundInfo({daoAddress:n,currentRoundNO:k.daoContractInfo.currentRoundNO,targetWeek:o});M(s.Z.slice.actions.updateCurrentRoundInfo(i))}catch(e){(0,o.L6)(new o.HU(e,U("FailedToUpdateCurrentRoundInfo")).asToastMessage())}}async function q(){M(s.Z.slice.actions.clearCurrentRoundInfo())}async function Q(e,t){var n,a;let o=null!==(a=null!=e?e:null===(n=k.nodeListFilters.selectedDao)||void 0===n?void 0:n.address)&&void 0!==a?a:"";if(!o)throw Error("No dao address");if(!(t=null!=t?t:S.ethInfo.walletAddress))throw Error("No user address");let[i,r]=await V.getUserCancelAmount({daoAddress:o,userAddress:t});M(s.Z.slice.actions.updateUserCancelAmount({canCancelAmount:i,maxCancelAmount:r}))}async function Y(e){var t,n,r,s,p;if(!(null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)){(0,o.L6)(U("dao:NoSelectedDao"));return}if(!k.nodeDetail.nodeAddress){(0,o.L6)(U("dao:NoSelectedNode"));return}if(!await L.handleLogin())return;if(await d.ru(null!==(s=null===(n=k.nodeCurrentRoundInfo)||void 0===n?void 0:n.userInfo.parent)&&void 0!==s?s:u.N)===await d.ru(S.ethInfo.walletAddress)){(0,o.L6)(U("dao:CannotVoteToEach"));return}let c=new m.Z(y.Z.wei2eth(null!==(p=null===(r=k.daoContractInfo)||void 0===r?void 0:r.votePrice)&&void 0!==p?p:l.fi("0.1"))).multipliedBy(e);if(c.gte(S.ethInfo.walletBalance)){(0,o.L6)(U("common:NotEnoughBalance"));return}let T=R.r.getInstance(),f=y.Z.getInstance(T.getProvider()),w=await f.getSigner(),v=i.bR.connect(k.nodeListFilters.selectedDao.address,w);try{let t=l.fi(c.toString()),n=await v.vote(k.nodeDetail.nodeAddress,e.toString(),{value:t}),a=await n.wait();(0,o.x9)(U("VoteSuccess"));let i=Promise.all([Z.updateETHBalance(),K(),H()]);return{txRes:n,receipt:a,updateDataPromise:i}}catch(e){(0,o.L6)(new o.HU(e,U("VoteFailed")).asToastMessage()),a.Z.E(e);return}}async function G(){var e,t;if(!(null===(e=k.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)){(0,o.L6)(U("NoSelectedDao"));return}if(!k.nodeDetail.nodeAddress){(0,o.L6)(U("NoSelectedNode"));return}if(!await L.handleLogin())return;let n=R.r.getInstance(),r=y.Z.getInstance(n.getProvider()),s=await r.getSigner(),d=i.bR.connect(null===(t=k.nodeListFilters.selectedDao)||void 0===t?void 0:t.address,s);try{await d.quit()}catch(e){(0,o.L6)(new o.HU(e,U("CancelVoteFailed")).asToastMessage()),a.Z.E(e);return}(0,o.x9)(U("CancelVoteSuccess"))}async function $(){var e;let t=null===(e=k.daoCurrentRoundInfo)||void 0===e?void 0:e.daoAddress;if(!t)throw Error("DAO address not found!");if(!await L.handleLogin())return;let n=R.r.getInstance(),r=y.Z.getInstance(n.getProvider()),s=await r.getSigner(),d=i.bR.connect(t,s);try{let e=await d.restart();await e.wait(),(0,o.x9)(U("SuccessfullyOpenDAO")),B()}catch(e){(0,o.L6)(new o.HU(e,U("FailedToRestartDAO")).asToastMessage()),a.Z.E("useDAOChainInfo::reopenDAO",e)}}let X=c.useCallback(I()(()=>{B().catch(e=>{(0,o.L6)(new o.HU(e,U("FailedToUpdateInfo")).asToastMessage()),a.Z.E("useDAOChainInfo::updateInfo",e)})},500),[null===(n=k.nodeListFilters.selectedDao)||void 0===n?void 0:n.address]),ee=c.useCallback(I()(()=>{j().catch(e=>{(0,o.L6)(new o.HU(e,U("FailedToUpdateCurrentRoundInfo")).asToastMessage()),a.Z.E("useDAOChainInfo::updateCurrentRoundInfo",e)})},500),[null===(h=k.daoContractInfo)||void 0===h?void 0:h.daoAddress,null===(b=k.nodeListFilters.selectedDao)||void 0===b?void 0:b.address]),et=c.useCallback(I()(()=>{H().catch(e=>{(0,o.L6)(new o.HU(e,U("FailedToUpdateUserCurrentRoundInfo")).asToastMessage()),a.Z.E("useDAOChainInfo::updateUserCurrentRoundInfo",e)})},500),[null===(N=k.daoContractInfo)||void 0===N?void 0:N.currentRoundNO,S.ethInfo.walletAddress]);return c.useEffect(()=>{var e;if(!(null==t?void 0:t.autoTrigger)||!(null===(e=k.nodeListFilters.selectedDao)||void 0===e?void 0:e.address))return;let n=g.Z.sleepForAnimationFrame(f.Z.Milliseconds.from(100));return n.wait(()=>{X()}),()=>{n.cancel(A.Z.ReactError.useEffectDestroy())}},[null===(E=k.nodeListFilters.selectedDao)||void 0===E?void 0:E.address,X,null==t?void 0:t.autoTrigger]),c.useEffect(()=>{var e;if(!(null==t?void 0:t.autoTrigger)||!(null===(e=k.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)||!k.daoContractInfo)return;let n=g.Z.sleepForAnimationFrame(f.Z.Milliseconds.from(100));return n.wait(()=>{ee()}),()=>{n.cancel(A.Z.ReactError.useEffectDestroy())}},[null===(_=k.daoContractInfo)||void 0===_?void 0:_.daoAddress,null===(C=k.nodeListFilters.selectedDao)||void 0===C?void 0:C.address,ee,null==t?void 0:t.autoTrigger]),c.useEffect(()=>{var e,n;if(!(null==t?void 0:t.autoTrigger))return;if(!S.ethInfo.walletAddress||!(null===(e=k.daoContractInfo)||void 0===e?void 0:e.currentRoundNO)||!(null===(n=k.nodeListFilters.selectedDao)||void 0===n?void 0:n.address)){M(s.Z.slice.actions.clearUserInfo());return}let a=g.Z.sleepForAnimationFrame(f.Z.Milliseconds.from(100));return a.wait(()=>{et()}),()=>{a.cancel(A.Z.ReactError.useEffectDestroy())}},[null===(O=k.daoContractInfo)||void 0===O?void 0:O.currentRoundNO,S.ethInfo.walletAddress,et,null==t?void 0:t.autoTrigger]),{getInfo:z,updateInfo:B,clearInfo:J,updateUserCurrentRoundInfo:H,updateNodeCurrentRoundInfo:K,updateCurrentRoundInfo:j,clearCurrentRoundInfo:q,updateCancelInfo:Q,voteForNode:Y,cancelVote:G,reopenDAO:$}}},89769:function(e,t,n){"use strict";var a,o,i,r,s,d,u;n.d(t,{r:function(){return a}}),n(2265),(i=(o=a||(a={})).VotingTabEnum||(o.VotingTabEnum={}))[i.NONE=0]="NONE",i[i.VOTE=1]="VOTE",i[i.EWV=2]="EWV",i[i.NODE=3]="NODE",i[i.GOVERNANCE=4]="GOVERNANCE",(r=o.RankRewardType||(o.RankRewardType={}))[r.LUCKY_REWARD=0]="LUCKY_REWARD",r[r.VOTE_TOP_REWARD=1]="VOTE_TOP_REWARD",r[r.NODE_TOP_REWARD=2]="NODE_TOP_REWARD",(s=o.NodeType||(o.NodeType={}))[s.NONE=0]="NONE",s[s.CANDIDATE=1]="CANDIDATE",s[s.MASTER=2]="MASTER",s[s.SUPER=3]="SUPER",(d=o.MyAssetsPageTab||(o.MyAssetsPageTab={})).MyReward="MyReward",d.MyRecords="MyRecords",d.ApplyNode="ApplyNode",(u=o.RewardType||(o.RewardType={}))[u.VOTE_REWARD=0]="VOTE_REWARD",u[u.VOTE_TOP_REWARD=1]="VOTE_TOP_REWARD",u[u.NODE_TOP_REWARD=2]="NODE_TOP_REWARD",u[u.LUCKY_REWARD=3]="LUCKY_REWARD",u[u.OTHERS_REWARD=4]="OTHERS_REWARD"},17104:function(){}}]);