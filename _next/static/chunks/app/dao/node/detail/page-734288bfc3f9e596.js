(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6827],{76634:function(e,t,n){Promise.resolve().then(n.bind(n,6630))},6630:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ea}});var r=n(57437),a=n(97235),i=n(68071),o=n(27635),s=n(38435),l=n(10990),d=n(89769),c=n(2265),u=n(43949);n(99376);var m=n(53335),f=n(59365),g=n(72790),v=n(65435),h=n(3682),p=n(68651),x=n(6178),N=n(43009);function Z(e){let{mintPrice:t,amount:n,setAmount:a,maxAmount:i}=e,o=(0,x.C)(e=>e.token);h.Q.getTargetNet();let s=new p.Z(t.toString()),l=e=>{e>=1&&e<=i&&a(e)};return(0,r.jsxs)("div",{className:"flex flex-col items-stretch gap-[10px]",children:[(0,r.jsxs)("div",{className:"w-full xl:w-auto flex flex-row justify-between gap-2 items-center flex-wrap border border-[#666] p-[20px] rounded-lg",children:[(0,r.jsxs)(g.Z,{className:"items-center gap-2",children:[(0,r.jsx)(f.Z,{className:"w-6 h-6"}),(0,r.jsx)("span",{className:"text-lg font-semibold",children:N.Z.toFixed(s.multipliedBy(n).toNumber(),o.decimals)})]}),(0,r.jsxs)("div",{className:"w-auto flex flex-col md:flex-row item-stretch md:items-center gap-3",children:[(0,r.jsx)("span",{className:"hidden md:block w-[1px] h-[45px] bg-[#111]"}),(0,r.jsxs)("div",{className:"order-1 md:order-2 flex gap-2 item-stretch md:items-center",children:[(0,r.jsx)("button",{className:"w-[43px] text-center px-2 py-1 border border-[#666666] rounded",onClick:()=>l(Math.max(1,n-1)),children:"-"}),(0,r.jsx)("input",{type:"number",className:"w-[65px] text-center px-4 py-1 border border-[#666666] rounded bg-transparent",value:n,onChange:e=>l(Number(e.target.value))}),(0,r.jsx)("button",{className:"w-[43px] text-center px-2 py-1 border border-[#666666] rounded",onClick:()=>l(n+1),children:"+"})]})]})]}),(0,r.jsx)("div",{className:"flex justify-between gap-[13px] flex-wrap",children:[3,5,10,20].map(e=>(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(v.ZP,{className:(0,m.m6)("w-full h-[33px] leading-[33px] border border-[#666] text-[#999]",e===n?"border-primary text-primary":""),size:v.qE.Customize,status:v.Dv.None,onClick:()=>l(e),children:e})},e))})]})}var w=n(74439),j=n(54740),C=n(56679),T=n(69367),A=n(83123),b=n(20605),y=n(10433),I=n(22928),E=n(95665),D=n(72917),S=n(49481);function R(e){let t=(0,x.T)(),n=(0,x.C)(e=>e.dao),r=(0,x.C)(e=>e.user),a=(0,D.Z)(e.daoAddress||void 0,{autoTrigger:e.autoTrigger,autoUpdateTokenInfo:!0}),i=(0,S.Z)(r.ethInfo.walletAddress);async function o(t){let n=new I.Z,r=await n.getNodeDetail({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,signal:null==t?void 0:t.signal});if(r.hasError()){let e=r.getError();return(0,A.L6)(e.msg),y.Z.E(e),Promise.reject(e)}return r.getData()}function s(){t(E.Z.slice.actions.clearNodeDetail())}async function l(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.nodeAddress)return s();let r=await o(n);t(E.Z.slice.actions.updateNodeDetail(r))}return c.useEffect(()=>{if(!(null==e?void 0:e.autoTrigger)||!e.daoAddress||!e.nodeAddress||e.nodeAddress===n.nodeDetail.nodeAddress)return;let t=new AbortController;return l({signal:t.signal}),()=>{t.abort(b.Z.ReactError.useEffectDestroy()),s()}},[e.daoAddress,e.nodeAddress]),c.useEffect(()=>{var t,r,i;if(!(null==e?void 0:e.autoTrigger)||!e.daoAddress||!e.nodeAddress||e.daoAddress!==(null===(t=n.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)||(null===(r=n.daoContractInfo)||void 0===r?void 0:r.daoAddress)!==(null===(i=n.nodeListFilters.selectedDao)||void 0===i?void 0:i.address)||e.nodeAddress!==n.nodeDetail.nodeAddress)return;let o=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return o.wait(()=>a.updateNodeCurrentRoundInfo(e.nodeAddress)),()=>{o.cancel(b.Z.ReactError.useEffectDestroy())}},[e.daoAddress,e.nodeAddress,n.nodeDetail,n.daoContractInfo,n.nodeListFilters.selectedDao]),c.useEffect(()=>{var t;if(!e.autoTrigger||!(null===(t=n.daoContractInfo)||void 0===t?void 0:t.tokenAddress)||!r.ethInfo.walletAddress)return;let a=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return a.wait(i.updateETHBalance),()=>{a.cancel(b.Z.ReactError.useEffectDestroy())}},[n.daoContractInfo,r.ethInfo.walletAddress]),{getData:o,updateData:l,clearData:s}}var L=n(81939),k=n(34826);function P(e){var t,n,r,a,i,o;let s=(0,x.C)(e=>e.dao);e=null!=e?e:s.nodeCurrentRoundInfo;let l=k.Z.createSafeBigNumber(L.Z.wei2eth(null!==(r=null==e?void 0:e.promotionInfo.totalSonVotedAmount)&&void 0!==r?r:0n)),d=null!==(a=null===(t=s.daoContractInfo)||void 0===t?void 0:t.votePrice)&&void 0!==a?a:1n,c=k.Z.safeBigIntDivision(null!==(i=null==e?void 0:e.promotionInfo.totalSonEthDone)&&void 0!==i?i:0n,d)*d,u=k.Z.createSafeBigNumber(L.Z.wei2eth(c)),m=k.Z.safeBigNumberOperation(()=>l.plus(u)),f=null!==(o=null===(n=s.daoContractInfo)||void 0===n?void 0:n.dailyRewardRate)&&void 0!==o?o:.02,g=k.Z.safeBigNumberOperation(()=>m.multipliedBy(f));return{manualVoting:l,automaticVoting:u,totalVoteAmount:m,votingAirdrop:g}}var F=n(56196),B=n(75370);function O(){var e,t,n,a,i,o,s,l,d,f;(0,x.T)();let g=(0,x.C)(e=>e.global),j=(0,x.C)(e=>e.user),C=(0,x.C)(e=>e.dao),{t:A}=(0,u.$G)(["dao"]),b=(0,D.Z)(),y=(0,B.Z)(),I=L.Z.wei2eth(null!==(o=null===(e=C.daoContractInfo)||void 0===e?void 0:e.votePrice)&&void 0!==o?o:1n),[E,S]=c.useState(1),R=new p.Z(j.ethInfo.walletBalance),k=new p.Z("10").dividedToIntegerBy(I),P=p.Z.min(R.dividedToIntegerBy(I),k),F=h.Q.getTargetNet(),O=0===g.currentTime?0:w.Z.convertTimeDifference(new Date((null!==(s=null===(t=C.userInfo)||void 0===t?void 0:t.voteInfo.votedDatePre)&&void 0!==s?s:0)+(null!==(l=null===(n=C.daoContractInfo)||void 0===n?void 0:n.voteDuration)&&void 0!==l?l:N.Z.Hours.from(24).toJSTime())-g.currentTime)),_="w-full font-semibold",[M,z]=c.useState(!1),q=null!==(d=null===(a=j.tokenBalances.find(e=>e.address===C.tokenInfo.address))||void 0===a?void 0:a.balance)&&void 0!==d?d:"0",U=c.useRef(null);return c.useEffect(()=>{var e;if(!j.ethInfo.walletAddress||!(null===(e=C.nodeListFilters.selectedDao)||void 0===e?void 0:e.address))return;let t=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return t.promise.then(()=>{var e;(null===(e=C.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)&&j.ethInfo.walletAddress&&b.updateCancelInfo(C.nodeListFilters.selectedDao.address,j.ethInfo.walletAddress)}),()=>{t.cancel()}},[C.nodeListFilters.selectedDao,j.ethInfo.walletAddress]),(0,r.jsxs)("div",{className:"p-6 bg-[#050505] border border-[#666666] rounded-lg",children:[(0,r.jsx)("h2",{className:"text-xl mb-4 font-medium text-center",children:A("dao:VoteTitle")}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(Z,{mintPrice:I,amount:E,setAmount:S,maxAmount:P.toNumber()}),(0,r.jsxs)("div",{className:"flex items-center gap-1 relative text-[14px]",ref:U,children:[(0,r.jsxs)("span",{children:[A("Balance"),":"]}),N.Z.toFixed(Number(j.ethInfo.walletBalance),4),(0,r.jsx)("span",{children:F.nativeCurrency.symbol}),(0,r.jsx)(T.Z,{targetContain:U.current,tooltipClassName:"-mt-[39px]",children:(0,r.jsx)("span",{className:"text-[12px] font-medium text-white",children:A("VoteTip",{price:I,unitAmount:1,maxAmount:"20",timeAmount:1,resetTime:N.Z.Time.fromJSTimestamp(null!==(f=null===(i=C.daoContractInfo)||void 0===i?void 0:i.voteDuration)&&void 0!==f?f:0n).toHours()})})})]}),0!==O?(0,r.jsx)(v.ZP,{className:(0,m.m6)(_),status:v.Dv.NoImportant,children:(0,r.jsx)("span",{className:"text-gradient",children:O.toFormated()})}):(0,r.jsx)(v.ZP,{className:(0,m.m6)(_),size:v.qE.Normal,status:y.isRoundEnd?v.Dv.Disabled:v.Dv.Active,waitForClick:!0,onClick:()=>b.voteForNode(E.toString()),children:A("VoteButton")}),(0,r.jsx)("div",{className:"flex flex-col justify-cemter items-end gap-2",children:(0,r.jsxs)(v.ZP,{className:(0,m.m6)(""),size:v.qE.Customize,status:v.Dv.None,waitForClick:!0,onClick:()=>{z(!0)},children:[(0,r.jsx)("span",{className:(0,m.m6)("text-[14px] font-medium","text-gradient"),children:A("CancelVote")}),(0,r.jsx)("div",{className:"w-full h-[1px] bg-gradient-to-r from-primary to-highlight"})]})})]}),(0,r.jsx)(V,{isOpen:M,requestClose:()=>z(!1),tokenInfo:C.tokenInfo,tokenBalance:Number(q)})]})}function V(e){var t,n,a,o;(0,x.C)(e=>e.global);let s=(0,x.C)(e=>e.dao),{t:l}=(0,u.$G)(["dao"]),d=(0,F.I)(),m=(0,D.Z)(),g=R({daoAddress:null!==(a=null===(t=s.daoContractInfo)||void 0===t?void 0:t.daoAddress)&&void 0!==a?a:"",nodeAddress:s.nodeDetail.nodeAddress});P();let{cancelRate:v,leftCancelValue:h,cancellableDisplayValue:Z}=function(){var e,t,n,r,a,i,o,s,l,d,c,u;let m=(0,x.C)(e=>e.global),f=(0,x.C)(e=>e.dao),g=null!==(o=null===(e=f.daoContractInfo)||void 0===e?void 0:e.cancelRate)&&void 0!==o?o:0,v=new p.Z(L.Z.wei2eth(null!==(s=null===(t=f.daoCurrentRoundInfo)||void 0===t?void 0:t.pool.airdropPool)&&void 0!==s?s:0n)).multipliedBy(g),h=(null!==(l=null===(n=f.userInfo)||void 0===n?void 0:n.voteInfo.roundFirstVotedDate)&&void 0!==l?l:0)+(null!==(d=null===(r=f.daoContractInfo)||void 0===r?void 0:r.cancelDurationTime)&&void 0!==d?d:0)<=m.currentTime,N=null===(c=null===(a=f.userInfo)||void 0===a?void 0:a.voteInfo.quited)||void 0===c||c,Z=new p.Z(L.Z.wei2eth(null!==(u=null===(i=f.daoCurrentRoundInfo)||void 0===i?void 0:i.quitAmount)&&void 0!==u?u:0n)),w=p.Z.max(v.minus(Z),0);return{cancelRate:g,maxCancelValue:v,leftCancelValue:w,cancellableDisplayValue:N||h?f.userCancellableAmount:f.userMaxCancelAmount}}(),w=s.userCancellableAmount>0n;async function b(){await g.updateData()}async function y(){var t;if(!(null===(t=s.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)){(0,A.L6)(l("NoSelectedDao"));return}if(await d.handleLogin()){if(!w){(0,A.L6)(l("NoCancelVote"));return}await m.cancelVote(),b(),e.requestClose()}}let I=c.useRef(null);return(0,r.jsx)(C.Z,{isOpen:e.isOpen,onRequestClose:e.requestClose,title:l("CancelVote"),size:"small",controls:{buttons:[{text:l("Back"),type:"normal",onClick:e.requestClose},...w?[{text:l("CancelVote"),type:"active",onClick:y}]:[]]},children:(0,r.jsx)("div",{className:"flex flex-col items-stretch gap-[18px]",children:(0,r.jsx)("div",{className:"flex flex-col items-start gap-[20px]",children:(0,r.jsx)(i.ZP,{autoMargin:!1,autoPadding:!1,className:"w-full p-[10px_17px]",children:(0,r.jsx)("div",{className:"relative",ref:I,children:[{key:"totalVotes",title:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[l("TotalCancelAmount"),(0,r.jsx)(T.Z,{targetContain:I.current,children:l("CancelVoteTip",{rate:1e3*v,time:N.Z.Time.fromJSTimestamp(null!==(o=null===(n=s.daoContractInfo)||void 0===n?void 0:n.cancelDurationTime)&&void 0!==o?o:0n).toHours()})})]}),value:(0,r.jsx)(j.eO,{value:h.toNumber(),children:(0,r.jsx)(f.Z,{})})},{key:"cancelScope",title:l("CancelScope"),value:(0,r.jsx)(j.eO,{value:Number(L.Z.wei2eth(Z)),children:(0,r.jsx)(f.Z,{})})}].map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center leading-[178%]",children:[(0,r.jsx)("span",{children:e.title}),(0,r.jsx)("span",{children:e.value})]},e.key))})})})})})}var _=n(79787),M=n(48423),z=n(50544);function q(e){var t,n,a,i,o,s;let{t:l}=(0,u.$G)(["dao"]),c=(0,x.C)(e=>e.dao),m=(0,z.Z)(),f=h.Q.getTargetNet(),g=P(),v=function(){var e,t,n,r,a,i,o,s;let l=(0,x.C)(e=>e.dao),d=k.Z.createSafeBigNumber(L.Z.wei2eth(null!==(a=null===(e=l.userInfo)||void 0===e?void 0:e.effectiveVote)&&void 0!==a?a:0n)),c=null!==(i=null===(t=l.daoContractInfo)||void 0===t?void 0:t.votePrice)&&void 0!==i?i:1n,u=k.Z.safeBigIntDivision(null!==(o=null===(n=l.userInfo)||void 0===n?void 0:n.effectiveEthDone)&&void 0!==o?o:0n,c)*c,m=k.Z.createSafeBigNumber(L.Z.wei2eth(u)),f=k.Z.safeBigNumberOperation(()=>d.plus(m)),g=null!==(s=null===(r=l.daoContractInfo)||void 0===r?void 0:r.dailyRewardRate)&&void 0!==s?s:.02,v=k.Z.safeBigNumberOperation(()=>f.multipliedBy(g));return{manualVoting:d,automaticVoting:m,totalVoteAmount:f,votingAirdrop:v}}(),p=[{title:l("ManualVoting"),value:(0,r.jsx)(j.eO,{value:v.manualVoting.toNumber(),keepDecimal:3,children:f.nativeCurrency.symbol})},{title:l("AutomaticVoting"),value:(0,r.jsx)(j.eO,{value:v.automaticVoting.toNumber(),keepDecimal:3,children:f.nativeCurrency.symbol})},{title:l("VotingAirdrop"),value:(0,r.jsx)(j.eO,{value:v.votingAirdrop.toNumber(),keepDecimal:3,children:f.nativeCurrency.symbol})},{title:"",value:(0,r.jsx)("div",{})}],N=[{title:l("VotingNode"),value:null!==(o=null===(t=m.nodeMap.get(null!==(i=null===(n=c.nodeCurrentRoundInfo)||void 0===n?void 0:n.userInfo.nodeType)&&void 0!==i?i:d.r.NodeType.CANDIDATE))||void 0===t?void 0:t.title)&&void 0!==o?o:""},{title:l("NodeAddress"),value:(0,r.jsx)(M.Z,{address:null!==(s=null===(a=c.nodeCurrentRoundInfo)||void 0===a?void 0:a.nodeAddress)&&void 0!==s?s:"",text:_.Z.toShort(e.nodeAddress)})},{title:l("TotalVotes"),value:(0,r.jsx)(j.eO,{value:10*g.totalVoteAmount.toNumber()})},{title:l("CreationTime"),value:w.Z.dateFormat(new Date(c.nodeDetail.creationTime),"yyyy-MM-dd HH:mm:ss")}];return(0,r.jsx)("div",{className:"py-[30px] bg-gradient-to-r from-primary to-highlight rounded-lg",children:(0,r.jsx)("div",{className:"flex flex-col justify-center gap-[10px]",children:[p,N].flat().map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-col gap-[10px] text-[14px] font-semibold",children:[(0,r.jsxs)("div",{className:"flex justify-between mx-[20px] min-h-[21px]",children:[(0,r.jsxs)("span",{children:[e.title,e.title?":":""]}),(0,r.jsx)("span",{className:"",children:e.value})]}),[p,N].flat().length-1!==t?(0,r.jsx)("div",{className:"w-full h-[1px] bg-[#111]"}):null]},e.title))})})}var U=n(61247),J=n(32223),H=n(24521),W=n(97644),G=n(11340),Q=n(41525);function $(e){let{t}=(0,u.$G)(["dao","common"]),n=h.Q.getTargetNet(),a={justNow:t("common:JustNow"),minutesAgo:t("common:MinutesAgo",{minutes:"{0}"}),hoursAgo:t("common:HoursAgo",{hours:"{0}"}),daysAgo:t("common:DaysAgo",{days:"{0}"}),monthsAgo:t("common:MonthsAgo",{months:"{0}"}),yearsAgo:t("common:YearsAgo",{years:"{0}"}),yesterday:t("common:Yesterday"),today:t("common:Today")},i=[{title:t("common:TX"),dataIndex:"transaction",key:"transaction",width:250,align:"left",render:(e,t)=>(0,r.jsx)(g.Z,{horizontalArrangement:G.cV.Start,children:(0,r.jsx)(Q.Z,{chainId:n.chainId,hash:t.txHash,text:_.Z.toShort(t.txHash)})})},{title:t("dao:VoteTime"),dataIndex:"voteTime",key:"voteTime",width:250,render:(e,t)=>{let n=w.Z.latestDate(new Date(t.voteTime),a);return(0,r.jsx)(g.Z,{horizontalArrangement:G.cV.Center,verticalAlignment:G.v2.Center,className:"date whitespace-nowrap",children:n})}},{title:t("dao:VoteNumber"),dataIndex:"voteNumber",key:"voteNumber",width:250,render:(e,t)=>(0,r.jsx)(g.Z,{horizontalArrangement:G.cV.Center,verticalAlignment:G.v2.Center,className:"amount-contain",children:(0,r.jsx)(j.eO,{value:t.voteNumber})})},{title:t("dao:VoteAmount"),dataIndex:"voteAmount",key:"voteAmount",width:250,align:"right",render:(e,t)=>(0,r.jsx)(g.Z,{horizontalArrangement:G.cV.End,verticalAlignment:G.v2.Center,className:"amount-contain gap-2",children:(0,r.jsx)(j.eO,{value:Number(t.voteAmount),useSub:!0,className:"items-center",children:(0,r.jsx)(f.Z,{className:"w-[20px] h-[20px]"})})})}];return(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(W.ZP,{pageInfo:{page:e.tableData.pageIndex,totalPage:e.tableData.total},onPaginationChange:t=>{let{page:n}=t;return 0===n?{promise:Promise.resolve(),cancel:()=>{}}:e.getNextListData({page:n})},children:(0,r.jsx)("div",{className:"voting-record-table-contain overflow-x-auto",children:(0,r.jsx)(H.ZP,{rowKey:e=>e.txHash,emptyText:"",className:"voting-record-table text-center min-w-[760px]",columns:i,data:e.tableData.data})})})})}var Y=n(63671);function X(e){let{t}=(0,u.$G)(["dao"]),[n,a]=c.useState((0,Y.ki)({pageSize:10})),i=c.useRef(n);function o(n){var r;function o(e){s.abort(e)}let s=new AbortController,l=i.current;if(!n.restart&&l.isLoading)return{promise:Promise.resolve(),cancel:o};let d=n.restart?1:null!==(r=n.page)&&void 0!==r?r:l.pageIndex+1;return a({...l,isLoading:!0}),{promise:new I.Z().getVotingRecords({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,page:d,pageSize:l.pageSize,signal:s.signal}).then(e=>{var t,n;if(e.hasError())throw Error(e.getError().msg);let r=(null!==(t=e.getData())&&void 0!==t?t:[]).map(e=>e.toJSON()),i=null!==(n=e.getTotalPage())&&void 0!==n?n:l.total,o=0===e.getTotalPage()||0===r.length||r.length<l.pageSize;a({...l,pageIndex:d,isLoading:!1,total:i,isEnd:o,data:r})}).catch(e=>{y.Z.D("getTokens err",e),b.Z.canBeIgnore(e)||(0,A.L6)(new A.HU(e,t("Error in get voting record list")).asToastMessage())}),cancel:o}}return c.useEffect(()=>{i.current=n},[n]),c.useEffect(()=>{if(!e.nodeAddress||!e.daoAddress||i.current.isLoading)return;let t=w.Z.sleepForAnimationFrame(500);return t.promise.then(()=>(function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];a({...n,data:[],pageIndex:1,isEnd:!1,isLoading:!1}),e&&c.startTransition(async()=>{await o({restart:!0}).promise})})()),()=>{t.cancel(b.Z.ReactError.useEffectDestroy())}},[e.nodeAddress,e.daoAddress]),(0,r.jsx)($,{tableData:n,getNextListData:o})}var K=n(78733),ee=n(41849);function et(e){let t=(0,x.C)(e=>e.global),{t:n}=(0,u.$G)(["common","dao"]),[a,i]=c.useState((0,Y.ki)({pageSize:10})),o=c.useRef(a);function s(t){var r;function a(e){s.abort(e)}let s=new AbortController,l=o.current;if(!t.restart&&l.isLoading)return{promise:Promise.resolve(),cancel:a};let d=t.restart?1:null!==(r=t.page)&&void 0!==r?r:l.pageIndex+1;return i({...l,isLoading:!0}),{promise:new I.Z().getMyVotingRecords({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,page:d,pageSize:l.pageSize,signal:s.signal}).then(e=>{var t,n;if(e.hasError())throw Error(e.getError().msg);let r=(null!==(t=e.getData())&&void 0!==t?t:[]).map(e=>e.toJSON()),a=null!==(n=e.getTotalPage())&&void 0!==n?n:l.total,o=0===e.getTotalPage()||0===r.length||r.length<l.pageSize;i({...l,pageIndex:d,isLoading:!1,total:a,isEnd:o,data:r})}).catch(e=>{y.Z.D("getTokens err",e),b.Z.canBeIgnore(e)||(0,A.L6)(new A.HU(e,n("Error in get voting record list")).asToastMessage())}),cancel:a}}function l(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i({...a,data:[],pageIndex:1,isEnd:!1,isLoading:!1}),e&&c.startTransition(async()=>{await s({restart:!0}).promise})}return c.useEffect(()=>{o.current=a},[a]),c.useEffect(()=>{if(!e.nodeAddress||!e.daoAddress||o.current.isLoading)return;if(!t.token){l(!1);return}let n=w.Z.sleepForAnimationFrame(500);return n.promise.then(()=>l()),()=>{n.cancel(b.Z.ReactError.useEffectDestroy())}},[e.nodeAddress,e.daoAddress,t.token]),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)($,{tableData:a,getNextListData:s}),t.token?0===a.data.length?(0,r.jsx)(ee.Z,{}):null:(0,r.jsx)(K.Z,{})]})}function en(e){let{t:t}=(0,U.Z)(["dao"]),[n,a]=c.useState("all"),i={title:t("dao:AllRecords"),url:"all"},o={title:t("dao:MyVotingRecords"),url:"my"},s=[i,o];return(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(J.Z,{className:"items-start",displayType:J.L.BorderGradient,tabList:s,activeIndex:s.findIndex(e=>e.url===n),onClick:e=>a(e)}),(0,r.jsxs)("div",{className:"bg-[#050505] border border-[#666666] rounded-lg p-4 mt-4",children:[n===i.url?(0,r.jsx)(X,{nodeAddress:e.nodeAddress,daoAddress:e.daoAddress}):null,n===o.url?(0,r.jsx)(et,{nodeAddress:e.nodeAddress,daoAddress:e.daoAddress}):null]})]})}function er(e){let[t,n]=c.useState(""),[a,i]=c.useState("");return R({nodeAddress:t,daoAddress:a,autoTrigger:!0}),c.useEffect(()=>{let e=new URLSearchParams(location.search),t=e.get(E.Z.Params.NODE_ADDRESS),r=e.get(E.Z.Params.DAO_ADDRESS);t&&r&&(n(t),i(r))},[]),(0,r.jsxs)("div",{className:(0,m.m6)("flex flex-col gap-[20px]",e.className),children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-[20px] mt-[20px] items-stretch",children:[(0,r.jsx)(q,{nodeAddress:t}),(0,r.jsx)(O,{})]}),(0,r.jsx)(en,{nodeAddress:t,daoAddress:a})]})}function ea(){return(0,r.jsx)("div",{className:"relative overflow-x-hidden text-secondary bg-[#000000]",children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)(s.Z,{}),(0,r.jsx)(a.Z,{}),(0,r.jsxs)(i.ZP,{width:i.W7.Wrapper,background:i.nV.None,className:"mx-[20px] 2xl:mx-auto",children:[(0,r.jsx)(l.Z,{activeTarget:d.r.VotingTabEnum.NONE}),(0,r.jsx)(er,{className:"max-w-[var(--detail-content-width)] mx-[20px] md:mx-auto"})]}),(0,r.jsx)(o.Z,{})]})})}},59365:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(57437);function a(e){var t,n;return(0,r.jsx)("img",{src:"/images/icon-eth.svg",width:null!==(t=e.width)&&void 0!==t?t:20,height:null!==(n=e.height)&&void 0!==n?n:20,alt:"ETH",className:e.className})}},34826:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(68651),a=n(10433);class i{static createSafeBigNumber(e){try{let t=new r.Z(e);return t.isNaN()||!t.isFinite()?new r.Z(0):t}catch(t){return a.Z.W("Error creating BigNumber:",e,t),new r.Z(0)}}static safeToNumber(e){try{if(!e||e.isNaN()||!e.isFinite())return 0;let t=e.toNumber();return"number"==typeof t&&!isNaN(t)&&isFinite(t)?t:0}catch(t){return a.Z.W("Error converting BigNumber to number:",e,t),0}}static safeParseNumber(e){try{if("number"==typeof e)return!isNaN(e)&&isFinite(e)?e:0;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&isFinite(t)?t:0}if(e&&"function"==typeof e.toNumber)return i.safeToNumber(e);return 0}catch(t){return a.Z.W("Error parsing number:",e,t),0}}static safeBigIntDivision(e,t){try{if(0n===t)return a.Z.W("Division by zero attempted, returning 0"),0n;return e/t}catch(n){return a.Z.W("Error in BigInt division:",e,t,n),0n}}static safeBigNumberOperation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.Z(0);try{let n=e();return n.isNaN()||!n.isFinite()?t:n}catch(e){return a.Z.W("Error in BigNumber operation:",e),t}}}},48423:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(57437);n(2265),n(53953);var a=n(22448),i=n(10867),o=n(3682),s=n(53335);function l(e){let{chainId:t,address:n,text:l,children:d,className:c,...u}=e,m=(0,r.jsx)(a.Z,{children:n}),f=new o.Q(t).getAddressUrl(n);return(0,r.jsx)(i.Z,{placement:"top",speaker:m,trigger:"hover",children:(0,r.jsx)("a",{className:(0,s.m6)("component-chain-address-link pointer hover underline",c),href:f,target:"_blank",...u,children:null!=l?l:n})})}},41525:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(57437);n(2265),n(34159);var a=n(22448),i=n(10867),o=n(3682);function s(e){let{chainId:t,hash:n,text:s,children:l,className:d,...c}=e,u=(0,r.jsx)(a.Z,{children:n}),m=new o.Q(t).getTXUrl(n);return(0,r.jsx)(i.Z,{placement:"top",speaker:u,trigger:"hover",children:(0,r.jsx)("a",{className:"component-chain-hash-link pointer hover underline ".concat(null!=d?d:""),href:m,target:"_blank",...c,children:null!=s?s:n})})}},97644:function(e,t,n){"use strict";n.d(t,{ZP:function(){return g}});var r=n(57437),a=n(2265),i=n(63671),o=n(10433),s=n(74439),l=n(72525),d=n(72790),c=n(11340),u=n(52926),m=n(20605);n(83123),n(66917),n(41849),n(43949);var f=n(53335);function g(e){var t,n;let g=null!==(t=e.needRelocationAfterUpdate)&&void 0!==t&&t,v=null!==(n=e.offsetY)&&void 0!==n?n:-70,h=a.useRef(null),[p,x]=a.useState((0,i.ki)(e.pageInfo)),[N,Z]=a.useTransition(),w=e.pageInfo.page||1,j=e.pageInfo.totalPage||0,C=a.useRef({isLoading:e.isLoading,emptyText:e.emptyText,loadingText:e.loadingText,onPaginationChange:e.onPaginationChange});function T(t){o.Z.L("changePagination called with page:",t);let n=e=>{};return C.current.isLoading||p.isLoading?o.Z.L("Loading, cannot change page"):(x({...p,isLoading:!0,isError:!1}),Z(async()=>{o.Z.L("Starting page change transition to page:",t);try{let r=C.current.onPaginationChange({page:t});if(n=r.cancel,await r.promise.catch(e=>{if(m.Z.canBeIgnore(e))return Promise.resolve();o.Z.E(JSON.stringify(e)),x({...p,isLoading:!1,isError:!0})}),o.Z.L("Page change completed successfully"),x({...p,isLoading:!1,isError:!1}),!(null==h?void 0:h.current)||0===e.pageInfo.page||!g)return;s.Z.sleepForAnimationFrame(16).promise.then(()=>{if(!h.current)return;let e=s.Z.getOffsetTop(h.current)+v;o.Z.I("scroll to y: ",e),s.Z.scrollTo({y:e})})}catch(e){o.Z.E("Error in page change:",e)}})),n}a.useEffect(()=>{C.current={isLoading:e.isLoading,emptyText:e.emptyText,loadingText:e.loadingText,onPaginationChange:e.onPaginationChange}},[e.isLoading,e.emptyText,e.loadingText,e.onPaginationChange]),a.useEffect(()=>{let t=s.Z.sleepForAnimationFrame();return t.promise.then(()=>{var t;T(null!==(t=e.pageInfo.page)&&void 0!==t?t:1)}),()=>t.cancel("useEffect callback")},[]);let A=a.useMemo(()=>{if(j<=5)return Array.from({length:j},(e,t)=>t+1);let e=1;return e=w<=3?1:w>=j-2?j-4:w-2,Array.from({length:5},(t,n)=>e+n)},[w,j]),{showLeftEllipsis:b,showRightEllipsis:y}=a.useMemo(()=>({showLeftEllipsis:j>5&&w>3,showRightEllipsis:j>5&&w<j-2}),[w,j]),I=e=>{o.Z.L("Clicked on page ".concat(e,", current page is ").concat(w)),T(e)};return(0,r.jsxs)(l.Z,{className:(0,f.m6)("paginate-table-container",e.className),children:[(0,r.jsxs)(l.Z,{className:"paginate-wrapper w-full",children:[(0,r.jsx)("div",{className:"paginate-content w-full",ref:h,children:e.children}),(0,r.jsx)("div",{className:"h-[40px] flex justify-center items-center",children:(0,r.jsxs)(d.Z,{horizontalArrangement:c.cV.Center,verticalAlignment:c.v2.Center,className:"status-contain",children:[N||C.current.isLoading||p.isLoading?(0,r.jsx)(u.Z,{children:C.current.loadingText}):"",C.current.isLoading||p.isLoading||0!==j||!C.current.emptyText?"":(0,r.jsx)("div",{className:"paginate-table-placeholder",children:C.current.emptyText})]})})]}),j>0&&(0,r.jsx)("div",{className:"paginate-contain",children:(0,r.jsx)("div",{className:"pagination-custom",children:(0,r.jsxs)("ul",{className:"flex items-center",children:[(0,r.jsx)("li",{className:"previous ".concat(w<=1?"disabled":""),children:(0,r.jsx)("a",{onClick:()=>T(Math.max(1,w-1)),children:"<"})}),j<=5?(0,r.jsx)(r.Fragment,{children:Array.from({length:j},(e,t)=>{let n=t+1;return(0,r.jsx)("li",{className:n===w?"selected":"",children:(0,r.jsx)("a",{onClick:()=>I(n),children:n})},n)})}):A.map(e=>(0,r.jsx)("li",{className:e===w?"selected":"",children:(0,r.jsx)("a",{onClick:()=>I(e),children:e})},e)),(0,r.jsx)("li",{className:"pagination-break ".concat(y&&j>5?"":"opacity-0"),children:(0,r.jsx)("a",{className:"pagination-break-link",children:"..."})}),(0,r.jsx)("li",{className:"next ".concat(w>=j?"disabled":""),children:(0,r.jsx)("a",{onClick:()=>T(Math.min(j,w+1)),children:">"})})]})})})]})}},69367:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r,a=n(57437),i=n(10867),o=n(22448),s=n(94746);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var d=function(e){return s.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},e),r||(r=s.createElement("path",{fill:"#fff",fillOpacity:.8,d:"M6.992 0q1.455 0 2.73.555t2.229 1.502a7 7 0 0 1 1.502 2.221Q14 5.553 14 7.008t-.547 2.722a7.056 7.056 0 0 1-3.73 3.723Q8.445 14 6.992 14q-1.455 0-2.723-.547a7.1 7.1 0 0 1-2.22-1.502A7.1 7.1 0 0 1 .546 9.73 6.8 6.8 0 0 1 0 7.008q0-1.455.547-2.73.548-1.275 1.502-2.221A7.3 7.3 0 0 1 4.27.555 6.7 6.7 0 0 1 6.992 0m.016 11.794a.92.92 0 0 0 .68-.273.9.9 0 0 0 .274-.665.92.92 0 0 0-.274-.68.92.92 0 0 0-.68-.274.92.92 0 0 0-.68.273.92.92 0 0 0-.274.68q0 .392.273.666.275.273.68.273m.798-3.848q-.016-.25.312-.531.329-.282.736-.626t.75-.774.376-.994q.03-.61-.125-1.142a2.24 2.24 0 0 0-.516-.915 2.5 2.5 0 0 0-.931-.61q-.57-.227-1.338-.227-.954 0-1.587.337a3.3 3.3 0 0 0-1.025.813q-.39.477-.547.986-.158.508-.141.852.015.407.258.595a.88.88 0 0 0 .524.195.84.84 0 0 0 .516-.156.55.55 0 0 0 .235-.477q0-.189.117-.462t.32-.524q.204-.25.494-.422.289-.172.649-.172.703 0 1.126.352.422.351.391.883a.85.85 0 0 1-.156.493 2.4 2.4 0 0 1-.4.438q-.242.211-.516.422-.273.211-.516.438a2.4 2.4 0 0 0-.406.493q-.165.266-.18.579l.015.594q0 .235.22.446.218.212.578.227.36-.015.571-.235a.65.65 0 0 0 .196-.5z"})))},c=n(53335),u=n(2265);let m=(0,u.forwardRef)((e,t)=>{let{children:n,className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.m6)("inline-flex items-center justify-center",r),...i,children:n})});function f(e){let t=u.useRef(null);return(0,a.jsx)("div",{ref:t,className:(0,c.m6)("relative",e.className),children:(0,a.jsx)(i.Z,{placement:"auto",className:(0,c.m6)("",e.containClassName),container:()=>{var n,r;return null!==(r=null!==(n=e.targetContain)&&void 0!==n?n:t.current)&&void 0!==r?r:"undefined"!=typeof document?document.body:null},speaker:(0,a.jsx)(o.Z,{className:(0,c.m6)("-mt-[25px]",e.tooltipClassName),style:{maxWidth:"1000px"},children:e.children}),trigger:"hover",enterable:!0,rootClose:!0,...e.whisperProps,children:(0,a.jsx)(m,{className:(0,c.m6)("w-[14px] h-[14px] cursor-pointer",e.iconClassName),children:(0,a.jsx)(d,{className:"w-full h-full"})})})})}m.displayName="SvgWrapper"},78733:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r,a,i,o,s=n(57437),l=n(94746);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var c=function(e){return l.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 45 36"},e),r||(r=l.createElement("path",{fill:"#666",d:"M26.663 11.193h13.12l-1.75-3.896c-.477-1.113-1.829-1.59-2.942-1.113l-8.666 3.976c-.477.238-.318 1.033.238 1.033m17.651 3.737c0-1.192-1.033-2.226-2.226-2.226H13.226c-1.192 0-2.226 1.034-2.226 2.226v18.844C11 34.966 12.034 36 13.226 36h28.862c1.193 0 2.226-1.034 2.226-2.226v-6.122h-8.746a3.36 3.36 0 0 1-3.34-3.34 3.36 3.36 0 0 1 3.34-3.34h8.746z"})),a||(a=l.createElement("path",{fill:"#666",d:"M34.456 24.392a1.113 1.113 0 1 0 2.225 0 1.113 1.113 0 0 0-2.225 0"})),i||(i=l.createElement("path",{fill:"url(#icon-file-warning_svg__a)",d:"M9.6 0C4.299 0 0 4.475 0 10s4.299 10 9.6 10 9.6-4.475 9.6-10S14.901 0 9.6 0m0 15.612c-.56 0-1.011-.474-1.011-1.054 0-.583.452-1.056 1.011-1.056.56 0 1.011.473 1.011 1.056 0 .58-.452 1.054-1.011 1.054m1.71-10.1-.86 5.564c-.115.723-.496 1.315-.85 1.315s-.735-.592-.85-1.315L7.89 5.51C7.774 4.788 8.256 4 8.96 4h1.279c.705 0 1.187.786 1.071 1.511"})),o||(o=l.createElement("defs",null,l.createElement("linearGradient",{id:"icon-file-warning_svg__a",x1:0,x2:19.2,y1:10,y2:10,gradientUnits:"userSpaceOnUse"},l.createElement("stop",{stopColor:"#E700E6"}),l.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))},u=n(43949),m=n(53335);function f(e){let{t}=(0,u.$G)(["common"]);return(0,s.jsxs)("div",{className:(0,m.m6)("flex flex-col justify-center items-center gap-[18px] p-[65px]",e.className),children:[(0,s.jsx)(c,{className:"w-[44px] h-[38px]"}),(0,s.jsx)("div",{className:"text-white",children:t("NoConnectWalletTip")})]})}},41849:function(e,t,n){"use strict";var r=n(57437),a=n(2265),i=n(53335);t.Z=a.forwardRef(function(e,t){var n,a;return(0,r.jsxs)("p",{ref:t,className:(0,i.m6)("my-5 text-tip flex justify-center items-center gap-2 component-text-tip",null!==(n=e.className)&&void 0!==n?n:""),children:[null!==(a=e.text)&&void 0!==a?a:"There‘s nothing more left",e.children]})})},75370:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r,a,i,o,s=n(12249),l=n(5853),d=n(74439),c=n(43009),u=n(8113),m=n(6178),f=n(2265);function g(){let e=(0,m.C)(e=>e.global),t=(0,m.C)(e=>e.dao);return f.useMemo(()=>{var n,r,a,i;return new h().initialize({roundEndTime:null!==(a=null===(n=t.daoCurrentRoundInfo)||void 0===n?void 0:n.roundExpire)&&void 0!==a?a:-1,timeCanReward:null!==(i=null===(r=t.daoContractInfo)||void 0===r?void 0:r.loserPoolRewardTimeLimit)&&void 0!==i?i:0,currentTime:e.currentTime})},[t.daoCurrentRoundInfo,t.daoContractInfo,e.currentTime])}(r=i||(i={}))[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.ROUND_READY=1]="ROUND_READY",r[r.ROUND_START=2]="ROUND_START",r[r.ROUND_END=3]="ROUND_END",(a=o||(o={}))[a.UNINITIALIZED=0]="UNINITIALIZED",a[a.CLAIM_START=1]="CLAIM_START",a[a.CLAIM_END=2]="CLAIM_END";class v{static defaultInfo(){return{toFormated:()=>"--:--:--"}}}class h extends u.Vw.BaseDataAdapter{initialize(e){return super.initialize(e),this}get roundStatus(){let e=this.roundEndTime.toJSTime(),t=this.currentTime;return -1===e?0:0===e?1:e>t?2:3}get isRoundStart(){return 0!==this.roundStatus&&1!==this.roundStatus}get isRoundEnd(){return 3===this.roundStatus}getRoundEndCountdown(){return d.Z.convertTimeDifference(new Date(this.roundEndTime.toJSTime()-this.currentTime))}get roundClaimStartTime(){return this.roundEndTime.toJSTime()}getRoundClaimStartCountdown(){let e=d.Z.convertTimeDifference(new Date(this.roundClaimStartTime-this.currentTime),{includeDays:!1});return 0===e?v.defaultInfo():e}get roundClaimEndTime(){return -1===this.roundEndTime.toJSTime()?-1:this.roundEndTime.toJSTime()+this.timeCanReward.toJSTime()}get claimStatus(){return 0===this.timeCanReward.toJSTime()?0:this.roundClaimEndTime<=this.currentTime?2:this.roundClaimStartTime<=this.currentTime?1:0}get isRoundClaimStart(){return 1===this.claimStatus}getRoundClaimEndCountdown(){let e=d.Z.convertTimeDifference(new Date(this.roundClaimEndTime-this.currentTime),{includeDays:!1});return 0===e?v.defaultInfo():e}get isRoundClaimEnd(){return 2===this.claimStatus}getFundCountdownInfo(){return this.isRoundClaimEnd||!this.isRoundStart?v.defaultInfo():this.isRoundClaimStart?this.isRoundClaimEnd?v.defaultInfo():this.getRoundClaimEndCountdown():this.getRoundClaimStartCountdown()}getClaimCountdownInfo(){return this.getFundCountdownInfo()}constructor(...e){super(...e),(0,s._)(this,"roundEndTime",c.Z.Time.from(-1)),(0,s._)(this,"timeCanReward",c.Z.Time.from(0)),(0,s._)(this,"currentTime",void 0)}}(0,l.gn)([u.Vw.To(c.Z.Time.fromJSTimestamp.bind(c.Z.Time)),(0,l.w6)("design:type",void 0===c.Z||void 0===c.Z.Time?Object:c.Z.Time)],h.prototype,"roundEndTime",void 0),(0,l.gn)([u.Vw.To(c.Z.Time.fromJSTimestamp.bind(c.Z.Time))],h.prototype,"timeCanReward",void 0),(0,l.gn)([u.Vw.To(),(0,l.w6)("design:type",Number)],h.prototype,"currentTime",void 0)},53953:function(){},34159:function(){}},function(e){e.O(0,[1283,5073,2506,9409,927,9481,2784,6870,977,4758,7181,6764,8575,5138,3448,1707,9738,1811,7072,4521,923,344,6011,9302,2580,1240,6755,2971,2117,1744],function(){return e(e.s=76634)}),_N_E=e.O()}]);