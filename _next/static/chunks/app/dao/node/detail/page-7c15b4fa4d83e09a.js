(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6827],{37688:function(e,t,n){Promise.resolve().then(n.bind(n,6630))},6630:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return en}});var o=n(57437),r=n(97235),a=n(68071),i=n(27635),l=n(38435),s=n(12628),d=n(89769),u=n(2265),c=n(43949);n(99376);var m=n(53335),v=n(59365),f=n(72790),g=n(65435),p=n(71549),x=n(68651),h=n(6178),N=n(43009);function C(e){let{mintPrice:t,amount:n,setAmount:r,maxAmount:a}=e,i=(0,h.C)(e=>e.token);p.Q.getTargetNet();let l=new x.Z(t.toString()),s=e=>{e>=1&&e<=a&&r(e)};return(0,o.jsxs)("div",{className:"flex flex-col items-stretch gap-[10px]",children:[(0,o.jsxs)("div",{className:"w-full xl:w-auto flex flex-row justify-between gap-2 items-center flex-wrap border border-[#666] p-[20px] rounded-lg",children:[(0,o.jsxs)(f.Z,{className:"items-center gap-2",children:[(0,o.jsx)(v.Z,{className:"w-6 h-6"}),(0,o.jsx)("span",{className:"text-lg font-semibold",children:N.Z.toFixed(l.multipliedBy(n).toNumber(),i.decimals)})]}),(0,o.jsxs)("div",{className:"w-auto flex flex-col md:flex-row item-stretch md:items-center gap-3",children:[(0,o.jsx)("span",{className:"hidden md:block w-[1px] h-[45px] bg-[#111]"}),(0,o.jsxs)("div",{className:"order-1 md:order-2 flex gap-2 item-stretch md:items-center",children:[(0,o.jsx)("button",{className:"w-[43px] text-center px-2 py-1 border border-[#666666] rounded",onClick:()=>s(Math.max(1,n-1)),children:"-"}),(0,o.jsx)("input",{type:"number",className:"w-[65px] text-center px-4 py-1 border border-[#666666] rounded bg-transparent",value:n,onChange:e=>s(Number(e.target.value))}),(0,o.jsx)("button",{className:"w-[43px] text-center px-2 py-1 border border-[#666666] rounded",onClick:()=>s(n+1),children:"+"})]})]})]}),(0,o.jsx)("div",{className:"flex justify-between gap-[13px] flex-wrap",children:[3,10,30,100].map(e=>(0,o.jsx)("div",{className:"flex-1",children:(0,o.jsx)(g.ZP,{className:(0,m.m6)("w-full h-[33px] leading-[33px] border border-[#666] text-[#999]",e===n?"border-primary text-primary":""),size:g.qE.Customize,status:g.Dv.None,onClick:()=>s(e),children:e})},e))})]})}var w=n(74439),A=n(54740),T=n(56679),I=n(29698),j=n(83123),b=n(20605),Z=n(10433),y=n(22928),E=n(95665),D=n(72917),S=n(49481);function R(e){let t=(0,h.T)(),n=(0,h.C)(e=>e.dao),o=(0,h.C)(e=>e.user),r=(0,D.Z)(e.daoAddress||void 0,{autoTrigger:e.autoTrigger,autoUpdateTokenInfo:!0}),a=(0,S.Z)(o.ethInfo.walletAddress);async function i(t){let n=new y.Z,o=await n.getNodeDetail({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,signal:null==t?void 0:t.signal});if(o.hasError()){let e=o.getError();return(0,j.L6)(e.msg),Z.Z.E(e),Promise.reject(e)}return o.getData()}function l(){t(E.Z.slice.actions.clearNodeDetail())}async function s(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.nodeAddress)return l();let o=await i(n);t(E.Z.slice.actions.updateNodeDetail(o))}return u.useEffect(()=>{if(!(null==e?void 0:e.autoTrigger)||!e.daoAddress||!e.nodeAddress||e.nodeAddress===n.nodeDetail.nodeAddress)return;let t=new AbortController;return s({signal:t.signal}),()=>{t.abort(b.Z.ReactError.useEffectDestroy()),l()}},[e.daoAddress,e.nodeAddress]),u.useEffect(()=>{var t,o,a;if(!(null==e?void 0:e.autoTrigger)||!e.daoAddress||!e.nodeAddress||e.daoAddress!==(null===(t=n.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)||(null===(o=n.daoContractInfo)||void 0===o?void 0:o.daoAddress)!==(null===(a=n.nodeListFilters.selectedDao)||void 0===a?void 0:a.address)||e.nodeAddress!==n.nodeDetail.nodeAddress)return;let i=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return i.wait(()=>r.updateNodeCurrentRoundInfo(e.nodeAddress)),()=>{i.cancel(b.Z.ReactError.useEffectDestroy())}},[e.daoAddress,e.nodeAddress,n.nodeDetail,n.daoContractInfo,n.nodeListFilters.selectedDao]),u.useEffect(()=>{var t;if(!e.autoTrigger||!(null===(t=n.daoContractInfo)||void 0===t?void 0:t.tokenAddress)||!o.ethInfo.walletAddress)return;let r=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return r.wait(a.updateETHBalance),()=>{r.cancel(b.Z.ReactError.useEffectDestroy())}},[n.daoContractInfo,o.ethInfo.walletAddress]),{getData:i,updateData:s,clearData:l}}var L=n(81939);function k(e){var t,n,o,r,a,i;let l=(0,h.C)(e=>e.dao);e=null!=e?e:l.nodeCurrentRoundInfo;let s=new x.Z(L.Z.wei2eth(null!==(o=null==e?void 0:e.promotionInfo.totalSonVotedAmount)&&void 0!==o?o:0n)),d=null!==(r=null===(t=l.daoContractInfo)||void 0===t?void 0:t.votePrice)&&void 0!==r?r:1n,u=new x.Z(L.Z.wei2eth((null!==(a=null==e?void 0:e.promotionInfo.totalSonEthDone)&&void 0!==a?a:0n)/d*d)),c=s.plus(u),m=c.multipliedBy(null!==(i=null===(n=l.daoContractInfo)||void 0===n?void 0:n.dailyRewardRate)&&void 0!==i?i:.02);return{manualVoting:s,automaticVoting:u,totalVoteAmount:c,votingAirdrop:m}}var V=n(56196),P=n(75370);function O(){var e,t,n,r,a,i,l,s,d,v;(0,h.T)();let f=(0,h.C)(e=>e.global),A=(0,h.C)(e=>e.user),T=(0,h.C)(e=>e.dao),{t:j}=(0,c.$G)(["dao"]),b=(0,D.Z)(),Z=(0,P.Z)(),y=L.Z.wei2eth(null!==(i=null===(e=T.daoContractInfo)||void 0===e?void 0:e.votePrice)&&void 0!==i?i:1n),[E,S]=u.useState(1),R=new x.Z(A.ethInfo.walletBalance),k=new x.Z("10").dividedToIntegerBy(y),V=x.Z.min(R.dividedToIntegerBy(y),k),O=p.Q.getTargetNet(),M=0===f.currentTime?0:w.Z.convertTimeDifference(new Date((null!==(l=null===(t=T.userInfo)||void 0===t?void 0:t.voteInfo.votedDatePre)&&void 0!==l?l:0)+(null!==(s=null===(n=T.daoContractInfo)||void 0===n?void 0:n.roundDurationAdd)&&void 0!==s?s:N.Z.Hours.from(24).toJSTime())-f.currentTime)),_="w-full font-semibold",[B,q]=u.useState(!1),z=null!==(d=null===(r=A.tokenBalances.find(e=>e.address===T.tokenInfo.address))||void 0===r?void 0:r.balance)&&void 0!==d?d:"0",U=u.useRef(null);return u.useEffect(()=>{var e;if(!A.ethInfo.walletAddress||!(null===(e=T.nodeListFilters.selectedDao)||void 0===e?void 0:e.address))return;let t=w.Z.sleepForAnimationFrame(N.Z.Milliseconds.from(16));return t.promise.then(()=>{var e;(null===(e=T.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)&&A.ethInfo.walletAddress&&b.updateCancelInfo(T.nodeListFilters.selectedDao.address,A.ethInfo.walletAddress)}),()=>{t.cancel()}},[T.nodeListFilters.selectedDao,A.ethInfo.walletAddress]),(0,o.jsxs)("div",{className:"p-6 bg-[#050505] border border-[#666666] rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl mb-4 font-medium text-center",children:j("dao:VoteTitle")}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)(C,{mintPrice:y,amount:E,setAmount:S,maxAmount:V.toNumber()}),(0,o.jsxs)("div",{className:"flex items-center gap-1 relative text-[14px]",ref:U,children:[(0,o.jsxs)("span",{children:[j("Balance"),":"]}),N.Z.toFixed(Number(A.ethInfo.walletBalance),4),(0,o.jsx)("span",{children:O.nativeCurrency.symbol}),(0,o.jsx)(I.Z,{targetContain:U.current,tooltipClassName:"-mt-[39px]",children:(0,o.jsx)("span",{className:"text-[12px] font-medium text-white",children:j("VoteTip",{price:y,unitAmount:1,maxAmount:k.toString(),timeAmount:1,resetTime:N.Z.Time.fromJSTimestamp(null!==(v=null===(a=T.daoContractInfo)||void 0===a?void 0:a.roundDurationAdd)&&void 0!==v?v:0n).toHours()})})})]}),0!==M?(0,o.jsx)(g.ZP,{className:(0,m.m6)(_),status:g.Dv.NoImportant,children:(0,o.jsx)("span",{className:"text-gradient",children:M.toFormated()})}):(0,o.jsx)(g.ZP,{className:(0,m.m6)(_),size:g.qE.Normal,status:Z.isRoundEnd?g.Dv.Disabled:g.Dv.Active,waitForClick:!0,onClick:()=>b.voteForNode(E.toString()),children:j("VoteButton")}),(0,o.jsx)("div",{className:"flex flex-col justify-cemter items-end gap-2",children:(0,o.jsxs)(g.ZP,{className:(0,m.m6)(""),size:g.qE.Customize,status:g.Dv.None,waitForClick:!0,onClick:()=>{q(!0)},children:[(0,o.jsx)("span",{className:(0,m.m6)("text-[14px] font-medium","text-gradient"),children:j("CancelVote")}),(0,o.jsx)("div",{className:"w-full h-[1px] bg-gradient-to-r from-primary to-highlight"})]})})]}),(0,o.jsx)(F,{isOpen:B,requestClose:()=>q(!1),tokenInfo:T.tokenInfo,tokenBalance:Number(z)})]})}function F(e){var t,n,r,i;(0,h.C)(e=>e.global);let l=(0,h.C)(e=>e.dao),{t:s}=(0,c.$G)(["dao"]),d=(0,V.I)(),m=(0,D.Z)(),f=R({daoAddress:null!==(r=null===(t=l.daoContractInfo)||void 0===t?void 0:t.daoAddress)&&void 0!==r?r:"",nodeAddress:l.nodeDetail.nodeAddress});k();let{cancelRate:g,leftCancelValue:p,cancellableDisplayValue:C}=function(){var e,t,n,o,r,a,i,l,s,d,u,c;let m=(0,h.C)(e=>e.global),v=(0,h.C)(e=>e.dao),f=null!==(i=null===(e=v.daoContractInfo)||void 0===e?void 0:e.cancelRate)&&void 0!==i?i:0,g=new x.Z(L.Z.wei2eth(null!==(l=null===(t=v.daoCurrentRoundInfo)||void 0===t?void 0:t.pool.airdropPool)&&void 0!==l?l:0n)).multipliedBy(f),p=(null!==(s=null===(n=v.userInfo)||void 0===n?void 0:n.voteInfo.roundFirstVotedDate)&&void 0!==s?s:0)+(null!==(d=null===(o=v.daoContractInfo)||void 0===o?void 0:o.cancelDurationTime)&&void 0!==d?d:0)<=m.currentTime,N=null===(u=null===(r=v.userInfo)||void 0===r?void 0:r.voteInfo.quited)||void 0===u||u;return{cancelRate:f,maxCancelValue:g,leftCancelValue:g.minus(L.Z.wei2eth(null!==(c=null===(a=v.daoCurrentRoundInfo)||void 0===a?void 0:a.quitAmount)&&void 0!==c?c:0n)),cancellableDisplayValue:N||p?v.userCancellableAmount:v.userMaxCancelAmount}}(),w=l.userCancellableAmount>0n;async function b(){await f.updateData()}async function Z(){var t;if(!(null===(t=l.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)){(0,j.L6)(s("NoSelectedDao"));return}if(await d.handleLogin()){if(!w){(0,j.L6)(s("NoCancelVote"));return}await m.cancelVote(),b(),e.requestClose()}}let y=u.useRef(null);return(0,o.jsx)(T.Z,{isOpen:e.isOpen,onRequestClose:e.requestClose,title:s("CancelVote"),size:"small",controls:{buttons:[{text:s("Back"),type:"normal",onClick:e.requestClose},...w?[{text:s("CancelVote"),type:"active",onClick:Z}]:[]]},children:(0,o.jsx)("div",{className:"flex flex-col items-stretch gap-[18px]",children:(0,o.jsx)("div",{className:"flex flex-col items-start gap-[20px]",children:(0,o.jsx)(a.ZP,{autoMargin:!1,autoPadding:!1,className:"w-full p-[10px_17px]",children:(0,o.jsx)("div",{className:"relative",ref:y,children:[{key:"totalVotes",title:(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[s("TotalCancelAmount"),(0,o.jsx)(I.Z,{targetContain:y.current,children:s("CancelVoteTip",{rate:1e3*g,time:N.Z.Time.fromJSTimestamp(null!==(i=null===(n=l.daoContractInfo)||void 0===n?void 0:n.cancelDurationTime)&&void 0!==i?i:0n).toHours()})})]}),value:(0,o.jsx)(A.eO,{value:p.toNumber(),children:(0,o.jsx)(v.Z,{})})},{key:"cancelScope",title:s("CancelScope"),value:(0,o.jsx)(A.eO,{value:Number(L.Z.wei2eth(C)),children:(0,o.jsx)(v.Z,{})})}].map(e=>(0,o.jsxs)("div",{className:"flex justify-between items-center leading-[178%]",children:[(0,o.jsx)("span",{children:e.title}),(0,o.jsx)("span",{children:e.value})]},e.key))})})})})})}var M=n(79787),_=n(48423),B=n(50544);function q(e){var t,n,r,a,i,l;let{t:s}=(0,c.$G)(["dao"]),u=(0,h.C)(e=>e.dao),m=(0,B.Z)(),v=p.Q.getTargetNet(),f=k(),g=function(){var e,t,n,o,r,a,i,l;let s=(0,h.C)(e=>e.dao),d=new x.Z(L.Z.wei2eth(null!==(r=null===(e=s.userInfo)||void 0===e?void 0:e.effectiveVote)&&void 0!==r?r:0n)),u=null!==(a=null===(t=s.daoContractInfo)||void 0===t?void 0:t.votePrice)&&void 0!==a?a:1n,c=(null!==(i=null===(n=s.userInfo)||void 0===n?void 0:n.effectiveEthDone)&&void 0!==i?i:0n)/u*u,m=new x.Z(L.Z.wei2eth(c)),v=d.plus(m),f=v.multipliedBy(null!==(l=null===(o=s.daoContractInfo)||void 0===o?void 0:o.dailyRewardRate)&&void 0!==l?l:.02);return{manualVoting:d,automaticVoting:m,totalVoteAmount:v,votingAirdrop:f}}(),N=[{title:s("ManualVoting"),value:(0,o.jsx)(A.eO,{value:g.manualVoting.toNumber(),keepDecimal:3,children:v.nativeCurrency.symbol})},{title:s("AutomaticVoting"),value:(0,o.jsx)(A.eO,{value:g.automaticVoting.toNumber(),keepDecimal:3,children:v.nativeCurrency.symbol})},{title:s("VotingAirdrop"),value:(0,o.jsx)(A.eO,{value:g.votingAirdrop.toNumber(),keepDecimal:3,children:v.nativeCurrency.symbol})},{title:"",value:(0,o.jsx)("div",{})}],C=[{title:s("VotingNode"),value:null!==(i=null===(t=m.nodeMap.get(null!==(a=null===(n=u.nodeCurrentRoundInfo)||void 0===n?void 0:n.userInfo.nodeType)&&void 0!==a?a:d.r.NodeType.CANDIDATE))||void 0===t?void 0:t.title)&&void 0!==i?i:""},{title:s("NodeAddress"),value:(0,o.jsx)(_.Z,{address:null!==(l=null===(r=u.nodeCurrentRoundInfo)||void 0===r?void 0:r.nodeAddress)&&void 0!==l?l:"",text:M.Z.toShort(e.nodeAddress)})},{title:s("TotalVotes"),value:(0,o.jsx)(A.eO,{value:10*f.totalVoteAmount.toNumber()})},{title:s("CreationTime"),value:w.Z.dateFormat(new Date(u.nodeDetail.creationTime),"yyyy-MM-dd HH:mm:ss")}];return(0,o.jsx)("div",{className:"py-[30px] bg-gradient-to-r from-primary to-highlight rounded-lg",children:(0,o.jsx)("div",{className:"flex flex-col justify-center gap-[10px]",children:[N,C].flat().map((e,t)=>(0,o.jsxs)("div",{className:"flex flex-col gap-[10px] text-[14px] font-semibold",children:[(0,o.jsxs)("div",{className:"flex justify-between mx-[20px] min-h-[21px]",children:[(0,o.jsxs)("span",{children:[e.title,e.title?":":""]}),(0,o.jsx)("span",{className:"",children:e.value})]}),[N,C].flat().length-1!==t?(0,o.jsx)("div",{className:"w-full h-[1px] bg-[#111]"}):null]},e.title))})})}var z=n(32223),U=n(66577),G=n(97644),J=n(11340),H=n(41525);function Q(e){let{t}=(0,c.$G)(["dao","common"]),n=p.Q.getTargetNet(),r={justNow:t("common:JustNow"),minutesAgo:t("common:MinutesAgo",{minutes:"{0}"}),hoursAgo:t("common:HoursAgo",{hours:"{0}"}),daysAgo:t("common:DaysAgo",{days:"{0}"}),monthsAgo:t("common:MonthsAgo",{months:"{0}"}),yearsAgo:t("common:YearsAgo",{years:"{0}"}),yesterday:t("common:Yesterday"),today:t("common:Today")},a=[{title:t("common:TX"),dataIndex:"transaction",key:"transaction",width:250,align:"left",render:(e,t)=>(0,o.jsx)(f.Z,{horizontalArrangement:J.cV.Start,children:(0,o.jsx)(H.Z,{chainId:n.chainId,hash:t.txHash,text:M.Z.toShort(t.txHash)})})},{title:t("dao:VoteTime"),dataIndex:"voteTime",key:"voteTime",width:250,render:(e,t)=>{let n=w.Z.latestDate(new Date(t.voteTime),r);return(0,o.jsx)(f.Z,{horizontalArrangement:J.cV.Center,verticalAlignment:J.v2.Center,className:"date whitespace-nowrap",children:n})}},{title:t("dao:VoteNumber"),dataIndex:"voteNumber",key:"voteNumber",width:250,render:(e,t)=>(0,o.jsx)(f.Z,{horizontalArrangement:J.cV.Center,verticalAlignment:J.v2.Center,className:"amount-contain",children:(0,o.jsx)(A.eO,{value:t.voteNumber})})},{title:t("dao:VoteAmount"),dataIndex:"voteAmount",key:"voteAmount",width:250,align:"right",render:(e,t)=>(0,o.jsx)(f.Z,{horizontalArrangement:J.cV.End,verticalAlignment:J.v2.Center,className:"amount-contain gap-2",children:(0,o.jsx)(A.eO,{value:Number(t.voteAmount),useSub:!0,className:"items-center",children:(0,o.jsx)(v.Z,{className:"w-[20px] h-[20px]"})})})}];return(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(G.ZP,{pageInfo:{page:e.tableData.pageIndex,totalPage:e.tableData.total},onPaginationChange:t=>{let{page:n}=t;return 0===n?{promise:Promise.resolve(),cancel:()=>{}}:e.getNextListData({page:n})},children:(0,o.jsx)("div",{className:"voting-record-table-contain overflow-x-auto",children:(0,o.jsx)(U.ZP,{rowKey:e=>e.txHash,emptyText:"",className:"voting-record-table text-center min-w-[760px]",columns:a,data:e.tableData.data})})})})}var $=n(63671);function W(e){let{t}=(0,c.$G)(["dao"]),[n,r]=u.useState((0,$.ki)({pageSize:10})),a=u.useRef(n);function i(n){var o;function i(e){l.abort(e)}let l=new AbortController,s=a.current;if(!n.restart&&s.isLoading)return{promise:Promise.resolve(),cancel:i};let d=n.restart?1:null!==(o=n.page)&&void 0!==o?o:s.pageIndex+1;return r({...s,isLoading:!0}),{promise:new y.Z().getVotingRecords({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,page:d,pageSize:s.pageSize,signal:l.signal}).then(e=>{var t,n;if(e.hasError())throw Error(e.getError().msg);let o=(null!==(t=e.getData())&&void 0!==t?t:[]).map(e=>e.toJSON()),a=null!==(n=e.getTotalPage())&&void 0!==n?n:s.total,i=0===e.getTotalPage()||0===o.length||o.length<s.pageSize;r({...s,pageIndex:d,isLoading:!1,total:a,isEnd:i,data:o})}).catch(e=>{Z.Z.D("getTokens err",e),b.Z.canBeIgnore(e)||(0,j.L6)(new j.HU(e,t("Error in get voting record list")).asToastMessage())}),cancel:i}}return u.useEffect(()=>{a.current=n},[n]),u.useEffect(()=>{if(!e.nodeAddress||!e.daoAddress||a.current.isLoading)return;let t=w.Z.sleepForAnimationFrame(500);return t.promise.then(()=>(function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];r({...n,data:[],pageIndex:1,isEnd:!1,isLoading:!1}),e&&u.startTransition(async()=>{await i({restart:!0}).promise})})()),()=>{t.cancel(b.Z.ReactError.useEffectDestroy())}},[e.nodeAddress,e.daoAddress]),(0,o.jsx)(Q,{tableData:n,getNextListData:i})}var Y=n(78733),K=n(41849);function X(e){let t=(0,h.C)(e=>e.global),{t:n}=(0,c.$G)(["common","dao"]),[r,a]=u.useState((0,$.ki)({pageSize:10})),i=u.useRef(r);function l(t){var o;function r(e){l.abort(e)}let l=new AbortController,s=i.current;if(!t.restart&&s.isLoading)return{promise:Promise.resolve(),cancel:r};let d=t.restart?1:null!==(o=t.page)&&void 0!==o?o:s.pageIndex+1;return a({...s,isLoading:!0}),{promise:new y.Z().getMyVotingRecords({nodeAddress:e.nodeAddress,daoAddress:e.daoAddress,page:d,pageSize:s.pageSize,signal:l.signal}).then(e=>{var t,n;if(e.hasError())throw Error(e.getError().msg);let o=(null!==(t=e.getData())&&void 0!==t?t:[]).map(e=>e.toJSON()),r=null!==(n=e.getTotalPage())&&void 0!==n?n:s.total,i=0===e.getTotalPage()||0===o.length||o.length<s.pageSize;a({...s,pageIndex:d,isLoading:!1,total:r,isEnd:i,data:o})}).catch(e=>{Z.Z.D("getTokens err",e),b.Z.canBeIgnore(e)||(0,j.L6)(new j.HU(e,n("Error in get voting record list")).asToastMessage())}),cancel:r}}function s(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];a({...r,data:[],pageIndex:1,isEnd:!1,isLoading:!1}),e&&u.startTransition(async()=>{await l({restart:!0}).promise})}return u.useEffect(()=>{i.current=r},[r]),u.useEffect(()=>{if(!e.nodeAddress||!e.daoAddress||i.current.isLoading)return;if(!t.token){s(!1);return}let n=w.Z.sleepForAnimationFrame(500);return n.promise.then(()=>s()),()=>{n.cancel(b.Z.ReactError.useEffectDestroy())}},[e.nodeAddress,e.daoAddress,t.token]),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)(Q,{tableData:r,getNextListData:l}),t.token?0===r.data.length?(0,o.jsx)(K.Z,{}):null:(0,o.jsx)(Y.Z,{})]})}function ee(e){let{t}=(0,c.$G)(["dao"]),[n,r]=u.useState("all"),a={title:t("dao:AllRecords"),url:"all"},i={title:t("dao:MyVotingRecords"),url:"my"},l=[a,i];return(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)(z.Z,{className:"items-start",displayType:z.L.BorderGradient,tabList:l,activeIndex:l.findIndex(e=>e.url===n),onClick:e=>r(e)}),(0,o.jsxs)("div",{className:"bg-[#050505] border border-[#666666] rounded-lg p-4 mt-4",children:[n===a.url?(0,o.jsx)(W,{nodeAddress:e.nodeAddress,daoAddress:e.daoAddress}):null,n===i.url?(0,o.jsx)(X,{nodeAddress:e.nodeAddress,daoAddress:e.daoAddress}):null]})]})}function et(e){let[t,n]=u.useState(""),[r,a]=u.useState("");return R({nodeAddress:t,daoAddress:r,autoTrigger:!0}),u.useEffect(()=>{let e=new URLSearchParams(location.search),t=e.get(E.Z.Params.NODE_ADDRESS),o=e.get(E.Z.Params.DAO_ADDRESS);t&&o&&(n(t),a(o))},[]),(0,o.jsxs)("div",{className:(0,m.m6)("flex flex-col gap-[20px]",e.className),children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-[20px] mt-[20px] items-stretch",children:[(0,o.jsx)(q,{nodeAddress:t}),(0,o.jsx)(O,{})]}),(0,o.jsx)(ee,{nodeAddress:t,daoAddress:r})]})}function en(){return(0,o.jsx)("div",{className:"relative overflow-x-hidden text-secondary bg-[#000000]",children:(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)(l.Z,{}),(0,o.jsx)(r.Z,{}),(0,o.jsxs)(a.ZP,{width:a.W7.Wrapper,background:a.nV.None,className:"mx-[20px] 2xl:mx-auto",children:[(0,o.jsx)(s.Z,{activeTarget:d.r.VotingTabEnum.NONE}),(0,o.jsx)(et,{className:"max-w-[var(--detail-content-width)] mx-[20px] md:mx-auto"})]}),(0,o.jsx)(i.Z,{})]})})}},59365:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(57437);function r(e){var t,n;return(0,o.jsx)("img",{src:"/images/icon-eth.svg",width:null!==(t=e.width)&&void 0!==t?t:20,height:null!==(n=e.height)&&void 0!==n?n:20,alt:"ETH",className:e.className})}},48423:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var o=n(57437);n(2265),n(53953);var r=n(22448),a=n(10867),i=n(71549),l=n(53335);function s(e){let{chainId:t,address:n,text:s,children:d,className:u,...c}=e,m=(0,o.jsx)(r.Z,{children:n}),v=new i.Q(t).getAddressUrl(n);return(0,o.jsx)(a.Z,{placement:"top",speaker:m,trigger:"hover",children:(0,o.jsx)("a",{className:(0,l.m6)("component-chain-address-link pointer hover underline",u),href:v,target:"_blank",...c,children:null!=s?s:n})})}},41525:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var o=n(57437);n(2265),n(34159);var r=n(22448),a=n(10867),i=n(71549);function l(e){let{chainId:t,hash:n,text:l,children:s,className:d,...u}=e,c=(0,o.jsx)(r.Z,{children:n}),m=new i.Q(t).getTXUrl(n);return(0,o.jsx)(a.Z,{placement:"top",speaker:c,trigger:"hover",children:(0,o.jsx)("a",{className:"component-chain-hash-link pointer hover underline ".concat(null!=d?d:""),href:m,target:"_blank",...u,children:null!=l?l:n})})}},29698:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var o,r=n(57437),a=n(10867),i=n(22448),l=n(94746);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(null,arguments)}var d=function(e){return l.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},e),o||(o=l.createElement("path",{fill:"#fff",fillOpacity:.8,d:"M6.992 0q1.455 0 2.73.555t2.229 1.502a7 7 0 0 1 1.502 2.221Q14 5.553 14 7.008t-.547 2.722a7.056 7.056 0 0 1-3.73 3.723Q8.445 14 6.992 14q-1.455 0-2.723-.547a7.1 7.1 0 0 1-2.22-1.502A7.1 7.1 0 0 1 .546 9.73 6.8 6.8 0 0 1 0 7.008q0-1.455.547-2.73.548-1.275 1.502-2.221A7.3 7.3 0 0 1 4.27.555 6.7 6.7 0 0 1 6.992 0m.016 11.794a.92.92 0 0 0 .68-.273.9.9 0 0 0 .274-.665.92.92 0 0 0-.274-.68.92.92 0 0 0-.68-.274.92.92 0 0 0-.68.273.92.92 0 0 0-.274.68q0 .392.273.666.275.273.68.273m.798-3.848q-.016-.25.312-.531.329-.282.736-.626t.75-.774.376-.994q.03-.61-.125-1.142a2.24 2.24 0 0 0-.516-.915 2.5 2.5 0 0 0-.931-.61q-.57-.227-1.338-.227-.954 0-1.587.337a3.3 3.3 0 0 0-1.025.813q-.39.477-.547.986-.158.508-.141.852.015.407.258.595a.88.88 0 0 0 .524.195.84.84 0 0 0 .516-.156.55.55 0 0 0 .235-.477q0-.189.117-.462t.32-.524q.204-.25.494-.422.289-.172.649-.172.703 0 1.126.352.422.351.391.883a.85.85 0 0 1-.156.493 2.4 2.4 0 0 1-.4.438q-.242.211-.516.422-.273.211-.516.438a2.4 2.4 0 0 0-.406.493q-.165.266-.18.579l.015.594q0 .235.22.446.218.212.578.227.36-.015.571-.235a.65.65 0 0 0 .196-.5z"})))},u=n(53335),c=n(2265);function m(e){let t=c.useRef(null);return(0,r.jsx)("div",{ref:t,className:(0,u.m6)("relative",e.className),children:(0,r.jsx)(a.Z,{placement:"auto",className:(0,u.m6)("",e.containClassName),container:()=>{var n,o;return null!==(o=null!==(n=e.targetContain)&&void 0!==n?n:t.current)&&void 0!==o?o:"undefined"!=typeof document?document.body:null},speaker:(0,r.jsx)(i.Z,{className:(0,u.m6)("-mt-[25px]",e.tooltipClassName),style:{maxWidth:"1000px"},children:e.children}),trigger:"hover",enterable:!0,rootClose:!0,...e.whisperProps,children:(0,r.jsx)(d,{className:(0,u.m6)("w-[14px] h-[14px]",e.iconClassName)})})})}},78733:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var o,r,a,i,l=n(57437),s=n(94746);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(null,arguments)}var u=function(e){return s.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 45 36"},e),o||(o=s.createElement("path",{fill:"#666",d:"M26.663 11.193h13.12l-1.75-3.896c-.477-1.113-1.829-1.59-2.942-1.113l-8.666 3.976c-.477.238-.318 1.033.238 1.033m17.651 3.737c0-1.192-1.033-2.226-2.226-2.226H13.226c-1.192 0-2.226 1.034-2.226 2.226v18.844C11 34.966 12.034 36 13.226 36h28.862c1.193 0 2.226-1.034 2.226-2.226v-6.122h-8.746a3.36 3.36 0 0 1-3.34-3.34 3.36 3.36 0 0 1 3.34-3.34h8.746z"})),r||(r=s.createElement("path",{fill:"#666",d:"M34.456 24.392a1.113 1.113 0 1 0 2.225 0 1.113 1.113 0 0 0-2.225 0"})),a||(a=s.createElement("path",{fill:"url(#icon-file-warning_svg__a)",d:"M9.6 0C4.299 0 0 4.475 0 10s4.299 10 9.6 10 9.6-4.475 9.6-10S14.901 0 9.6 0m0 15.612c-.56 0-1.011-.474-1.011-1.054 0-.583.452-1.056 1.011-1.056.56 0 1.011.473 1.011 1.056 0 .58-.452 1.054-1.011 1.054m1.71-10.1-.86 5.564c-.115.723-.496 1.315-.85 1.315s-.735-.592-.85-1.315L7.89 5.51C7.774 4.788 8.256 4 8.96 4h1.279c.705 0 1.187.786 1.071 1.511"})),i||(i=s.createElement("defs",null,s.createElement("linearGradient",{id:"icon-file-warning_svg__a",x1:0,x2:19.2,y1:10,y2:10,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#E700E6"}),s.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))},c=n(43949),m=n(53335);function v(e){let{t}=(0,c.$G)(["common"]);return(0,l.jsxs)("div",{className:(0,m.m6)("flex flex-col justify-center items-center gap-[18px] p-[65px]",e.className),children:[(0,l.jsx)(u,{className:"w-[44px] h-[38px]"}),(0,l.jsx)("div",{className:"text-white",children:t("NoConnectWalletTip")})]})}},32223:function(e,t,n){"use strict";n.d(t,{L:function(){return r},Z:function(){return s}});var o,r,a=n(57437),i=n(53335);n(61940);var l=n(2265);function s(e){var t,n;let[o,r]=(0,l.useState)(null!==(t=e.activeIndex)&&void 0!==t?t:0),s=null!==(n=e.displayType)&&void 0!==n?n:"default";return(0,l.useEffect)(()=>{void 0!==e.activeIndex&&e.activeIndex!==o&&r(e.activeIndex)},[e.activeIndex]),(0,a.jsxs)("div",{className:(0,i.m6)("tab-list-v2 flex flex-col items-stretch ".concat(s),e.className),children:[(0,a.jsxs)("ul",{className:(0,i.m6)("list tab-list-title flex flex-row items-center",e.tabListTitleClassName),children:[e.title?(0,a.jsx)("li",{className:(0,i.m6)("item tab-list-title-item bold transition-fast no-active text-[12px] md:text-[14px]",e.tabList.length>3?"flex-1 md:flex-none":"",e.titleClassName),children:(0,a.jsx)("span",{className:"flex justify-center items-center title cursor-pointer hover transition-fast",children:e.title})},-1):null,e.tabList.map((t,n)=>{var l,d;return(0,a.jsx)("li",{className:(0,i.m6)("item tab-list-title-item bold transition-fast text-[12px] md:text-[14px] ".concat(o==n?"in-active":"no-active"),e.tabList.length>3?"flex-1 md:flex-none":"",null===(l=e.tabItemClassName)||void 0===l?void 0:l.call(e,o===n)),children:(0,a.jsx)("span",{onClick:()=>{r(n),e.onClick(e.tabList[n].url)},className:(0,i.m6)("flex justify-center items-center title cursor-pointer hover transition-fast w-full",null===(d=e.tabItemTitleClassName)||void 0===d?void 0:d.call(e,o===n)),children:(0,a.jsx)("i",{className:o==n&&("default"===s||"border-gradient"===s)?"text-gradient":"text-secondary",children:t.title})})},n)})]}),e.children?(0,a.jsx)("ul",{className:"list tab-list-content",children:e.children}):""]})}(o=r||(r={})).Default="default",o.BorderGradient="border-gradient",o.BgGradient="bg-gradient"},12628:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var o=n(57437),r=n(32223),a=n(43949),i=n(89769),l=n(99376),s=n(53335),d=n(95665);function u(e){let t=(0,l.useRouter)(),{t:n}=(0,a.$G)(["dao"]),u=[{title:n("TabVote"),url:"/dao/node",target:i.r.VotingTabEnum.VOTE},{title:n("TabEWV"),url:"/dao/ewv",target:i.r.VotingTabEnum.EWV},{title:n("TabNode"),url:"/dao/user",target:i.r.VotingTabEnum.NODE}];return(0,o.jsx)("div",{className:"flex flex-col items-stretch md:items-center",children:(0,o.jsx)(r.Z,{className:(0,s.m6)("mb-10",e.className),tabItemClassName:()=>"w-[33%] md:w-[180px]",tabItemTitleClassName:()=>"w-full",displayType:r.L.BgGradient,activeIndex:u.findIndex(t=>t.target===e.activeTarget),tabList:u,onClick:e=>{let n=new URLSearchParams(location.search);if(!n.has(d.Z.Params.DAO_ADDRESS))return t.push(e);let o=new URL(e,location.origin),r=new URLSearchParams(o.search);r.set(d.Z.Params.DAO_ADDRESS,n.get(d.Z.Params.DAO_ADDRESS)),o.search=r.toString(),t.push("".concat(o.origin).concat(o.pathname,"?").concat(r.toString()))}})})}},75370:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var o,r,a,i,l=n(12249),s=n(5853),d=n(74439),u=n(43009),c=n(8113),m=n(6178),v=n(2265);function f(){let e=(0,m.C)(e=>e.global),t=(0,m.C)(e=>e.dao);return v.useMemo(()=>{var n,o,r,a;return new p().initialize({roundEndTime:null!==(r=null===(n=t.daoCurrentRoundInfo)||void 0===n?void 0:n.roundExpire)&&void 0!==r?r:-1,timeCanReward:null!==(a=null===(o=t.daoContractInfo)||void 0===o?void 0:o.loserPoolRewardTimeLimit)&&void 0!==a?a:0,currentTime:e.currentTime})},[t.daoCurrentRoundInfo,t.daoContractInfo,e.currentTime])}(o=a||(a={}))[o.UNINITIALIZED=0]="UNINITIALIZED",o[o.ROUND_READY=1]="ROUND_READY",o[o.ROUND_START=2]="ROUND_START",o[o.ROUND_END=3]="ROUND_END",(r=i||(i={}))[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.CLAIM_START=1]="CLAIM_START",r[r.CLAIM_END=2]="CLAIM_END";class g{static defaultInfo(){return{toFormated:()=>"--:--:--"}}}class p extends c.Vw.BaseDataAdapter{initialize(e){return super.initialize(e),this}get roundStatus(){let e=this.roundEndTime.toJSTime(),t=this.currentTime;return -1===e?0:0===e?1:e>t?2:3}get isRoundStart(){return 0!==this.roundStatus&&1!==this.roundStatus}get isRoundEnd(){return 3===this.roundStatus}getRoundEndCountdown(){return d.Z.convertTimeDifference(new Date(this.roundEndTime.toJSTime()-this.currentTime))}get roundClaimStartTime(){return this.roundEndTime.toJSTime()}getRoundClaimStartCountdown(){let e=d.Z.convertTimeDifference(new Date(this.roundClaimStartTime-this.currentTime),{includeDays:!1});return 0===e?g.defaultInfo():e}get roundClaimEndTime(){return -1===this.roundEndTime.toJSTime()?-1:this.roundEndTime.toJSTime()+this.timeCanReward.toJSTime()}get claimStatus(){return 0===this.timeCanReward.toJSTime()?0:this.roundClaimEndTime<=this.currentTime?2:this.roundClaimStartTime<=this.currentTime?1:0}get isRoundClaimStart(){return 1===this.claimStatus}getRoundClaimEndCountdown(){let e=d.Z.convertTimeDifference(new Date(this.roundClaimEndTime-this.currentTime),{includeDays:!1});return 0===e?g.defaultInfo():e}get isRoundClaimEnd(){return 2===this.claimStatus}getFundCountdownInfo(){return this.isRoundClaimEnd||!this.isRoundStart?g.defaultInfo():this.isRoundClaimStart?this.isRoundClaimEnd?g.defaultInfo():this.getRoundClaimEndCountdown():this.getRoundClaimStartCountdown()}getClaimCountdownInfo(){return this.getFundCountdownInfo()}constructor(...e){super(...e),(0,l._)(this,"roundEndTime",u.Z.Time.from(-1)),(0,l._)(this,"timeCanReward",u.Z.Time.from(0)),(0,l._)(this,"currentTime",void 0)}}(0,s.gn)([c.Vw.To(u.Z.Time.fromJSTimestamp.bind(u.Z.Time)),(0,s.w6)("design:type",void 0===u.Z||void 0===u.Z.Time?Object:u.Z.Time)],p.prototype,"roundEndTime",void 0),(0,s.gn)([c.Vw.To(u.Z.Time.fromJSTimestamp.bind(u.Z.Time))],p.prototype,"timeCanReward",void 0),(0,s.gn)([c.Vw.To(),(0,s.w6)("design:type",Number)],p.prototype,"currentTime",void 0)},50544:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var o=n(2265),r=n(89769),a=n(43949),i=n(6178),l=n(21707),s=n(40366),d=n(71549),u=n(10433),c=n(95665),m=n(81939);function v(){var e,t,n,v,f,g,p,x,h,N,C,w,A,T,I,j,b,Z,y,E;let D=(0,i.T)(),{t:S,i18n:R}=(0,a.$G)(["dao"]),L=(0,i.C)(e=>e.dao),k="/images/dao/",V=new Map([[r.r.NodeType.NONE,{color1:"#000",color2:"#fff",title:S("notNode.title"),description:S("notNode.description"),image:"".concat(k,"not-node.png"),upgradeInfo:{userNodeCount:0n,requiredNodeCount:0n,ethPrice:0n}}],[r.r.NodeType.CANDIDATE,{color1:"#E700E6",color2:"#4B4BDF",title:S("candidateNode.title"),description:S("candidateNode.description",{title:S("candidateNode.title").toLocaleLowerCase(),token:L.tokenInfo.symbol,value:m.Z.wei2eth(null!==(C=null===(e=L.daoContractInfo)||void 0===e?void 0:e.applyCandidateEthAmount)&&void 0!==C?C:0n)}),image:"".concat(k,"candidate-node.png"),upgradeInfo:{userNodeCount:0n,requiredNodeCount:0n,ethPrice:null!==(w=null===(t=L.daoContractInfo)||void 0===t?void 0:t.applyCandidateEthAmount)&&void 0!==w?w:0n}}],[r.r.NodeType.MASTER,{color1:"#EA7D01",color2:"#B06D00",title:S("mainNode.title"),description:S("mainNode.description",{prevTitle:S("candidateNode.title").toLocaleLowerCase(),title:S("mainNode.title").toLocaleLowerCase(),nodeCount:String(null!==(A=null===(n=L.daoContractInfo)||void 0===n?void 0:n.votesForMaster)&&void 0!==A?A:0n)}),image:"".concat(k,"main-node.png"),upgradeInfo:{userNodeCount:null!==(T=null===(v=L.userInfo)||void 0===v?void 0:v.userInfo.sonCount)&&void 0!==T?T:0n,requiredNodeCount:null!==(I=null===(f=L.daoContractInfo)||void 0===f?void 0:f.votesForMaster)&&void 0!==I?I:0n,ethPrice:0n}}],[r.r.NodeType.SUPER,{color1:"#00E7D4",color2:"#4B4BDF",title:S("superNode.title"),description:S("superNode.description",{prevTitle:S("mainNode.title").toLocaleLowerCase(),title:S("superNode.title").toLocaleLowerCase(),token:L.tokenInfo.symbol,value:m.Z.wei2eth(null!==(j=null===(g=L.daoContractInfo)||void 0===g?void 0:g.applySuperEthAmount)&&void 0!==j?j:0n),nodeCount:String(null!==(b=null===(p=L.daoContractInfo)||void 0===p?void 0:p.masterForSuper)&&void 0!==b?b:0n)}),image:"".concat(k,"super-node.png"),upgradeInfo:{userNodeCount:null!==(Z=null===(x=L.userInfo)||void 0===x?void 0:x.userInfo.sonMasterNodeCount)&&void 0!==Z?Z:0n,requiredNodeCount:null!==(y=null===(h=L.daoContractInfo)||void 0===h?void 0:h.masterForSuper)&&void 0!==y?y:0n,ethPrice:null!==(E=null===(N=L.daoContractInfo)||void 0===N?void 0:N.applySuperEthAmount)&&void 0!==E?E:0n}}]]),P=Array.from(V.entries()),O=new Map;P.forEach((e,t)=>{let n=e[0],o=P[t+1];O.set(n,{nextKey:o?Number(o[0]):void 0,nextValue:o?o[1]:void 0})});let F=new Map(L.nodesCurrentRoundInfo.map(e=>["".concat(e.daoAddress,",").concat(e.nodeAddress),e]));async function M(e,t){if(0===e.length)return[];let n=new l.C(t.daoAddress,s.K),o=e.map(e=>n.promotions(t.currentRoundNO,e)),r=d.Q.getDefaultProvider(),a=new l.z(d.Q.getTargetNet().chainId,r),i=await a.all(o),c=e.map((e,n)=>({nodeAddress:e,daoAddress:t.daoAddress,promotionInfo:i[n]}));return u.Z.I("getNodeCurrentRoundSimpleInfo",c),c}async function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(t=null!=t?t:L.daoContractInfo))throw Error("daoAddress and currentRoundNO can't be empty");let n=await M([e,L.nodes.data.map(e=>e.walletAddress)].flat(),t);D(c.Z.slice.actions.updateNodesCurrentRoundInfo(n))}return o.useEffect(()=>{V.set(r.r.NodeType.MASTER,{...V.get(r.r.NodeType.MASTER),title:S("mainNode.title")}),V.set(r.r.NodeType.SUPER,{...V.get(r.r.NodeType.SUPER),title:S("superNode.title")})},[R.language]),{nodeMap:V,nodeToNextMap:O,getNodeCurrentRoundSimpleInfo:M,updateNodeCurrentRoundInfoSimpleInfo:_,nodeCurrentRoundSimpleInfoMap:F}}},53953:function(){},34159:function(){},61940:function(){}},function(e){e.O(0,[1283,5073,2506,977,6870,4758,2784,7181,6764,3923,3448,3690,9738,1811,6577,6570,6011,4942,9481,1240,8933,2971,2117,1744],function(){return e(e.s=37688)}),_N_E=e.O()}]);