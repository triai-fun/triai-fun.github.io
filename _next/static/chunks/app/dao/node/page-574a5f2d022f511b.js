(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8386],{70307:function(e,t,n){Promise.resolve().then(n.bind(n,20236))},20236:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var a=n(37821),r=n(46440),s=n(38279),o=n(19586),i=n(97899),l=n(48616),d=n(95744),c=n(42132),u=n(79819),m=n(60616),g=n(98018),x=n(30476),f=n(42693),p=n(52574),h=n(15256),v=n(5038),j=n(21441),N=n(74795),Z=n(58504),w=n(58078),y=n(65521),A=n(31638),C=n(52650),b=n(32662),T=n(50475);function E(e){let t=(0,Z.useRouter)(),{t:n}=(0,y.$G)(["dao"]),r=(0,v.C)(e=>e.global);(0,v.C)(e=>e.dao);let[s,o]=w.useState(null);async function i(){if(!s)throw Error("Can't found target nft address");let e="0x7CFA99eE55D07214cdD8E5A38501e0C087d212a4";if(!e)throw Error("NEXT_PUBLIC_DAO_FACTORY_CONTRACT_ADDRESS not found!");let a=d.r.getInstance(),r=l.Z.getInstance(a.getProvider()),o=await r.getSigner(),i=p.lf.connect(e,o);try{var u;let e=await i.createDao(s),a=await e.wait();(0,x.x9)(n("SuccessfullyOpenDAO")),E();let r=null==a?void 0:null===(u=a.logs[0].args)||void 0===u?void 0:u[0];if(r){m.Z.I("DAO created",{daoAddress:r}),await c.Z.sleepForAnimationFrame(3e3);let e=new URLSearchParams;e.set(j.Z.Params.DAO_ADDRESS,r),t.push("/dao/node?".concat(e.toString())),t.refresh()}}catch(e){(0,x.L6)(new x.HU(e,n("FailedToOpenDAO")).asToastMessage())}}async function E(e){let t=new h.Z,[n,a]=(await t.getUserAllCreatedNftLPs({signal:e})).tryGetData();if(a)return(0,x.L6)(a.msg),m.Z.E(a),o(null);if(!n.length)return o(null);let r=(await new h.Z().getBalanceOfTokens(n.map(e=>e.pairAddress))).findIndex(e=>e>=N.fi("0"));if(r<0)return o(null);o(n[r].tokenAddress)}return(0,f.Z)(),w.useEffect(()=>{if(!r.token)return o(null);let e=new AbortController;return c.Z.sleepForAnimationFrame(1e3).promise.then(()=>{e.signal.aborted||E(e.signal)}),()=>{e.abort(u.Z.ReactError.useEffectDestroy())}},[r.token]),(0,a.jsxs)("div",{className:(0,A.m6)("flex flex-col items-start gap-4",e.className),children:[(0,a.jsx)(T.Z,{children:n("Title")}),(0,a.jsx)(b.Z,{children:n("Description")}),(0,a.jsxs)("div",{className:"flex justify-between md:justify-start items-center gap-2 md:gap-[104px]",children:[(0,a.jsx)(g.ZP,{size:g.qE.Small,className:"w-[160px] text-[14px] shine-animation",onClick:()=>{let e=new URLSearchParams(location.search);if(e.has(j.Z.Params.DAO_ADDRESS)){var n;e.set(j.Z.Params.DAO_ADDRESS,null!==(n=e.get(j.Z.Params.DAO_ADDRESS))&&void 0!==n?n:"")}let a=e.toString();t.push("/dao/user?".concat(a,"#").concat(C.r.MyAssetsPageTab.ApplyNode))},children:n("ApplyForNode")}),s?(0,a.jsx)(g.ZP,{size:g.qE.Small,className:"w-[160px] text-[14px] shine-animation",waitForClick:!0,onClick:()=>i(),children:n("OpenDAO")}):null]})]})}var P=n(54482),S=n(56091),D=n.n(S),L=n(55952),k=n(40647),I=n(12377),R=n(36051),F=n(88390),O=n(31744);function _(e){var t;let n=(0,Z.useRouter)(),r=(0,v.C)(e=>e.dao),o=(0,v.C)(e=>e.user),{t:i,i18n:l}=(0,y.$G)(["dao"]);R.Q.getTargetNet();let d=c.Z.dateFormat(new Date(e.creationTime),"yyyy-MM-dd HH:mm:ss"),u=null!==(t=e.onVote)&&void 0!==t?t:()=>{var t;let a=new URLSearchParams;a.set(j.Z.Params.DAO_ADDRESS,e.daoAddress);let s=null===(t=r.userInfo)||void 0===t?void 0:t.userInfo.parent;o.ethInfo.walletAddress&&s&&s!==O.N?a.set(j.Z.Params.NODE_ADDRESS,s):s=e.address,a.set(j.Z.Params.NODE_ADDRESS,s),n.push("/dao/node/detail?".concat(a.toString()))};return(0,a.jsxs)(s.ZP,{autoBorder:!0,autoMargin:!1,autoPadding:!1,className:"rounded-lg p-[15px]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("span",{className:"text-[#999999] text-[14px] font-medium",children:[i("Address"),": "]}),(0,a.jsx)(k.Z,{className:"text-[#CCCCCC] text-[14px] font-medium underline ml-2",address:e.address,text:I.Z.toShort(e.address)})]}),(0,a.jsx)(M,{nodeType:e.nodeType})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[#999999] text-[14px] font-medium",children:i("TotalVotes")}),(0,a.jsx)("span",{className:"text-[#999999] text-[14px] font-medium flex gap-1",children:10*Number(e.totalVotes)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-[#999999] text-[14px] font-medium",children:i("Creation Time")}),(0,a.jsx)("span",{className:"text-[#999999] text-[14px] font-medium",children:d})]})]}),(0,a.jsx)("button",{className:"w-full leading-[40px] rounded-[8px] flex items-center justify-center font-medium border border-[#666] normal-text-gradient hover:opacity-90 transition focus:bg-gradient-to-r from-primary to-highlight focus:text-white",onClick:u,children:i("VoteTitle")})]})}function M(e){let{t}=(0,y.$G)(["dao"]),n=(0,F.Z)().nodeMap.get(e.nodeType);return(0,a.jsx)("div",{className:(0,A.m6)("p-[1px] rounded","bg-gradient-to-r from-[".concat(null==n?void 0:n.color1,"] to-[").concat(null==n?void 0:n.color2,"]")),style:{backgroundImage:"linear-gradient(to right, ".concat(null==n?void 0:n.color1,", ").concat(null==n?void 0:n.color2,")")},children:(0,a.jsx)("div",{className:"bg-black w-[100px] h-[22px] flex items-center justify-center leading-none rounded",children:(0,a.jsx)("span",{className:(0,A.m6)("text-[10px] leading-none font-medium bg-gradient-to-r bg-clip-text text-transparent","from-[".concat(null==n?void 0:n.color1,"] to-[").concat(null==n?void 0:n.color2,"]")),style:{backgroundImage:"linear-gradient(to right, ".concat(null==n?void 0:n.color1,", ").concat(null==n?void 0:n.color2,")")},children:null==n?void 0:n.title})})})}var V=n(58520),U=n(19379),B=n(73753);function z(e){var t,n,r;let{t:s}=(0,y.$G)(["dao"]),o=(0,v.T)();(0,v.C)(e=>e.global);let i=(0,v.C)(e=>e.dao),[d,m]=w.useTransition(),f=(0,F.Z)(),[p,h]=w.useState(i.nodeListFilters.keyword),N=D()(h,20),Z=null===(t=i.nodeListFilters.selectedDao)||void 0===t?void 0:t.address,C=null!==(r=i.nodeListFilters.keyword)&&void 0!==r?r:void 0,b=i.nodes.isLoading,T=i.nodes.pageIndex,E=i.nodes.pageSize,S=i.nodes.total,k=null===(n=i.daoContractInfo)||void 0===n?void 0:n.daoAddress;function I(){p!==i.nodeListFilters.keyword&&o(j.Z.slice.actions.updateNodeListFilters({keyword:p}))}let R=w.useCallback(e=>{var t;let n=new AbortController;if(!Z||!e.restart&&b)return{promise:Promise.resolve(),cancel:e=>n.abort(e)};let a=e.restart?1:null!==(t=e.page)&&void 0!==t?t:T+1;return o(j.Z.slice.actions.setNodesToLoading()),{promise:new L.Z().getNodeList({daoAddress:Z,page:a,keyword:C,abortController:n,pageSize:E}).then(e=>{if(e.hasError())throw Error(e.getError().msg);let t=e.getData(),n=e.getTotalPage(),r=null!=n?n:S,s=0===n||0===t.length||t.length<E;o(j.Z.slice.actions.updateNodeNewPage({pageIndex:a,total:r,isEnd:s,data:t})),w.startTransition(()=>{f.updateNodeCurrentRoundInfoSimpleInfo(t.map(e=>e.walletAddress))})}).catch(e=>{u.Z.canBeIgnore(e)||(0,x.L6)(new x.HU(e,"Error in get node list").asToastMessage())}),cancel:e=>n.abort(e)}},[Z,C,b,T,E,S,o,f]);return w.useEffect(()=>{if(!Z||!k)return;let e=c.Z.sleepForAnimationFrame(500);return e.promise.then(()=>{m(()=>R({restart:!0}).promise)}),()=>{e.cancel(u.Z.ReactError.useEffectDestroy())}},[Z,C,k]),(0,a.jsx)("div",{className:(0,A.m6)("relative flex flex-col nodes-contain",e.className),children:(0,a.jsxs)("div",{className:"flex flex-col items-stretch text-center gap-[22px] nodes-contain",children:[(0,a.jsx)("div",{className:"flex justify-start flex-col items-stretch md:flex-row md:items-center gap-[20px]",children:(0,a.jsx)(P.ZP,{className:"order-2 md:order-1 w-full md:w-[385px] search-token-bar",placeHolder:s("SearchForAddress"),onInputChange:N,value:null!=p?p:"",searchButton:(0,a.jsx)(g.ZP,{size:g.qE.Small,onClick:()=>I(),children:s("Search")}),onConfirm:I})}),(0,a.jsxs)(V.ZP,{pageInfo:{page:i.nodes.pageIndex,totalPage:i.nodes.total},onPaginationChange:e=>{let{page:t}=e;return 0===t?{promise:Promise.resolve(),cancel:()=>{}}:R({page:t})},children:[i.nodes.isLoading&&0===i.nodes.data.length?(0,a.jsx)("div",{className:"w-full grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-[20px] mx-auto",children:Array.from({length:8}).map((e,t)=>(0,a.jsx)("div",{className:"h-[140px] bg-[#0a0a0a] rounded-lg border border-[#222] animate-pulse"},t))}):(0,a.jsx)("div",{className:"w-full grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-[20px] mx-auto",children:i.nodes.data.map(e=>{let t=e.totalVotes.toString(),n=f.nodeCurrentRoundSimpleInfoMap.get("".concat(e.daoAddress,",").concat(e.walletAddress));if(n){var a,r,s,o;let e=new U.Z(l.Z.wei2eth(n.promotionInfo.totalSonVotedAmount)),d="bigint"==typeof(null===(a=i.daoContractInfo)||void 0===a?void 0:a.votePrice)?i.daoContractInfo.votePrice:BigInt(null!==(s=null===(r=i.daoContractInfo)||void 0===r?void 0:r.votePrice)&&void 0!==s?s:1n),c=null!==(o=n.promotionInfo.totalSonEthDone)&&void 0!==o?o:0n,u=new U.Z(l.Z.wei2eth(c/d*d));t=e.plus(u).toString()}return{id:e.id,address:e.walletAddress,daoAddress:e.daoAddress,nodeType:e.nodeType,totalVotes:t,creationTime:e.createTime}}).map(e=>(0,a.jsx)(_,{...e},e.id))}),i.nodes.isLoading||0!==i.nodes.data.length?null:(0,a.jsx)(B.Z,{})]})]})})}function G(e){return(0,a.jsx)("div",{className:(0,A.m6)("",e.className),children:(0,a.jsx)("img",{src:"/images/dao/dao-vote-banner.png",alt:"Vote Banner"})})}var H=n(64436),$=n(94503);function q(){return(0,v.C)(e=>e.dao),(0,$.Z)(void 0,{autoTrigger:!0}),(0,a.jsx)("div",{className:"relative overflow-x-hidden text-secondary bg-[#000000]",children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(i.Z,{}),(0,a.jsx)(r.Z,{}),(0,a.jsxs)(s.ZP,{width:s.W7.Wrapper,background:s.nV.None,className:"mx-[20px] 2xl:mx-auto",children:[(0,a.jsx)(H.Z,{activeTarget:C.r.VotingTabEnum.VOTE}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center gap-2",children:[(0,a.jsx)(E,{className:"flex-1 max-w-[836px] order-2 md:order-1"}),(0,a.jsx)(G,{className:"hidden md:block order-1 md:order-2"})]}),(0,a.jsx)(z,{className:"mt-4 md:mt-[50px]"}),(0,a.jsx)(o.Z,{})]})]})})}},40647:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(37821);n(58078),n(65786);var r=n(46262),s=n(90490),o=n(36051),i=n(31638);function l(e){let{chainId:t,address:n,text:l,children:d,className:c,...u}=e,m=(0,a.jsx)(r.Z,{children:n}),g=new o.Q(t).getAddressUrl(n);return(0,a.jsx)(s.Z,{placement:"top",speaker:m,trigger:"hover",children:(0,a.jsx)("a",{className:(0,i.m6)("component-chain-address-link pointer hover underline",c),href:g,target:"_blank",...u,children:null!=l?l:n})})}},32662:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(37821);n(58078);var r=n(31638);function s(e){let{children:t,className:n}=e;return(0,a.jsx)("p",{className:(0,r.m6)("text-[14px] text-tip desc",n),children:t})}},50475:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(37821);n(58078);var r=n(31638);function s(e){let{children:t,className:n}=e;return(0,a.jsx)("h1",{className:(0,r.m6)("text-[33px] md:text-[36px] leading-none text-white font-semibold",n),children:t})}},58520:function(e,t,n){"use strict";n.d(t,{ZP:function(){return x}});var a=n(37821),r=n(58078),s=n(61825),o=n(60616),i=n(42132),l=n(23792),d=n(50239),c=n(40794),u=n(40812),m=n(79819);n(30476),n(12514),n(73753),n(65521);var g=n(31638);function x(e){var t,n;let x=null!==(t=e.needRelocationAfterUpdate)&&void 0!==t&&t,f=null!==(n=e.offsetY)&&void 0!==n?n:-70,p=r.useRef(null),[h,v]=r.useState((0,s.ki)(e.pageInfo)),[j,N]=r.useTransition(),Z=e.pageInfo.page||1,w=e.pageInfo.totalPage||0,y=r.useRef({isLoading:e.isLoading,emptyText:e.emptyText,loadingText:e.loadingText,onPaginationChange:e.onPaginationChange});function A(t){o.Z.L("changePagination called with page:",t);let n=e=>{};return y.current.isLoading||h.isLoading?o.Z.L("Loading, cannot change page"):(v({...h,isLoading:!0,isError:!1}),N(async()=>{o.Z.L("Starting page change transition to page:",t);try{let a=y.current.onPaginationChange({page:t});if(n=a.cancel,await a.promise.catch(e=>{if(m.Z.canBeIgnore(e))return Promise.resolve();o.Z.E(JSON.stringify(e)),v({...h,isLoading:!1,isError:!0})}),o.Z.L("Page change completed successfully"),v({...h,isLoading:!1,isError:!1}),!(null==p?void 0:p.current)||0===e.pageInfo.page||!x)return;i.Z.sleepForAnimationFrame(16).promise.then(()=>{if(!p.current)return;let e=i.Z.getOffsetTop(p.current)+f;o.Z.I("scroll to y: ",e),i.Z.scrollTo({y:e})})}catch(e){o.Z.E("Error in page change:",e)}})),n}r.useEffect(()=>{y.current={isLoading:e.isLoading,emptyText:e.emptyText,loadingText:e.loadingText,onPaginationChange:e.onPaginationChange}},[e.isLoading,e.emptyText,e.loadingText,e.onPaginationChange]),r.useEffect(()=>{let t=i.Z.sleepForAnimationFrame();return t.promise.then(()=>{var t;A(null!==(t=e.pageInfo.page)&&void 0!==t?t:1)}),()=>t.cancel("useEffect callback")},[]);let C=r.useMemo(()=>{if(w<=5)return Array.from({length:w},(e,t)=>t+1);let e=1;return e=Z<=3?1:Z>=w-2?w-4:Z-2,Array.from({length:5},(t,n)=>e+n)},[Z,w]),{showLeftEllipsis:b,showRightEllipsis:T}=r.useMemo(()=>({showLeftEllipsis:w>5&&Z>3,showRightEllipsis:w>5&&Z<w-2}),[Z,w]),E=e=>{o.Z.L("Clicked on page ".concat(e,", current page is ").concat(Z)),A(e)};return(0,a.jsxs)(l.Z,{className:(0,g.m6)("paginate-table-container",e.className),children:[(0,a.jsxs)(l.Z,{className:"paginate-wrapper w-full",children:[(0,a.jsx)("div",{className:"paginate-content w-full",ref:p,children:e.children}),(0,a.jsx)("div",{className:"h-[40px] flex justify-center items-center",children:(0,a.jsxs)(d.Z,{horizontalArrangement:c.cV.Center,verticalAlignment:c.v2.Center,className:"status-contain",children:[j||y.current.isLoading||h.isLoading?(0,a.jsx)(u.Z,{children:y.current.loadingText}):"",y.current.isLoading||h.isLoading||0!==w||!y.current.emptyText?"":(0,a.jsx)("div",{className:"paginate-table-placeholder",children:y.current.emptyText})]})})]}),w>0&&(0,a.jsx)("div",{className:"paginate-contain",children:(0,a.jsx)("div",{className:"pagination-custom",children:(0,a.jsxs)("ul",{className:"flex items-center",children:[(0,a.jsx)("li",{className:"previous ".concat(Z<=1?"disabled":""),children:(0,a.jsx)("a",{onClick:()=>A(Math.max(1,Z-1)),children:"<"})}),w<=5?(0,a.jsx)(a.Fragment,{children:Array.from({length:w},(e,t)=>{let n=t+1;return(0,a.jsx)("li",{className:n===Z?"selected":"",children:(0,a.jsx)("a",{onClick:()=>E(n),children:n})},n)})}):C.map(e=>(0,a.jsx)("li",{className:e===Z?"selected":"",children:(0,a.jsx)("a",{onClick:()=>E(e),children:e})},e)),(0,a.jsx)("li",{className:"pagination-break ".concat(T&&w>5?"":"opacity-0"),children:(0,a.jsx)("a",{className:"pagination-break-link",children:"..."})}),(0,a.jsx)("li",{className:"next ".concat(Z>=w?"disabled":""),children:(0,a.jsx)("a",{onClick:()=>A(Math.min(w,Z+1)),children:">"})})]})})})]})}},73753:function(e,t,n){"use strict";var a=n(37821),r=n(58078),s=n(31638);t.Z=r.forwardRef(function(e,t){var n,r;return(0,a.jsxs)("p",{ref:t,className:(0,s.m6)("my-5 text-tip flex justify-center items-center gap-2 component-text-tip",null!==(n=e.className)&&void 0!==n?n:""),children:[null!==(r=e.text)&&void 0!==r?r:"Thereâ€˜s nothing more left",e.children]})})},65786:function(){}},function(e){e.O(0,[8570,7615,9982,2047,6489,7851,8691,9403,8640,6326,9125,8113,3458,2035,3946,9931,999,5070,1278,962,5609,8086,9770,9132,1817,7115,2364,1744],function(){return e(e.s=70307)}),_N_E=e.O()}]);