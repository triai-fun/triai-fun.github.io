(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7064],{63200:function(e,t,n){Promise.resolve().then(n.bind(n,83664))},83664:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ex}});var a,r,l,i,s,o,d=n(57437),c=n(97235),u=n(68071),m=n(27635),p=n(38435),x=n(89769),f=n(53335),v=n(43949),h=n(2265),g=n(59365),N=n(54740),w=n(3682),y=n(65435),j=n(6178),b=n(81939),C=n(88263),I=n(68651),A=n(56679);function E(e){var t,n,a,r,l,i,s,o,c,u,m,p,x,f,h,w,y,C,E,R;let{t:Z}=(0,v.$G)(["dao"]),T=(0,j.C)(e=>e.dao),D={title:Z("DAOReward"),reward:b.Z.wei2eth(null!==(m=null===(t=T.userInfo)||void 0===t?void 0:t.voteAndAirDropReward.clairReward)&&void 0!==m?m:0n)},k=null!==(p=null===(n=T.daoContractInfo)||void 0===n?void 0:n.votePrice)&&void 0!==p?p:1n,O=(null!==(x=null===(a=T.userInfo)||void 0===a?void 0:a.voteInfo.ethDone)&&void 0!==x?x:0n)/k*k;return(0,d.jsx)(A.Z,{isOpen:e.isOpen,onClose:()=>e.requestClose(),className:"w-[420px] bg-[#050505] border border-[#111111] shadow-[0px_0px_50px_#000000] rounded-[8px] p-6",controls:{buttons:[{text:Z("Back"),type:"normal",onClick:()=>e.requestClose()},...e.canClaim?[{text:Z("Claim"),type:e.canClaim?"active":"disabled",onClick:()=>e.requestClaim()}]:[]]},children:(0,d.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,d.jsx)("h2",{className:"text-white text-[18px] font-semibold text-center",children:null==D?void 0:D.title}),(0,d.jsxs)("div",{className:"bg-black border border-[#111111] rounded-[8px] p-4",children:[(0,d.jsxs)("div",{className:"flex justify-center items-center gap-2 mb-4",children:[(0,d.jsx)("span",{className:"text-[14px] text-white",children:Z("ClaimableReward")}),(0,d.jsx)("span",{className:"text-[18px] font-bold bg-gradient-to-r from-[#E700E6] to-[#4B4BDF] bg-clip-text text-transparent",children:(0,d.jsx)(N.eO,{value:Number(D.reward)})}),(0,d.jsx)(g.Z,{className:"w-5 h-5"})]}),(0,d.jsx)("div",{className:"text-[12px] flex flex-col gap-2",children:[{label:Z("TotalVotes"),value:null!==(f=null===(r=T.userInfo)||void 0===r?void 0:r.voteInfo.votedAmount)&&void 0!==f?f:0n},{label:Z("MaxRewards"),value:new I.Z(((null!==(h=null===(l=T.userInfo)||void 0===l?void 0:l.voteInfo.votedAmount)&&void 0!==h?h:0n)+O).toString()).multipliedBy(2.4).toString()},{label:Z("VoteAirdrop"),value:(null!==(w=null===(i=T.userInfo)||void 0===i?void 0:i.voteAndAirDropReward.airdropReward)&&void 0!==w?w:0n)+(null!==(y=null===(s=T.userInfo)||void 0===s?void 0:s.voteAndAirDropReward.reinvestReward)&&void 0!==y?y:0n)},{label:Z("VoteReward"),value:null!==(C=null===(o=T.userInfo)||void 0===o?void 0:o.voteAndAirDropReward.nodeReward)&&void 0!==C?C:0n},{label:Z("AirdropReward"),value:null!==(E=null===(c=T.userInfo)||void 0===c?void 0:c.voteAndAirDropReward.airdropLinkReward)&&void 0!==E?E:0n},{label:Z("RewardClaimed"),value:null!==(R=null===(u=T.userInfo)||void 0===u?void 0:u.voteInfo.ethDone)&&void 0!==R?R:0n},{label:Z("AutoVoted"),value:O}].map((e,t)=>(0,d.jsxs)("div",{className:"flex justify-between",children:[(0,d.jsx)("span",{className:"text-[#666666]",children:e.label}),(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-white font-semibold",children:(0,d.jsx)(N.eO,{value:Number(b.Z.wei2eth(e.value)),useSub:!0})}),(0,d.jsx)(g.Z,{className:"w-3 h-3"})]})]},t))})]})]})})}var R=n(34826),Z=n(10433);function T(e){var t,n;let{t:a}=(0,v.$G)(["dao"]),r=w.Q.getTargetNet(),[l,i]=h.useState(!1),s=(0,j.C)(e=>e.dao),o=(0,C.Z)({autoTrigger:!0,handleAfterClaim:async()=>{i(!1)}}),[c,m]=h.useState(!1),p=o.estimateUserPendingReward(),x=h.useMemo(()=>{let e=R.Z.safeToNumber(p);return"number"==typeof e&&!isNaN(e)&&isFinite(e)?e:0},[p]);h.useEffect(()=>{o.refreshAllData()},[]),h.useEffect(()=>{Z.Z.L("Node Top Reward:",s.userRewardInfo.nodeTopReward.toString())},[s.userRewardInfo.nodeTopReward]);let I=async()=>{o.isUpdating&&await o.refreshAllData(),i(!0)};return(0,d.jsxs)("div",{className:(0,f.m6)("flex flex-col gap-5",e.className),children:[(0,d.jsxs)(u.ZP,{autoBorder:!0,autoMargin:!1,autoPadding:!1,className:"h-[120px] flex flex-col md:flex-row items-center gap-2 justify-center md:justify-around px-[20px]",children:[(0,d.jsxs)("div",{className:"flex items-center gap-1 text-white text-[16px] font-medium",children:[a("DAORewardClaimed"),":",(0,d.jsx)(N.eO,{className:"text-gradient",value:(()=>{var e,t;let n=Number(b.Z.wei2eth(null!==(t=null===(e=s.userInfo)||void 0===e?void 0:e.voteInfo.ethDone)&&void 0!==t?t:0n));return"number"==typeof n&&!isNaN(n)&&isFinite(n)?n:0})()}),r.nativeCurrency.symbol]}),(0,d.jsxs)("div",{className:"flex items-center gap-1 text-white text-[16px] font-medium",children:[a("RewardPending"),":",(0,d.jsx)(N.eO,{className:"text-gradient",value:x}),r.nativeCurrency.symbol]})]}),o.rewardItems.map((e,t)=>{var n;return(0,d.jsxs)(u.ZP,{autoBorder:!0,autoMargin:!1,autoPadding:!1,className:"h-auto md:h-[80px] grid grid-cols-1 md:grid-cols-[2fr_3fr_2fr_2fr] justify-between items-center p-[20px] gap-[16px]",children:[(0,d.jsx)("div",{className:"text-white text-[16px] font-medium",children:e.title}),(0,d.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[(0,d.jsx)("div",{className:"text-[#999] text-[16px] font-medium min-w-[58px]",children:a("RewardTitle")}),"reward"in e&&e.reward?(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("span",{className:"bg-gradient-to-r from-[#E700E6] to-[#4B4BDF] bg-clip-text text-transparent text-[18px] font-bold",children:(0,d.jsx)(N.eO,{value:(()=>{let t=Number(e.reward);return"number"==typeof t&&!isNaN(t)&&isFinite(t)?t:0})()})}),(0,d.jsx)(g.Z,{className:"w-5 h-5 rounded-full"})]}):null,"tokenReward"in e&&e.tokenReward?(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("span",{className:"bg-gradient-to-r from-[#E700E6] to-[#4B4BDF] bg-clip-text text-transparent text-[18px] font-bold",children:(0,d.jsx)(N.eO,{value:(()=>{try{let t=e.tokenReward,n=Number(t);return"number"==typeof n&&!isNaN(n)&&isFinite(n)?n:0}catch(e){return 0}})()})}),(0,d.jsxs)("span",{children:["$",null===(n=s.tokenInfo)||void 0===n?void 0:n.symbol]})]}):null,e.hasDetails?(0,d.jsx)("a",{onClick:()=>I(),className:"text-[#4E97FF] text-[14px] underline ml-2 cursor-pointer",children:a("RewardDetails")}):null]}),(0,d.jsx)("div",{className:"flex items-center gap-1 text-white text-[14px] font-medium min-w-[191px] text-nowrap",children:e.countdown?(0,d.jsxs)(d.Fragment,{children:[a("ClaimCountdown"),":",(0,d.jsx)("span",{className:"text-gradient",children:e.countdown})]}):null}),(0,d.jsx)("div",{className:"flex justify-start md:justify-end",children:(0,d.jsx)(y.ZP,{status:e.claimable?y.Dv.Active:y.Dv.Disabled,size:y.qE.Small,className:(0,f.m6)("w-[90px] font-medium",e.claimable?"bg-gradient-to-r from-[#E700E6] to-[#4B4BDF]":"bg-[#666666]"),waitForClick:!0,onClick:async()=>{var t;o.isUpdating,await e.handleClaim(),(null===(t=o.ui)||void 0===t?void 0:t.airdropInsufficientOpen)&&m(!0)},children:a("Claim")})}),(0,d.jsx)(E,{isOpen:l,requestClose:()=>i(!1),requestClaim:()=>o.handleVoteAirdropClaim(),canClaim:e.claimable})]},t)}),(0,d.jsx)(A.Z,{isOpen:c||(null===(t=o.ui)||void 0===t?void 0:t.airdropInsufficientOpen),onRequestClose:()=>{var e,t;m(!1),null===(t=o.ui)||void 0===t||null===(e=t.setAirdropInsufficientOpen)||void 0===e||e.call(t,!1)},className:"w-[420px] bg-[#050505] border border-[#111111] shadow-[0px_0px_50px_#000000] rounded-[8px] p-6",controls:{buttons:[{text:a("Back"),type:"normal",onClick:()=>{var e,t;m(!1),null===(t=o.ui)||void 0===t||null===(e=t.setAirdropInsufficientOpen)||void 0===e||e.call(t,!1)}}]},children:(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,d.jsx)("h2",{className:"text-white text-[18px] font-semibold text-center",children:a("AirdropInsufficientTitle")}),(0,d.jsx)("p",{className:"text-[#CCCCCC] text-[14px] leading-6",children:a("AirdropInsufficientDesc",{first:(null===(n=o.ui)||void 0===n?void 0:n.airdropFirstPrizeAmount)||"0"})})]})})]})}var D=n(95665),k=n(74439),O=n(72446),F=n(97644),P=n(83123),B=n(20605),S=n(94746);function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}var L=function(e){return S.createElement("svg",_({xmlns:"http://www.w3.org/2000/svg",width:11,height:7,fill:"none"},e),a||(a=S.createElement("path",{fill:"url(#icon-arrow-down-linear_svg__a)",d:"M.772.555c.2 0 .4.067.534.2L4.972 5.09c.134.066.2.133.4.133a.7.7 0 0 0 .334-.133L9.572.822a.714.714 0 0 1 .934-.067.714.714 0 0 1 .066.934L6.706 5.955c-.334.4-.867.6-1.4.6-.534 0-1-.266-1.4-.666L.239 1.622C-.028 1.355.039.955.306.69.439.622.639.555.772.555"})),r||(r=S.createElement("defs",null,S.createElement("linearGradient",{id:"icon-arrow-down-linear_svg__a",x1:10.715,x2:.069,y1:3.555,y2:3.555,gradientUnits:"userSpaceOnUse"},S.createElement("stop",{stopColor:"#E700E6"}),S.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))},M=n(41525),U=n(79787),V=n(22928),q=n(41849);function G(e){var t,n;let{t:a}=(0,v.$G)(["dao","common"]),r=(0,j.T)(),l=(0,j.C)(e=>e.user),i=(0,j.C)(e=>e.dao),s=[{value:x.r.RewardType.VOTE_REWARD,text:a("dao:DAOReward")},{value:x.r.RewardType.VOTE_TOP_REWARD,text:a("dao:VoteTopReward")},{value:x.r.RewardType.NODE_TOP_REWARD,text:a("dao:NodeTopReward")},{value:x.r.RewardType.LUCKY_REWARD,text:a("dao:LuckyReward")},{value:x.r.RewardType.OTHERS_REWARD,text:a("dao:OtherReward")}],o={justNow:a("common:JustNow"),minutesAgo:a("common:MinutesAgo",{minutes:"{0}"}),hoursAgo:a("common:HoursAgo",{hours:"{0}"}),daysAgo:a("common:DaysAgo",{days:"{0}"}),monthsAgo:a("common:MonthsAgo",{months:"{0}"}),yearsAgo:a("common:YearsAgo",{years:"{0}"}),yesterday:a("common:Yesterday"),today:a("common:Today")};function c(e){var t,n,l,o;function d(e){c.abort(e)}let c=new AbortController,u=i.myClaimRecord.tableData;if(!e.restart&&u.isLoading)return{promise:Promise.resolve(),cancel:d};let m=e.restart?1:null!==(n=e.page)&&void 0!==n?n:u.pageIndex+1;return r(D.Z.slice.actions.updateMyClaimRecordTableData({...u,isLoading:!0})),{promise:new V.Z().getUserRewardRecordList({daoAddress:null!==(l=null===(t=i.nodeListFilters.selectedDao)||void 0===t?void 0:t.address)&&void 0!==l?l:"",page:m,pageSize:u.pageSize,type:null!==(o=i.myClaimRecord.filters.type)&&void 0!==o?o:void 0}).then(e=>{var t;if(e.hasError()){let t=e.getError();(0,P.L6)(t.msg),r(D.Z.slice.actions.updateMyClaimRecordTableDataToDone()),Z.Z.E(t);return}let n=e.getData().toJSON(),a=null!==(t=e.getTotalPage())&&void 0!==t?t:u.total,l=0===e.getTotalPage()||0===n.data.length||n.data.length<u.pageSize,i=[...n.data.map(e=>{var t,n;return{...e,typeText:e.typeText||(null!==(n=null===(t=s.find(t=>t.value===e.type))||void 0===t?void 0:t.text)&&void 0!==n?n:"")}})];r(D.Z.slice.actions.updateMyClaimRecordTableData({...u,pageIndex:m,isLoading:!1,total:a,isEnd:l,data:i}))}).catch(e=>{r(D.Z.slice.actions.updateMyClaimRecordTableDataToDone()),B.Z.canBeIgnore(e)||((0,P.L6)(new P.HU(e,a("Error in fetching reward record")).asToastMessage()),Z.Z.E(e))}),cancel:d}}return h.useEffect(()=>{var e;if(i.myClaimRecord.tableData.isLoading||!(null===(e=i.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)||!l.ethInfo.walletAddress)return;let t=k.Z.sleepForAnimationFrame(16);return t.promise.then(()=>{r(D.Z.slice.actions.clearMyClaimRecordTableData()),(0,h.startTransition)(()=>c({restart:!0}).promise)}),()=>{t.cancel(B.Z.ReactError.useEffectDestroy()),r(D.Z.slice.actions.clearMyClaimRecordTableData())}},[i.myClaimRecord.filters,i.nodeListFilters.selectedDao,l.ethInfo.walletAddress]),(0,d.jsx)(u.ZP,{autoBorder:!0,autoMargin:!1,autoPadding:!1,className:(0,f.m6)("claim-record-table-contain overflow-x-auto w-full",e.className),children:(0,d.jsx)(F.ZP,{pageInfo:{page:i.myClaimRecord.tableData.pageIndex,totalPage:i.myClaimRecord.tableData.total},onPaginationChange:e=>{let{page:t}=e;return 0===t?{promise:Promise.resolve(),cancel:()=>{}}:c({page:t})},children:(0,d.jsxs)("div",{className:"min-w-[562px]",children:[(0,d.jsx)("div",{className:"px-[20px]",children:(0,d.jsxs)("div",{className:" grid grid-cols-4 justify-between items-center text-[14px] font-medium text-[#666]",children:[(0,d.jsx)("span",{className:"",children:a("dao:Time")}),(0,d.jsx)("span",{className:" text-center",children:(0,d.jsx)(O.Z,{className:"inline-block selection-type",titleClassName:"text-[#666]",autoBorder:!1,menuList:s,defaultSelected:s.findIndex(e=>e.value===i.myClaimRecord.filters.type),onMenuItemClick:(e,t)=>{t!==i.myClaimRecord.filters.type&&r(t?D.Z.slice.actions.updateMyClaimRecordFilters({type:t}):D.Z.slice.actions.clearMyClaimRecordFilters())},children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[null===i.myClaimRecord.filters.type?a("dao:Type"):null!==(n=null===(t=s.find(e=>e.value===i.myClaimRecord.filters.type))||void 0===t?void 0:t.text)&&void 0!==n?n:"",(0,d.jsx)(L,{})]})})}),(0,d.jsx)("span",{className:" text-center",children:a("dao:Amount")}),(0,d.jsx)("span",{className:" text-right",children:a("dao:Tx")})]})}),(0,d.jsxs)("div",{className:"min-h-[250px]",children:[(0,d.jsx)("div",{className:"divide-y divide-[#111]",children:i.myClaimRecord.tableData.data.map(e=>{var t;let n=k.Z.latestDate(new Date(e.createTime),o);return(0,d.jsxs)("div",{className:"px-[20px] py-[22px] grid grid-cols-4 justify-between items-center hover:opacity-90 border-bottom border-[#666] text-[16px] font-medium",children:[(0,d.jsx)("div",{className:"text-left time",children:n}),(0,d.jsx)("div",{className:"text-center type",children:e.typeText}),(0,d.jsxs)("div",{className:"flex justify-center items-center gap-2 text-center amount",children:[(0,d.jsx)(N.eO,{value:Number(e.reward),useSub:!0,children:(0,d.jsx)(g.Z,{})}),0!==Number(e.tokenReward)?(0,d.jsx)(N.eO,{value:Number(e.tokenReward),useSub:!0,children:(0,d.jsxs)("span",{children:["$",null===(t=i.tokenInfo)||void 0===t?void 0:t.symbol]})}):null]}),(0,d.jsx)("div",{className:"text-right tx",children:(0,d.jsx)(M.Z,{hash:e.tx,text:U.Z.toShort(e.tx)})})]},e.id)})}),0===i.myClaimRecord.tableData.data.length?(0,d.jsx)(q.Z,{className:"pt-[100px]"}):null]})]})})})}var W=n(50544);function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}var $=function(e){return S.createElement("svg",z({xmlns:"http://www.w3.org/2000/svg",width:20,height:36,fill:"none"},e),l||(l=S.createElement("path",{fill:"url(#icon-arrow-left-linear_svg__a)",d:"M20 2.616c0 .672-.222 1.343-.667 1.79L4.89 16.719c-.222.448-.445.672-.445 1.343 0 .224.223.896.445 1.12L19.11 32.164a2.41 2.41 0 0 1 .222 3.133 2.37 2.37 0 0 1-3.11.224L2 22.538c-1.333-1.119-2-2.91-2-4.7s.889-3.358 2.222-4.701L16.445.825c.888-.895 2.222-.671 3.11.224.223.448.445 1.12.445 1.567"})),i||(i=S.createElement("defs",null,S.createElement("linearGradient",{id:"icon-arrow-left-linear_svg__a",x1:10,x2:10,y1:36.001,y2:.256,gradientUnits:"userSpaceOnUse"},S.createElement("stop",{stopColor:"#E700E6"}),S.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))};function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}var Y=function(e){return S.createElement("svg",H({xmlns:"http://www.w3.org/2000/svg",width:20,height:36,fill:"none"},e),s||(s=S.createElement("path",{fill:"url(#icon-arrow-right-linear_svg__a)",d:"M0 2.616c0 .672.222 1.343.667 1.79L15.11 16.719c.222.448.444.672.444 1.343 0 .224-.222.896-.444 1.12L.89 32.164a2.41 2.41 0 0 0-.222 3.133 2.37 2.37 0 0 0 3.11.224L18 22.538c1.333-1.119 2-2.91 2-4.7s-.889-3.358-2.222-4.701L3.556.825C2.666-.07 1.333.154.444 1.05.222 1.497 0 2.17 0 2.616"})),o||(o=S.createElement("defs",null,S.createElement("linearGradient",{id:"icon-arrow-right-linear_svg__a",x1:10,x2:10,y1:36.001,y2:.256,gradientUnits:"userSpaceOnUse"},S.createElement("stop",{stopColor:"#E700E6"}),S.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))},J=n(99376),K=n(72300),Q=n(13965),X=n(70042),ee=n(46493),et=n(72917);function en(){var e,t,n,a,r,l,i,s,o,d;let c=(0,j.C)(e=>e.dao),u=(0,j.C)(e=>e.user),{t:m}=(0,v.$G)(["dao"]),p=(0,ee.Z)(),f=(0,W.Z)(),h=null!==(i=null===(e=c.userInfo)||void 0===e?void 0:e.userInfo.nodeType)&&void 0!==i?i:x.r.NodeType.NONE,g=(0,et.Z)(),N=new I.Z(b.Z.wei2eth(null!==(s=null===(n=f.nodeToNextMap.get(h))||void 0===n?void 0:null===(t=n.nextValue)||void 0===t?void 0:t.upgradeInfo.ethPrice)&&void 0!==s?s:0n)),w=p.getAmountOutByAmountIn(N.toString(),!1,{floarFix:1.01}),y=null!==(o=null===(a=u.tokenBalances.find(e=>e.address===c.tokenInfo.address))||void 0===a?void 0:a.balance)&&void 0!==o?o:"0",C=(null!==(d=null===(l=f.nodeToNextMap.get(h))||void 0===l?void 0:null===(r=l.nextValue)||void 0===r?void 0:r.upgradeInfo.ethPrice)&&void 0!==d?d:0n)>0n;return{applyNode:async function(){var e,t,n,a;if(!(null===(e=c.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)){(0,P.L6)(m("NoSelectedDao"));return}let r=Q.r.getInstance(),l=b.Z.getInstance(r.getProvider()),i=await l.getSigner(),s=X.bR.connect(null===(t=c.nodeListFilters.selectedDao)||void 0===t?void 0:t.address,i),o=X.ed.connect(c.tokenInfo.address,i);try{if(!C)throw Error(m("UserNodeTypeDontNeedApply"));if(new I.Z(w).gt(0)){let e=await o.allowance(u.ethInfo.walletAddress,c.nodeListFilters.selectedDao.address),t=I.Z.max(b.Z.eth2wei(w).toString(),b.Z.eth2wei(y).toString());if(t.gte(e.toString())){let e=await o.approve(c.nodeListFilters.selectedDao.address,BigInt(t.toFixed(0))),n=await e.wait();Z.Z.I("approve ".concat(c.nodeListFilters.selectedDao.address," ").concat(t.toFixed(0)),n)}}if(h===x.r.NodeType.MASTER){if(n=x.r.NodeType.SUPER,h!==n-1)throw Error(m("UserNodeTypeCanNotApplyThisNode",{name:m("mainNode.title")}));let e=await s.applySuperNode();return await e.wait()}if(a=x.r.NodeType.CANDIDATE,h!==a-1)throw Error(m("UserNodeTypeCanNotApplyThisNode",{name:m("candidateNode.title")}));let e=await s.applyCandidateNode(),t=await e.wait(),r=Promise.all([g.updateCurrentRoundInfo(),g.updateUserCurrentRoundInfo()]);return{txRes:e,receipt:t,updateDataPromise:r}}catch(e){return(0,P.L6)(new P.HU(e,m("ApplyFailed")).asToastMessage()),Z.Z.E(e),!1}},userApplyInfo:{userNodeType:h,applyPriceInEth:N,applyPriceInToken:w,tokenBalance:y}}}var ea=n(40066);function er(e){let t=(0,j.C)(e=>e.dao),{t:n}=(0,v.$G)(["dao"]),[a,r]=h.useState(!1),l=e.upgradeInfo.requiredNodeCount>0n,i=l?new I.Z(e.upgradeInfo.userNodeCount.toString()).div(e.upgradeInfo.requiredNodeCount.toString()):new I.Z(1),s=e.upgradeInfo.ethPrice>0n;async function o(){var e,a;if((null!==(a=null===(e=t.userInfo)||void 0===e?void 0:e.voteInfo.votedAmount)&&void 0!==a?a:0n)<=0n){(0,P.L6)(n("NeedVoteForApplyNode"));return}r(!0)}return(0,d.jsxs)("div",{className:"w-full flex-shrink-0",children:[(0,d.jsx)(u.ZP,{autoBorder:!0,autoMargin:!1,autoPadding:!1,className:"relative bg-[#050505] rounded-lg p-6",children:(0,d.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[e.data.isCurrent?(0,d.jsx)("h2",{className:"text-center text-xl bg-gradient-to-r from-primary to-highlight p-[1px] rounded-lg",children:(0,d.jsx)("div",{className:"bg-[#050505] rounded-lg px-4",children:(0,d.jsx)("span",{className:"text-gradient text-[14px] font-medium",children:n("currentIdentity")})})}):null,(0,d.jsx)("img",{src:e.data.image,alt:e.data.title,className:"w-[300px] h-[140px] object-contain"}),(0,d.jsx)("h3",{className:"text-white text-[26px] font-medium",children:e.data.title}),e.data.isCurrent?null:(0,d.jsx)("p",{className:"text-white text-[14px] font-medium text-center max-w-md",children:e.data.description}),e.data.isNext&&l?(0,d.jsxs)("div",{className:"w-full flex flex-col items-stretch gap-4",children:[(0,d.jsxs)("div",{className:"text-right",children:[e.upgradeInfo.userNodeCount.toString(),"/",e.upgradeInfo.requiredNodeCount.toString()]}),(0,d.jsx)("div",{className:"relative w-full h-[15px] border border-[#666] rounded-full",children:(0,d.jsx)("div",{className:(0,f.m6)("absolute left-0 top-0 bottom-0 h-full bg-gradient-to-r from-primary to-highlight rounded-full transition-transform"),style:{width:"".concat(Math.min(i.multipliedBy(100).toNumber(),100),"%")},children:(0,d.jsx)("span",{className:(0,f.m6)("absolute top-1/2 bg-gradient-to-r from-primary to-highlight min-w-[60px] px-2 py-1 text-center rounded-full text-[14px] mt-[-14px] transition-transform"),style:{right:"".concat(-60*Math.max(0,1-i.toNumber()),"px")},children:e.upgradeInfo.userNodeCount.toString()})})})]}):null,e.data.isNext&&s?(0,d.jsx)(y.ZP,{status:i.gte(1)?y.Dv.Active:y.Dv.Disabled,className:"mt-4 w-[157px]",waitForClick:!0,onClick:o,children:n("apply")}):null]})}),(0,d.jsx)(el,{isOpen:a,requestClose:()=>{r(!1)},name:e.data.title,tokenInfo:t.tokenInfo})]})}function el(e){let t=(0,J.useRouter)();(0,j.C)(e=>e.dao);let{t:n}=(0,v.$G)(["dao"]),a=en(),r=new I.Z(a.userApplyInfo.tokenBalance).gt(a.userApplyInfo.applyPriceInToken),l=w.Q.getTargetNet();async function i(){!1!==await a.applyNode()&&((0,P.x9)(n("ApplySuccessDescription",{name:e.name})),e.requestClose())}return(0,d.jsx)(A.Z,{isOpen:e.isOpen,onRequestClose:e.requestClose,title:r?n("ApplyFor",{name:e.name}):n("InsufflcientBalance"),size:"small",controls:{buttons:[{text:n("Back"),type:"normal",onClick:e.requestClose},r?{text:n("Apply"),type:"active",onClick:i}:{text:n("Buy"),type:"active",onClick:()=>{let n=new URLSearchParams;n.append(K.Z.TokenParams.TOKEN_ADDRESS,e.tokenInfo.address),t.push("/token/swap?".concat(n.toString()))}}]},tipText:n("ApplyWith",{name:e.tokenInfo.symbol,worth:"".concat(a.userApplyInfo.applyPriceInEth.toNumber()," ").concat(l.nativeCurrency.symbol)}),children:(0,d.jsxs)("div",{className:"flex flex-col items-center gap-[18px]",children:[(0,d.jsxs)("div",{className:"flex justify-center items-center gap-2 apply-requirement",children:[(0,d.jsx)(N.eO,{className:"text-[20px] text-gradient font-bold",preChildren:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)(ea.Z,{className:"w-[12px] h-[15px]"}),(0,d.jsx)("span",{children:"≈"})]}),value:Number(a.userApplyInfo.applyPriceInToken)}),(0,d.jsx)("img",{src:e.tokenInfo.icon,alt:e.tokenInfo.symbol,className:"w-[20px] h-[20px]"}),(0,d.jsx)("span",{className:"unit",children:e.tokenInfo.symbol})]}),(0,d.jsxs)("div",{className:"flex justify-center items-center gap-2 balance-info",children:[n("Balance"),":",(0,d.jsx)(N.eO,{className:"text-gradient font-bold",value:Number(a.userApplyInfo.tokenBalance)}),(0,d.jsx)("img",{src:e.tokenInfo.icon,alt:e.tokenInfo.symbol,className:"w-[20px] h-[20px]"}),(0,d.jsx)("span",{className:"unit",children:e.tokenInfo.symbol})]})]})})}var ei=n(49481),es=n(56856),eo=n(78604);function ed(e){(0,j.T)();let t=(0,j.C)(e=>e.dao),n=(0,j.C)(e=>e.user),{t:a}=(0,v.$G)(["dao"]),[r,l]=(0,h.useState)(0),i=(0,W.Z)();(0,es.Z)({autoUpdateTokenInfo:!0});let s=(0,ei.Z)(n.ethInfo.walletAddress),o=(0,eo.ZP)(),c=en(),u=Array.from(i.nodeMap.entries()).filter(e=>{let[t]=e;return t!==x.r.NodeType.NONE}).map(e=>{let[t,n]=e;return{...n,type:t,isPrev:c.userApplyInfo.userNodeType>t,isCurrent:c.userApplyInfo.userNodeType===t,isNext:c.userApplyInfo.userNodeType===t-1,description:c.userApplyInfo.userNodeType>t?a("levelBelowDescription"):n.description,upgradeInfo:n.upgradeInfo}});async function m(e){(e=null!=e?e:t.tokenInfo)&&await s.updateTokenBalances([e])}return h.useEffect(()=>{if(!t.tokenInfo||!n.ethInfo.walletAddress)return;let e=k.Z.sleepForAnimationFrame(16);return e.promise.then(()=>{m(t.tokenInfo)}),()=>{e.cancel(B.Z.ReactError.useEffectDestroy())}},[t.tokenInfo,n.ethInfo.walletAddress]),h.useEffect(()=>{var e;if(!(null===(e=t.daoContractInfo)||void 0===e?void 0:e.pairAddress))return;let n=k.Z.sleepForAnimationFrame(16);return n.promise.then(()=>{var e;if(null===(e=t.daoContractInfo)||void 0===e?void 0:e.pairAddress)return o.updateInfo(t.daoContractInfo.pairAddress)}),()=>{n.cancel(B.Z.ReactError.useEffectDestroy())}},[t.daoContractInfo]),(0,d.jsx)("div",{className:(0,f.m6)("mx-auto my-[40px] max-w-[624px] flex flex-col items-stretch space-y-6",e.className),children:(0,d.jsxs)("div",{className:"relative w-full overflow-hidden grid grid-cols-1 md:grid-cols-[50px_1fr_50px] items-center",children:[(0,d.jsx)("div",{className:"absolute z-10 md:static flex justify-start",children:(0,d.jsx)($,{className:"cursor-pointer transition-transform transform translate-x-1/4 hover:translate-x-0 opacity-90 hover:opacity-100",onClick:()=>{l(e=>(e-1+u.length)%u.length)}})}),(0,d.jsx)("div",{className:"overflow-x-hidden mx-[10px] md:mx-0",children:(0,d.jsx)("div",{className:"flex items-center transition-transform duration-300 ease-in-out",style:{transform:"translateX(-".concat(100*r,"%)")},children:u.map((e,t)=>(0,d.jsx)(er,{data:e,upgradeInfo:e.upgradeInfo},t))})}),(0,d.jsx)("div",{className:"absolute right-0 z-10 md:static flex justify-end",children:(0,d.jsx)(Y,{className:"cursor-pointer transition-transform transform -translate-x-1/4 hover:translate-x-0 opacity-90 hover:opacity-100",onClick:()=>{l(e=>(e+1)%u.length)}})})]})})}var ec=n(32223);function eu(e){let{t}=(0,v.$G)(["common","dao"]),[n,a]=h.useState(""),r={title:(0,d.jsx)(d.Fragment,{children:t("dao:MyReward")}),url:x.r.MyAssetsPageTab.MyReward,children:()=>(0,d.jsx)(T,{},r.url)},l={title:(0,d.jsx)(d.Fragment,{children:t("dao:MyRecords")}),url:x.r.MyAssetsPageTab.MyRecords,children:()=>(0,d.jsx)(G,{},l.url)},i={title:(0,d.jsx)(d.Fragment,{children:t("dao:ApplyNode")}),url:x.r.MyAssetsPageTab.ApplyNode,children:()=>(0,d.jsx)(ed,{},i.url)},s=[r,l,i];function o(e){location.href="#".concat(e),a(e)}return h.useEffect(()=>{let e=location.hash.replace("#","");if(location.hash){let t=s.find(t=>t.url===e);if(t){o(t.url);return}}o(r.url)},[]),(0,d.jsx)("div",{className:(0,f.m6)("flex flex-col items-stretch",e.className),children:(0,d.jsxs)("div",{className:"flex flex-col justify-center mb-[30px] w-[1180px] max-w-full mx-auto",children:[(0,d.jsx)("div",{className:"flex flex-col items-stretch md:items-start",children:(0,d.jsx)(ec.Z,{className:"",tabItemClassName:()=>"w-[33%] md:w-auto",tabItemTitleClassName:()=>"w-full",displayType:ec.L.BorderGradient,tabList:s,activeIndex:s.findIndex(e=>e.url===n),onClick:o})}),(0,d.jsx)("div",{className:"mt-[20px]",children:s.filter(e=>e.url===n).map(e=>e.children())})]})})}var em=n(10990),ep=n(78733);function ex(){var e,t;let n=(0,j.C)(e=>e.global),a=(0,j.C)(e=>e.dao),r=(0,j.C)(e=>e.user);(0,et.Z)(void 0,{autoTrigger:!0,autoUpdateTokenInfo:!0});let l=!n.token||!r.ethInfo.isConnected;return(0,d.jsx)("div",{className:"relative overflow-x-hidden text-secondary bg-[#000000]",children:(0,d.jsxs)("div",{className:"w-full",children:[(0,d.jsx)(p.Z,{}),(0,d.jsx)(c.Z,{}),(0,d.jsxs)(u.ZP,{width:u.W7.Wrapper,background:u.nV.None,className:"mx-[20px] 2xl:mx-auto",children:[(0,d.jsx)(em.Z,{activeTarget:x.r.VotingTabEnum.NODE}),(0,d.jsx)("div",{className:(0,f.m6)("flex flex-col items-stretch"),children:l?(0,d.jsx)(ep.Z,{}):(0,d.jsx)(eu,{})},null!==(t=null===(e=a.nodeListFilters.selectedDao)||void 0===e?void 0:e.address)&&void 0!==t?t:"_"),(0,d.jsx)(m.Z,{})]})]})})}},34826:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(68651),r=n(10433);class l{static createSafeBigNumber(e){try{let t=new a.Z(e);return t.isNaN()||!t.isFinite()?new a.Z(0):t}catch(t){return r.Z.W("Error creating BigNumber:",e,t),new a.Z(0)}}static safeToNumber(e){try{if(!e||e.isNaN()||!e.isFinite())return 0;let t=e.toNumber();return"number"==typeof t&&!isNaN(t)&&isFinite(t)?t:0}catch(t){return r.Z.W("Error converting BigNumber to number:",e,t),0}}static safeParseNumber(e){try{if("number"==typeof e)return!isNaN(e)&&isFinite(e)?e:0;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&isFinite(t)?t:0}if(e&&"function"==typeof e.toNumber)return l.safeToNumber(e);return 0}catch(t){return r.Z.W("Error parsing number:",e,t),0}}static safeBigIntDivision(e,t){try{if(0n===t)return r.Z.W("Division by zero attempted, returning 0"),0n;return e/t}catch(n){return r.Z.W("Error in BigInt division:",e,t,n),0n}}static safeBigNumberOperation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new a.Z(0);try{let n=e();return n.isNaN()||!n.isFinite()?t:n}catch(e){return r.Z.W("Error in BigNumber operation:",e),t}}}},72446:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var a,r,l,i,s=n(57437),o=n(2265);function d(e){var t,n;let a=(0,o.useRef)(null);return(0,o.useEffect)(()=>{function t(t){if(a.current&&!a.current.contains(t.target)){var n;null===(n=e.onClose)||void 0===n||n.call(e)}}return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[e]),(0,s.jsx)("div",{ref:a,className:"drop-down-menu ".concat(null===(t=e.withPoint)||void 0===t||t?"with-point":"no-point"," ").concat(null!==(n=e.menuPosition)&&void 0!==n?n:"menu-in-bottom"),children:e.children})}n(47836),(a=l||(l={})).TOP="menu-in-top",a.BOTTOM="menu-in-bottom";var c=n(71845);n(17981);var u=n(72790),m=n(11340),p=n(53335),x=n(68071);function f(e){var t,n;let{title:a,titleClassName:r,children:l,autoBorder:i,icon:f,iconPosition:v,hoverToShow:h,defaultSelected:g,needSelected:N,needDropIcon:w,onMenuItemClick:y,onClose:j,menuList:b,menuPosition:C,className:I,...A}=e,[E,R]=(0,o.useState)(!1),[Z,T]=(0,o.useState)(null!=g?g:0);return i=null==i||i,w=null==w||w,(0,s.jsxs)(x.ZP,{className:(0,p.m6)("drop-down cursor-pointer text-[10px] md:text-[14px] height-[50px] leading-[50px]",I),...A,onMouseOver:()=>h&&R(!0),onMouseLeave:()=>h&&R(!1),autoBorder:i,autoMargin:!1,autoPadding:!1,background:x.nV.None,children:[l?(0,s.jsx)(u.Z,{className:"drop-down-title-contain",horizontalArrangement:m.cV.SpaceBetween,verticalAlignment:m.v2.Center,onClick:()=>R(!E),children:l}):(0,s.jsxs)(u.Z,{className:"drop-down-title-contain px-1 md:px-[10px] md:gap-5",horizontalArrangement:m.cV.SpaceBetween,verticalAlignment:m.v2.Center,onClick:()=>R(!E),children:[(0,s.jsx)("span",{className:(0,p.m6)("white-space-nowrap max-w-full drop-down-title text-white px-1 md:px-[10px]",r),children:(a&&"function"==typeof a?a(Z):a)||(null!==(n=null===(t=b[Z])||void 0===t?void 0:t.text)&&void 0!==n?n:"Missing")}),w?(0,s.jsx)(c.Z,{className:"text-[#333] icon",alt:"icon"}):null]}),E?(0,s.jsx)("div",{className:"cover",onClick:()=>R(!1)}):null,E?(0,s.jsx)(d,{menuPosition:C,onClose:j,withPoint:!0,children:b.map((e,t)=>{var n;return(0,s.jsxs)(u.Z,{horizontalArrangement:e.desc?m.cV.SpaceBetween:m.cV.Center,verticalAlignment:m.v2.Center,className:"menu-item cursor-pointer hover transition-fast ".concat(Z===t&&(null==N||N)?"selected":""),onClick:()=>{var n;return n=e.value,void((null==N||N)&&T(t),R(!1),null==y||y(t,n))},children:[(0,s.jsxs)(u.Z,{horizontalArrangement:m.cV.Start,className:"left",children:[0===v&&e.icon?(0,s.jsx)("div",{className:"icon-contain flex justify-center items-center",children:(0,s.jsx)("img",{className:"icon",src:e.icon,alt:"icon"})}):null,(0,s.jsx)("span",{className:"text bold",children:e.text}),1===v&&e.icon?(0,s.jsx)("div",{className:"icon-contain flex justify-center items-center",children:(0,s.jsx)("img",{className:"icon",src:e.icon,alt:"icon"})}):null]}),(0,s.jsx)("span",{className:"desc",children:null!==(n=e.desc)&&void 0!==n?n:""})]},e.text)})}):""]})}(r=i||(i={}))[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT"},78733:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var a,r,l,i,s=n(57437),o=n(94746);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(null,arguments)}var c=function(e){return o.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 45 36"},e),a||(a=o.createElement("path",{fill:"#666",d:"M26.663 11.193h13.12l-1.75-3.896c-.477-1.113-1.829-1.59-2.942-1.113l-8.666 3.976c-.477.238-.318 1.033.238 1.033m17.651 3.737c0-1.192-1.033-2.226-2.226-2.226H13.226c-1.192 0-2.226 1.034-2.226 2.226v18.844C11 34.966 12.034 36 13.226 36h28.862c1.193 0 2.226-1.034 2.226-2.226v-6.122h-8.746a3.36 3.36 0 0 1-3.34-3.34 3.36 3.36 0 0 1 3.34-3.34h8.746z"})),r||(r=o.createElement("path",{fill:"#666",d:"M34.456 24.392a1.113 1.113 0 1 0 2.225 0 1.113 1.113 0 0 0-2.225 0"})),l||(l=o.createElement("path",{fill:"url(#icon-file-warning_svg__a)",d:"M9.6 0C4.299 0 0 4.475 0 10s4.299 10 9.6 10 9.6-4.475 9.6-10S14.901 0 9.6 0m0 15.612c-.56 0-1.011-.474-1.011-1.054 0-.583.452-1.056 1.011-1.056.56 0 1.011.473 1.011 1.056 0 .58-.452 1.054-1.011 1.054m1.71-10.1-.86 5.564c-.115.723-.496 1.315-.85 1.315s-.735-.592-.85-1.315L7.89 5.51C7.774 4.788 8.256 4 8.96 4h1.279c.705 0 1.187.786 1.071 1.511"})),i||(i=o.createElement("defs",null,o.createElement("linearGradient",{id:"icon-file-warning_svg__a",x1:0,x2:19.2,y1:10,y2:10,gradientUnits:"userSpaceOnUse"},o.createElement("stop",{stopColor:"#E700E6"}),o.createElement("stop",{offset:1,stopColor:"#4B4BDF"})))))},u=n(43949),m=n(53335);function p(e){let{t}=(0,u.$G)(["common"]);return(0,s.jsxs)("div",{className:(0,m.m6)("flex flex-col justify-center items-center gap-[18px] p-[65px]",e.className),children:[(0,s.jsx)(c,{className:"w-[44px] h-[38px]"}),(0,s.jsx)("div",{className:"text-white",children:t("NoConnectWalletTip")})]})}},17981:function(){},47836:function(){}},function(e){e.O(0,[1283,5073,977,6870,668,2784,7181,2506,9409,927,9481,6764,8575,7920,3448,1707,9738,1811,7072,923,344,6011,9302,2580,1240,6755,1937,8263,2971,2117,1744],function(){return e(e.s=63200)}),_N_E=e.O()}]);